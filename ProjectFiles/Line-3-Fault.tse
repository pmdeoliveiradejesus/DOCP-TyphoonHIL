version = 4.2

//
// Saved by sw version: 2021.3
// Save timestamp: 26-Apr-2022 @ 01:40:02 PM
//

model "Line-3-Fault" {
    configuration {
        hil_device = "HIL402"
        hil_configuration_id = 2
        simulation_method = bilinear
        simulation_time_step = 10e-6
        simulation_discret_scaling = 1.0
        dsp_timer_periods = 100e-6, 50e-3
        ss_calc_method = "systematic elimination"
        enb_pole_shift = True
        enb_gds_oversampling = True
        show_modes = False
        device_ao_limit_enable = False
        reset_analog_outputs_on_sim_stop = True
        reset_digital_outputs_on_sim_stop = True
        cpl_stb = False
        enb_dep_sw_detect = False
        code_section = "internal memory"
        data_section = "internal memory"
        sys_sp_rate_1 = 0.0001
        sys_sp_rate_2 = 0.05
        sys_real_type_precision = "default"
        user_real_type_precision = "default"
        sys_cpu_optimization = "high"
        user_cpu_optimization = "high"
        user_cpu_part_option = "default"
        matrix_based_reduction = True
        cpl_dynamics_analysis = False
        export_ss_to_pickle = False
        ground_scope_core = False
        cce_platform = "generic"
        cce_use_relative_names = False
        cce_type_mapping_real = "double"
        cce_type_mapping_uint = "unsigned int"
        cce_type_mapping_int = "int"
        cce_directory = ""
        cce_custom_type_int = ""
        cce_custom_type_uint = ""
        cce_custom_type_real = ""
        tunable_params = "component defined"
    }

    component Subsystem Root {
        component "core/Three Phase Voltage Source" "Gen - 1" {
            init_frequency = "60"
            init_rms_value = "4082.482905"
        }
        [
            position = 6504, 6968
            rotation = right
            scale = -1, 1
            size = 62, 256
        ]

        component "core/Three Phase Two Winding Transformer" Tr1 {
            L1 = "3.536776241877548e-05"
            L2 = "0.007957746544224485"
            Lm = "0.1768388256615912"
            Poc1 = "10"
            Psc1 = "2350"
            R1 = "5.2222222222222226e-06"
            R2 = "0.001175"
            Rm = "10000000.0"
            Sn = "150000000.0"
            V1 = "4082.482905"
            V2 = "61237.24357"
            f = "60.0"
            ioc1 = "1"
            usc1 = "4"
        }
        [
            position = 6504, 7176
            rotation = right
            size = 126, 256
        ]

        component "core/Three Phase Two Winding Transformer" Tr2 {
            L1 = "3.536776241877548e-05"
            L2 = "0.007957746544224485"
            Lm = "0.1768388256615912"
            Poc1 = "10"
            Psc1 = "2350"
            R1 = "5.2222222222222226e-06"
            R2 = "0.001175"
            Rm = "10000000.0"
            Sn = "150000000"
            V1 = "4082.482905"
            V2 = "61237.24357"
            f = "60"
            ioc1 = "1"
            usc1 = "4"
        }
        [
            position = 7552, 10280
            rotation = left
            size = 126, 256
        ]

        component "core/Three Phase Voltage Source" "Gen -2" {
            init_frequency = "60"
            init_rms_value = "4082.482905"
        }
        [
            position = 7552, 10512
            rotation = left
            size = 62, 256
        ]

        component src_ground gnd5 {
        }
        [
            position = 7552, 10608
            hide_name = True
            scale = -1, 1
        ]

        component Subsystem "Bus 1" {
            layout = dynamic

            port A-- {
                position = left:1
                kind = pe
            }
            [
                position = 7776, 8064
            ]

            port A- {
                position = right:1
                kind = pe
            }
            [
                position = 8048, 8064
                scale = -1, 1
            ]

            port B-- {
                position = left:2
                kind = pe
            }
            [
                position = 7776, 8192
            ]

            port B- {
                position = right:2
                kind = pe
            }
            [
                position = 8048, 8192
                scale = -1, 1
            ]

            port C-- {
                position = left:3
                kind = pe
            }
            [
                position = 7776, 8328
            ]

            port C- {
                position = right:3
                kind = pe
            }
            [
                position = 8048, 8328
                scale = -1, 1
            ]

            port A+ {
                position = top:auto
                kind = pe
            }
            [
                position = 7904, 8008
                rotation = right
            ]

            port B+ {
                position = top:auto
                kind = pe
            }
            [
                position = 7904, 8136
                rotation = right
            ]

            port C+ {
                position = top:auto
                kind = pe
            }
            [
                position = 7904, 8280
                rotation = right
            ]

            port A--- {
                position = bottom:auto
                kind = pe
            }
            [
                position = 7976, 8104
                rotation = left
            ]

            port B--- {
                position = bottom:auto
                kind = pe
            }
            [
                position = 7976, 8232
                rotation = left
            ]

            port C--- {
                position = bottom:auto
                kind = pe
            }
            [
                position = 7968, 8368
                rotation = left
            ]

            junction Junction1 pe
            [
                position = 7904, 8064
            ]

            junction Junction2 pe
            [
                position = 7904, 8192
            ]

            junction Junction3 pe
            [
                position = 7904, 8328
            ]

            junction Junction4 pe
            [
                position = 7976, 8064
            ]

            junction Junction5 pe
            [
                position = 7976, 8192
            ]

            junction Junction6 pe
            [
                position = 7968, 8328
            ]

            connect Junction1 A-- as Connection5
            connect A+ Junction1 as Connection6
            connect Junction2 B-- as Connection8
            connect B+ Junction2 as Connection9
            connect Junction3 C-- as Connection11
            connect C+ Junction3 as Connection12
            connect A- Junction4 as Connection13
            connect Junction4 Junction1 as Connection14
            connect A--- Junction4 as Connection15
            connect B- Junction5 as Connection16
            connect Junction5 Junction2 as Connection17
            connect B--- Junction5 as Connection18
            connect C- Junction6 as Connection19
            connect Junction6 Junction3 as Connection20
            connect C--- Junction6 as Connection21
        }
        [
            position = 6504, 7384
            size = 240, 104
        ]

        component Subsystem "Bus 5" {
            layout = dynamic

            port C- {
                position = right:1
                kind = pe
            }
            [
                position = 8056, 8328
                scale = -1, 1
            ]

            port B- {
                position = right:2
                kind = pe
            }
            [
                position = 8056, 8192
                scale = -1, 1
            ]

            port A- {
                position = right:3
                kind = pe
            }
            [
                position = 8056, 8064
                scale = -1, 1
            ]

            port A--- {
                position = bottom:1
                kind = pe
            }
            [
                position = 7960, 8104
                rotation = left
            ]

            port B--- {
                position = bottom:2
                kind = pe
            }
            [
                position = 7960, 8240
                rotation = left
            ]

            port C--- {
                position = bottom:3
                kind = pe
            }
            [
                position = 7960, 8376
                rotation = left
            ]

            port C-- {
                position = left:1
                kind = pe
            }
            [
                position = 7800, 8328
            ]

            port B-- {
                position = left:2
                kind = pe
            }
            [
                position = 7832, 8192
            ]

            port A-- {
                position = left:3
                kind = pe
            }
            [
                position = 7816, 8056
            ]

            port A+ {
                position = top:1
                kind = pe
            }
            [
                position = 7896, 8000
                rotation = right
            ]

            port B+ {
                position = top:2
                kind = pe
            }
            [
                position = 7912, 8152
                rotation = right
            ]

            port C+ {
                position = top:3
                kind = pe
            }
            [
                position = 7896, 8280
                rotation = right
            ]

            junction Junction10 pe
            [
                position = 7960, 8064
            ]

            junction Junction11 pe
            [
                position = 7960, 8192
            ]

            junction Junction16 pe
            [
                position = 7960, 8336
            ]

            junction Junction17 pe
            [
                position = 7896, 8064
            ]

            junction Junction18 pe
            [
                position = 7912, 8192
            ]

            junction Junction19 pe
            [
                position = 7896, 8328
            ]

            connect Junction10 A- as Connection74
            [
                breakpoints = 7968, 8064; 7976, 8064; 7976, 8064; 7976, 8064; 7976, 8064
            ]
            connect A--- Junction10 as Connection75
            connect B- Junction11 as Connection76
            [
                breakpoints = 7976, 8192; 7976, 8192; 7976, 8192
            ]
            connect B--- Junction11 as Connection78
            connect C--- Junction16 as Connection133
            connect Junction16 C- as Connection134
            [
                breakpoints = 7960, 8328; 7960, 8328; 7968, 8328; 7968, 8328; 7968, 8328
            ]
            connect Junction10 Junction17 as Connection137
            [
                breakpoints = 7960, 8064; 7960, 8064; 7960, 8064; 7960, 8064
            ]
            connect Junction17 A-- as Connection138
            [
                breakpoints = 7896, 8064; 7896, 8064; 7896, 8064; 7904, 8064; 7896, 8064; 7896, 8064; 7896, 8064; 7896, 8064
            ]
            connect A+ Junction17 as Connection139
            connect B-- Junction18 as Connection140
            [
                breakpoints = 7896, 8192
            ]
            connect Junction18 Junction11 as Connection141
            [
                breakpoints = 7960, 8192; 7960, 8192; 7960, 8192; 7960, 8192
            ]
            connect B+ Junction18 as Connection142
            connect C-- Junction19 as Connection143
            connect Junction19 Junction16 as Connection144
            connect C+ Junction19 as Connection145
        }
        [
            position = 7552, 10088
            scale = 1, -1
            size = 240, 104
        ]

        component "core/Triple Pole Single Throw Contactor" S12 {
            ctrl_src = "Model"
            off_delay = "1/12"
            on_delay = "1/12"
        }
        [
            position = 8328, 10088
            size = 64, 256
        ]

        component Subsystem "Bus 2" {
            layout = dynamic

            port A+ {
                position = left:1
                kind = pe
            }
            [
                position = 7784, 8064
            ]

            port A- {
                position = right:4
                kind = pe
            }
            [
                position = 8056, 8064
                scale = -1, 1
            ]

            port B+ {
                position = left:2
                kind = pe
            }
            [
                position = 7776, 8152
            ]

            port B- {
                position = right:5
                kind = pe
            }
            [
                position = 8048, 8152
                scale = -1, 1
            ]

            port C+ {
                position = left:3
                kind = pe
            }
            [
                position = 7768, 8240
            ]

            port C- {
                position = right:6
                kind = pe
            }
            [
                position = 8040, 8240
                scale = -1, 1
            ]

            connect A- A+ as Connection24
            [
                breakpoints = 7984, 8064; 7912, 8064
            ]
            connect B- B+ as Connection25
            [
                breakpoints = 7976, 8152; 7904, 8152
            ]
            connect C- C+ as Connection26
            [
                breakpoints = 7968, 8240; 7896, 8240
            ]
        }
        [
            position = 8480, 7384
            size = 240, 104
        ]

        component Subsystem "Bus 3" {
            layout = dynamic

            port A+ {
                position = left:1
                kind = pe
            }
            [
                position = 7552, 8120
            ]

            port A- {
                position = bottom:4
                kind = pe
            }
            [
                position = 7824, 8120
                scale = -1, 1
            ]

            port B+ {
                position = left:2
                kind = pe
            }
            [
                position = 7552, 8216
            ]

            port B- {
                position = bottom:5
                kind = pe
            }
            [
                position = 7824, 8216
                scale = -1, 1
            ]

            port C+ {
                position = left:3
                kind = pe
            }
            [
                position = 7552, 8304
            ]

            port C- {
                position = bottom:6
                kind = pe
            }
            [
                position = 7824, 8304
                scale = -1, 1
            ]

            connect A- A+ as Connection24
            [
                breakpoints = 7752, 8120; 7680, 8120
            ]
            connect B- B+ as Connection25
            [
                breakpoints = 7752, 8216; 7680, 8216
            ]
            connect C- C+ as Connection26
            [
                breakpoints = 7760, 8304; 7680, 8304
            ]
        }
        [
            position = 10416, 7384
            size = 240, 104
        ]

        component Subsystem "Bus 4" {
            layout = dynamic

            port A+ {
                position = top:1
                kind = pe
            }
            [
                position = 7552, 8112
            ]

            port A- {
                position = left:4
                kind = pe
            }
            [
                position = 7824, 8112
                scale = -1, 1
            ]

            port B+ {
                position = top:2
                kind = pe
            }
            [
                position = 7552, 8184
            ]

            port B- {
                position = left:5
                kind = pe
            }
            [
                position = 7824, 8184
                scale = -1, 1
            ]

            port C+ {
                position = top:3
                kind = pe
            }
            [
                position = 7552, 8256
            ]

            port C- {
                position = left:6
                kind = pe
            }
            [
                position = 7824, 8256
                scale = -1, 1
            ]

            connect A- A+ as Connection24
            [
                breakpoints = 7752, 8112; 7680, 8112
            ]
            connect B- B+ as Connection25
            [
                breakpoints = 7760, 8184; 7680, 8184
            ]
            connect C- C+ as Connection26
            [
                breakpoints = 7752, 8256; 7680, 8256
            ]
        }
        [
            position = 10416, 10088
            size = 240, 104
        ]

        component Subsystem "Bus 6" {
            layout = dynamic

            port A+ {
                position = right:1
                kind = pe
            }
            [
                position = 7816, 8280
            ]

            port A- {
                position = top:4
                kind = pe
            }
            [
                position = 8088, 8280
                scale = -1, 1
            ]

            port B+ {
                position = right:2
                kind = pe
            }
            [
                position = 7816, 8368
            ]

            port B- {
                position = top:5
                kind = pe
            }
            [
                position = 8088, 8368
                scale = -1, 1
            ]

            port C+ {
                position = right:3
                kind = pe
            }
            [
                position = 7816, 8456
            ]

            port C- {
                position = top:6
                kind = pe
            }
            [
                position = 8088, 8456
                scale = -1, 1
            ]

            connect A- A+ as Connection24
            [
                breakpoints = 8016, 8280; 7944, 8280
            ]
            connect B- B+ as Connection25
            [
                breakpoints = 8016, 8368; 7944, 8368
            ]
            connect C- C+ as Connection26
            [
                breakpoints = 8024, 8456; 7944, 8456
            ]
        }
        [
            position = 5272, 10088
            size = 240, 104
        ]

        component pas_inductor L4 {
            inductance = "0.116/377"
        }
        [
            position = 6600, 7056
            rotation = right
        ]

        component pas_inductor L5 {
            inductance = "0.116/377"
        }
        [
            position = 6504, 7048
            rotation = right
        ]

        component pas_inductor L6 {
            inductance = "0.116/377"
        }
        [
            position = 6408, 7048
            rotation = right
        ]

        component pas_inductor L7 {
            inductance = "0.116/377"
        }
        [
            position = 7648, 10416
            rotation = right
        ]

        component pas_inductor L8 {
            inductance = "0.116/377"
        }
        [
            position = 7552, 10416
            rotation = right
        ]

        component pas_inductor L9 {
            inductance = "0.116/377"
        }
        [
            position = 7456, 10416
            rotation = right
        ]

        component "core/Constant Impedance Load" Load1 {
            SAB = "72111025.51/3"
            SAn = "72111025.51/3"
            SBC = "72111025.51/3"
            SBn = "72111025.51/3"
            SCA = "72111025.51/3"
            SCn = "72111025.51/3"
            Sn_3ph = "72.11102551e6"
            VAB = "148678.8"
            VAn = "148678.8/(3**0.5)"
            VBC = "148678.8"
            VBn = "148678.8/(3**0.5)"
            VCA = "148678.8"
            VCn = "148678.8/(3**0.5)"
            Vn_3ph = "150000*0.991192"
            pfA = "0.83"
            pfB = "0.83"
            pfC = "0.83"
            pf_3ph = "0.83"
            pf_modeA = "Lag"
            pf_modeB = "Lag"
            pf_modeC = "Lag"
            pf_mode_3ph = "Lag"
        }
        [
            position = 8152, 7240
            rotation = down
            size = 64, 112
        ]

        component "core/Constant Impedance Load" Load2 {
            SAB = "80622577.48/3"
            SAn = "80622577.48/3"
            SBC = "80622577.48/3"
            SBn = "80622577.48/3"
            SCA = "80622577.48/3"
            SCn = "80622577.48/3"
            Sn_3ph = "80.62257748e6"
            VAB = "150000"
            VAn = "150000/(3**0.5)"
            VBC = "150000"
            VBn = "150000/(3**0.5)"
            VCA = "150000"
            VCn = "150000/(3**0.5)"
            Vn_3ph = "150000"
            pfA = "0.8682"
            pfB = "0.8682"
            pfC = "0.8682"
            pf_3ph = "0.8682"
            pf_modeA = "Lag"
            pf_modeB = "Lag"
            pf_modeC = "Lag"
            pf_mode_3ph = "Lag"
        }
        [
            position = 10656, 7496
            rotation = left
            size = 64, 112
        ]

        component "core/Constant Impedance Load" Load3 {
            SAB = "86023252.67/3"
            SAn = "86023252.67/3"
            SBC = "86023252.67/3"
            SBn = "86023252.67/3"
            SCA = "86023252.67/3"
            SCn = "86023252.67/3"
            Sn_3ph = "86.02325267e6"
            VAB = "148678.8"
            VAn = "148678.8/(3**0.5)"
            VBC = "148678.8"
            VBn = "148678.8/(3**0.5)"
            VCA = "148678.8"
            VCn = "148678.8/(3**0.5)"
            Vn_3ph = "150000*0.991192"
            pfA = "0.8137334"
            pfB = "0.8137334"
            pfC = "0.8137334"
            pf_3ph = "0.8137334"
            pf_modeA = "Lag"
            pf_modeB = "Lag"
            pf_modeC = "Lag"
            pf_mode_3ph = "Lag"
        }
        [
            position = 10648, 9960
            rotation = left
            size = 64, 112
        ]

        component "core/Constant Impedance Load" Load4 {
            SAB = "44721359.55/3"
            SAn = "44721359.55/3"
            SBC = "44721359.55/3"
            SBn = "44721359.55/3"
            SCA = "44721359.55/3"
            SCn = "44721359.55/3"
            Sn_3ph = "44.72135955e6"
            VAB = "148678.8"
            VAn = "148678.8/(3**0.5)"
            VBC = "148678.8"
            VBn = "148678.8/(3**0.5)"
            VCA = "148678.8"
            VCn = "148678.8/(3**0.5)"
            Vn_3ph = "150000*0.991192"
            pfA = "0.89442719"
            pfB = "0.89442719"
            pfC = "0.89442719"
            pf_3ph = "0.89442719"
            pf_modeA = "Lag"
            pf_modeB = "Lag"
            pf_modeC = "Lag"
            pf_mode_3ph = "Lag"
        }
        [
            position = 5584, 10264
            size = 64, 112
        ]

        component Subsystem various {
            layout = dynamic
            component src_scada_input Relay_Selected {
                def_value = "1"
                execution_rate = "Ts"
                format = "uint"
                max = "20"
                min = "0"
                signal_type = "uint"
                unit = ""
            }
            [
                position = 7328, 7960
            ]

            component gen_probe Relay_Sted {
            }
            [
                position = 7464, 7960
            ]

            component src_constant Constant1 {
                execution_rate = "Ts"
                signal_type = "uint"
            }
            [
                position = 7328, 7888
                hide_name = True
            ]

            component gen_probe Magnitud {
            }
            [
                position = 7464, 7888
            ]

            connect Relay_Sted.in Relay_Selected.out as Connection1
            connect Magnitud.in Constant1.out as Connection369
        }
        [
            position = 5496, 7080
            size = 112, 56
        ]

        component Subsystem "Measurements Block - 12" {
            layout = dynamic
            component "core/Current Measurement" I_A {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7288, 7952
                size = 64, 32
            ]

            component "core/Current Measurement" I_B {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7240, 8016
                size = 64, 32
            ]

            component "core/Current Measurement" I_C {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7192, 8112
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_BC {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8552, 7856
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_AB {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8312, 7856
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_CA {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8792, 7872
                size = 64, 32
            ]

            component gen_bus_join "Basic Measurements (Join)" {
                inputs = "9"
            }
            [
                position = 8152, 7528
            ]

            component "core/Current RMS" IrmsA {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7600, 7952
                size = 64, 32
            ]

            component "core/Current RMS" IrmsB {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7536, 8016
                size = 64, 32
            ]

            component "core/Current RMS" IrmsC {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7488, 8112
                size = 64, 32
            ]

            port B+ {
                position = left:2
                kind = pe
            }
            [
                position = 7048, 8016
            ]

            port A- {
                position = right:1
                kind = pe
            }
            [
                position = 9624, 7952
                rotation = down
            ]

            port C+ {
                position = left:3
                kind = pe
            }
            [
                position = 7048, 8112
            ]

            port B- {
                position = right:2
                kind = pe
            }
            [
                position = 9624, 8016
                rotation = down
            ]

            port A+ {
                position = left:1
                kind = pe
            }
            [
                position = 7048, 7952
            ]

            port C- {
                position = right:3
                kind = pe
            }
            [
                position = 9624, 8112
                rotation = down
            ]

            port BM {
                position = top:auto
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8232, 7528
            ]

            tag Goto4 {
                value = "Irms_A"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7888
                hide_name = True
            ]

            tag Goto5 {
                value = "Irms_B"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7856
                hide_name = True
            ]

            tag Goto6 {
                value = "Irms_C"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7824
                hide_name = True
            ]

            tag Goto10 {
                value = "V_BC"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8552, 7768
                rotation = left
                hide_name = True
            ]

            tag Goto11 {
                value = "V_AB"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8312, 7768
                rotation = left
                hide_name = True
            ]

            tag Goto12 {
                value = "V_CA"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8792, 7776
                rotation = left
                hide_name = True
                scale = -1, 1
            ]

            tag From7 {
                value = "I_A"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7464
                hide_name = True
            ]

            tag From8 {
                value = "I_B"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7480
                hide_name = True
            ]

            tag From9 {
                value = "I_C"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7496
                hide_name = True
            ]

            tag From10 {
                value = "V_BC"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7512
                hide_name = True
            ]

            tag From11 {
                value = "V_AB"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7544
                hide_name = True
            ]

            tag From12 {
                value = "V_CA"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7528
                hide_name = True
            ]

            tag From13 {
                value = "Irms_A"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7560
                hide_name = True
            ]

            tag From14 {
                value = "Irms_B"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7576
                hide_name = True
            ]

            tag From15 {
                value = "Irms_C"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7592
                hide_name = True
            ]

            tag Goto13 {
                value = "I_A"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7880
                hide_name = True
            ]

            tag Goto14 {
                value = "I_B"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7832
                hide_name = True
            ]

            tag Goto15 {
                value = "I_C"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7800
                hide_name = True
            ]

            junction Junction53 pe
            [
                position = 8344, 8016
            ]

            junction Junction54 pe
            [
                position = 8280, 7952
            ]

            junction Junction55 pe
            [
                position = 8520, 8016
            ]

            junction Junction56 pe
            [
                position = 8584, 8112
            ]

            junction Junction57 pe
            [
                position = 8760, 8112
            ]

            junction Junction58 pe
            [
                position = 8824, 7952
            ]

            connect I_C.p_node C+ as Connection3
            connect I_B.p_node B+ as Connection1
            connect I_A.p_node A+ as Connection5
            connect Goto10 V_BC.out as Connection155
            connect Goto11 V_AB.out as Connection162
            connect Goto12 V_CA.out as Connection178
            connect V_AB.n_node Junction53 as Connection334
            connect V_AB.p_node Junction54 as Connection337
            connect Junction55 Junction53 as Connection339
            connect V_BC.p_node Junction55 as Connection340
            connect V_BC.n_node Junction56 as Connection343
            connect Junction56 Junction57 as Connection344
            connect V_CA.p_node Junction57 as Connection346
            connect Junction54 Junction58 as Connection347
            [
                breakpoints = 8280, 7952; 8392, 7952; 8392, 7952; 8392, 7952; 8440, 7952; 8456, 7952; 8456, 7952; 8456, 7952; 8456, 7952
            ]
            connect V_CA.n_node Junction58 as Connection349
            connect "Basic Measurements (Join).out" BM as Connection368
            connect C- Junction57 as Connection396
            [
                breakpoints = 9416, 8112; 9352, 8112; 9232, 8112; 9168, 8112; 8760, 8112
            ]
            connect Junction55 B- as Connection395
            [
                breakpoints = 8520, 8016; 8520, 8016; 8976, 8016; 9040, 8016; 9040, 8016; 9168, 8016; 9232, 8016
            ]
            connect Junction58 A- as Connection394
            [
                breakpoints = 8824, 7952; 8824, 7952; 8976, 7952; 8976, 7952; 9040, 7952; 9352, 7952; 9416, 7952
            ]
            connect From7 "Basic Measurements (Join).in" as Connection400
            connect From8 "Basic Measurements (Join).in1" as Connection401
            connect From9 "Basic Measurements (Join).in2" as Connection402
            connect From10 "Basic Measurements (Join).in3" as Connection403
            connect From12 "Basic Measurements (Join).in4" as Connection404
            connect From11 "Basic Measurements (Join).in5" as Connection405
            connect Junction54 IrmsA.n_node as Connection406
            connect IrmsA.p_node I_A.n_node as Connection407
            connect I_B.n_node IrmsB.p_node as Connection408
            connect IrmsB.n_node Junction53 as Connection409
            connect I_C.n_node IrmsC.p_node as Connection410
            connect IrmsC.n_node Junction56 as Connection411
            connect From13 "Basic Measurements (Join).in6" as Connection415
            connect From14 "Basic Measurements (Join).in7" as Connection416
            [
                breakpoints = 8120, 7576
            ]
            connect From15 "Basic Measurements (Join).in8" as Connection417
            [
                breakpoints = 8120, 7592
            ]
            connect Goto13 I_A.out as Connection418
            connect Goto14 I_B.out as Connection419
            connect Goto15 I_C.out as Connection420
            connect Goto4 IrmsA.out as Connection421
            connect Goto5 IrmsB.out as Connection422
            connect Goto6 IrmsC.out as Connection423
        }
        [
            position = 8120, 10088
            size = 104, 240
        ]

        component Subsystem Fault-1 {
            layout = dynamic
            component "core/Triple Pole Single Throw Contactor" S1 {
            }
            [
                position = 8144, 8288
                rotation = left
                scale = 1, -1
                size = 64, 256
            ]

            component pas_resistor R1 {
                resistance = "R"
            }
            [
                position = 8048, 8096
                rotation = left
            ]

            component pas_resistor R2 {
                resistance = "R"
            }
            [
                position = 8144, 8096
                rotation = left
            ]

            component pas_resistor R3 {
                resistance = "R"
            }
            [
                position = 8240, 8096
                rotation = left
            ]

            component pas_inductor L1 {
                inductance = "L"
            }
            [
                position = 8048, 8192
                rotation = left
            ]

            component pas_inductor L2 {
                inductance = "L"
            }
            [
                position = 8144, 8192
                rotation = left
            ]

            component pas_inductor L3 {
                inductance = "L"
            }
            [
                position = 8240, 8192
                rotation = left
            ]

            port Port7 {
                position = bottom:auto
                kind = pe
            }
            [
                position = 8144, 8400
                rotation = left
                hide_name = True
            ]

            port Port1 {
                position = left:1
                kind = pe
            }
            [
                position = 7848, 7840
                hide_name = True
            ]

            port Port4 {
                position = right:4
                kind = pe
            }
            [
                position = 8424, 7840
                hide_name = True
                scale = -1, 1
            ]

            port Port8 {
                position = left:2
                kind = pe
            }
            [
                position = 7856, 7904
                hide_name = True
            ]

            port Port9 {
                position = right:5
                kind = pe
            }
            [
                position = 8432, 7904
                hide_name = True
                scale = -1, 1
            ]

            port Port10 {
                position = left:3
                kind = pe
            }
            [
                position = 7856, 7976
                hide_name = True
            ]

            port Port11 {
                position = right:6
                kind = pe
            }
            [
                position = 8432, 7976
                hide_name = True
                scale = -1, 1
            ]

            junction Junction1 pe
            [
                position = 8048, 7840
            ]

            junction Junction2 pe
            [
                position = 8144, 7904
            ]

            junction Junction3 pe
            [
                position = 8240, 7976
            ]

            connect L1.n_node R1.p_node as Connection16
            connect L2.n_node R2.p_node as Connection17
            connect L3.n_node R3.p_node as Connection18
            connect Port7 S1.b_out as Connection41
            connect S1.a_out Port7 as Connection42
            connect S1.a_in L1.p_node as Connection26
            connect S1.c_out Port7 as Connection43
            connect S1.b_in L2.p_node as Connection27
            connect S1.c_in L3.p_node as Connection28
            connect Port1 Junction1 as Connection75
            connect Junction1 Port4 as Connection76
            [
                breakpoints = 8040, 7840; 8040, 7840; 8040, 7840; 8392, 7840
            ]
            connect R1.n_node Junction1 as Connection77
            connect Port8 Junction2 as Connection78
            [
                breakpoints = 8048, 7904; 8048, 7904; 8048, 7904
            ]
            connect Junction2 Port9 as Connection79
            [
                breakpoints = 8400, 7904
            ]
            connect R2.n_node Junction2 as Connection80
            connect Port10 Junction3 as Connection81
            [
                breakpoints = 8048, 7976; 8048, 7976; 8048, 7976
            ]
            connect Junction3 Port11 as Connection82
            [
                breakpoints = 8400, 7976
            ]
            connect R3.n_node Junction3 as Connection83

            L = "1e-15"
            R = "0.00001"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Three phase fault to ground.</p><p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br></br></p><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">NOTE: If you are going to put an inductance value of 0 please set that value to 1e-15</p></body></html>"

                L {
                    label = "Introduce inductor Value"
                    widget = edit
                    type = generic
                    default_value = "1e-3"
                    unit = "[H]"
                    group = "General"
                }

                R {
                    label = "Introduce resistance Value"
                    widget = edit
                    type = generic
                    default_value = "0.25"
                    unit = "[â„¦]"
                    group = "General"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE define_icon
                    image('grid_fault.svg')
                ENDCODE
            }
        }
        [
            position = 10416, 8232
            rotation = left
            size = 64, 64
        ]

        component Subsystem "Measurements Block - 4" {
            layout = dynamic
            component "core/Current Measurement" I_A {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7288, 7952
                size = 64, 32
            ]

            component "core/Current Measurement" I_B {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7240, 8016
                size = 64, 32
            ]

            component "core/Current Measurement" I_C {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7192, 8112
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_BC {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8552, 7856
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_AB {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8312, 7856
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_CA {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8792, 7872
                size = 64, 32
            ]

            component gen_bus_join "Basic Measurements (Join)" {
                inputs = "9"
            }
            [
                position = 8152, 7528
            ]

            component "core/Current RMS" IrmsA {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7600, 7952
                size = 64, 32
            ]

            component "core/Current RMS" IrmsB {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7536, 8016
                size = 64, 32
            ]

            component "core/Current RMS" IrmsC {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7488, 8112
                size = 64, 32
            ]

            port B+ {
                position = left:2
                kind = pe
            }
            [
                position = 7048, 8016
            ]

            port A- {
                position = right:1
                kind = pe
            }
            [
                position = 9624, 7952
                rotation = down
            ]

            port C+ {
                position = left:3
                kind = pe
            }
            [
                position = 7048, 8112
            ]

            port B- {
                position = right:2
                kind = pe
            }
            [
                position = 9624, 8016
                rotation = down
            ]

            port A+ {
                position = left:1
                kind = pe
            }
            [
                position = 7048, 7952
            ]

            port C- {
                position = right:3
                kind = pe
            }
            [
                position = 9624, 8112
                rotation = down
            ]

            port BM {
                position = top:auto
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8232, 7528
            ]

            tag Goto4 {
                value = "Irms_A"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7648, 7872
                hide_name = True
            ]

            tag Goto5 {
                value = "Irms_B"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7648, 7824
                hide_name = True
            ]

            tag Goto6 {
                value = "Irms_C"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7648, 7792
                hide_name = True
            ]

            tag Goto10 {
                value = "V_BC"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8552, 7768
                rotation = left
                hide_name = True
            ]

            tag Goto11 {
                value = "V_AB"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8312, 7768
                rotation = left
                hide_name = True
            ]

            tag Goto12 {
                value = "V_CA"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8792, 7776
                rotation = left
                hide_name = True
                scale = -1, 1
            ]

            tag From7 {
                value = "I_A"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7464
                hide_name = True
            ]

            tag From8 {
                value = "I_B"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7480
                hide_name = True
            ]

            tag From9 {
                value = "I_C"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7496
                hide_name = True
            ]

            tag From10 {
                value = "V_BC"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7512
                hide_name = True
            ]

            tag From11 {
                value = "V_AB"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7544
                hide_name = True
            ]

            tag From12 {
                value = "V_CA"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7528
                hide_name = True
            ]

            tag From13 {
                value = "Irms_A"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7560
                hide_name = True
            ]

            tag From14 {
                value = "Irms_B"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7576
                hide_name = True
            ]

            tag From15 {
                value = "Irms_C"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7592
                hide_name = True
            ]

            tag Goto13 {
                value = "I_A"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7880
                hide_name = True
            ]

            tag Goto14 {
                value = "I_B"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7832
                hide_name = True
            ]

            tag Goto15 {
                value = "I_C"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7800
                hide_name = True
            ]

            junction Junction53 pe
            [
                position = 8344, 8016
            ]

            junction Junction54 pe
            [
                position = 8280, 7952
            ]

            junction Junction55 pe
            [
                position = 8520, 8016
            ]

            junction Junction56 pe
            [
                position = 8584, 8112
            ]

            junction Junction57 pe
            [
                position = 8760, 8112
            ]

            junction Junction58 pe
            [
                position = 8824, 7952
            ]

            connect I_C.p_node C+ as Connection3
            connect I_B.p_node B+ as Connection1
            connect I_A.p_node A+ as Connection5
            connect Goto10 V_BC.out as Connection155
            connect Goto11 V_AB.out as Connection162
            connect Goto12 V_CA.out as Connection178
            connect V_AB.n_node Junction53 as Connection334
            connect V_AB.p_node Junction54 as Connection337
            connect Junction55 Junction53 as Connection339
            connect V_BC.p_node Junction55 as Connection340
            connect V_BC.n_node Junction56 as Connection343
            connect Junction56 Junction57 as Connection344
            connect V_CA.p_node Junction57 as Connection346
            connect Junction54 Junction58 as Connection347
            [
                breakpoints = 8280, 7952; 8392, 7952; 8392, 7952; 8392, 7952; 8440, 7952; 8456, 7952; 8456, 7952; 8456, 7952; 8456, 7952
            ]
            connect V_CA.n_node Junction58 as Connection349
            connect "Basic Measurements (Join).out" BM as Connection368
            connect C- Junction57 as Connection396
            [
                breakpoints = 9416, 8112; 9352, 8112; 9232, 8112; 9168, 8112; 8760, 8112
            ]
            connect Junction55 B- as Connection395
            [
                breakpoints = 8520, 8016; 8520, 8016; 8976, 8016; 9040, 8016; 9040, 8016; 9168, 8016; 9232, 8016
            ]
            connect Junction58 A- as Connection394
            [
                breakpoints = 8824, 7952; 8824, 7952; 8976, 7952; 8976, 7952; 9040, 7952; 9352, 7952; 9416, 7952
            ]
            connect From7 "Basic Measurements (Join).in" as Connection400
            connect From8 "Basic Measurements (Join).in1" as Connection401
            connect From9 "Basic Measurements (Join).in2" as Connection402
            connect From10 "Basic Measurements (Join).in3" as Connection403
            connect From12 "Basic Measurements (Join).in4" as Connection404
            connect From11 "Basic Measurements (Join).in5" as Connection405
            connect Junction54 IrmsA.n_node as Connection406
            connect IrmsA.p_node I_A.n_node as Connection407
            connect I_B.n_node IrmsB.p_node as Connection408
            connect IrmsB.n_node Junction53 as Connection409
            connect I_C.n_node IrmsC.p_node as Connection410
            connect IrmsC.n_node Junction56 as Connection411
            connect Goto4 IrmsA.out as Connection412
            connect Goto5 IrmsB.out as Connection413
            connect Goto6 IrmsC.out as Connection414
            connect From13 "Basic Measurements (Join).in6" as Connection415
            connect From14 "Basic Measurements (Join).in7" as Connection416
            [
                breakpoints = 8120, 7576
            ]
            connect From15 "Basic Measurements (Join).in8" as Connection417
            [
                breakpoints = 8120, 7592
            ]
            connect Goto13 I_A.out as Connection418
            connect Goto14 I_B.out as Connection419
            connect Goto15 I_C.out as Connection420
        }
        [
            position = 10416, 7616
            rotation = left
            scale = 1, -1
            size = 104, 240
        ]

        component "core/Triple Pole Single Throw Contactor" S4 {
            ctrl_src = "Model"
            off_delay = "1/12"
            on_delay = "1/12"
        }
        [
            position = 10416, 7832
            rotation = right
            scale = -1, 1
            size = 64, 256
        ]

        component Subsystem Relay-12 {
            layout = dynamic
            component Subsystem "Function (67P)" {
                layout = dynamic
                component src_scada_input Reset {
                    execution_rate = "Ts_relay"
                    max = "1"
                    min = "0"
                    unit = ""
                }
                [
                    position = 7272, 8456
                ]

                component src_scada_input DT {
                    def_value = "0.025"
                    execution_rate = "Ts_relay"
                    max = "1.3"
                    min = "0.024"
                    unit = ""
                }
                [
                    position = 7272, 8608
                ]

                component src_constant Constant1 {
                    execution_rate = "Ts_relay"
                    value = "fun_selected"
                }
                [
                    position = 7272, 8880
                    hide_name = True
                ]

                component src_constant CTp {
                    execution_rate = "Ts_relay"
                    value = "CTp"
                }
                [
                    position = 7272, 8800
                ]

                component gen_probe RS {
                }
                [
                    position = 7456, 8424
                ]

                component gen_probe I_PKU {
                }
                [
                    position = 7456, 8488
                ]

                component src_scada_input I_Pick_Up {
                    def_value = "I_Pick_Up"
                    execution_rate = "Ts_relay"
                    unit = ""
                }
                [
                    position = 7272, 8536
                ]

                component src_constant Constant4 {
                    execution_rate = "Ts_relay"
                    value = "Ts_relay"
                }
                [
                    position = 7272, 8952
                    hide_name = True
                ]

                component gen_probe TMS_Stt {
                }
                [
                    position = 7456, 8656
                ]

                component src_scada_input TMS {
                    def_value = "TMS"
                    execution_rate = "Ts_relay"
                    unit = ""
                }
                [
                    position = 7272, 8704
                ]

                component gen_probe DT_Stt {
                }
                [
                    position = 7456, 8576
                ]

                component gen_product Product1 {
                }
                [
                    position = 8496, 8088
                    hide_name = True
                ]

                component gen_product Product2 {
                }
                [
                    position = 8496, 8136
                    hide_name = True
                ]

                component gen_product Product3 {
                }
                [
                    position = 8496, 8184
                    hide_name = True
                ]

                component gen_c_function "OverCurrent Inverse Function" {
                    global_variables = "real Irms[3];uint i;real M[3];real Ipk_2;real t[3];uint j;real Flag;real B;real A;real L;real multiplier;real counter;real out;real trans;real time;"
                    init_fnc = "/*Begin code section*/
B = 0.14; A = 0.02; L = 0; // Time Inverse Function parameters inicialization
Flag = 0;
TMS = 1;
CTp = 1;
Ipk_2= 1;
multiplier = 1;
out=0;
counter= 0; // 1/60 -> 1 cycle 
time = 1e9;
trans = 0;
/*End code section*/"
                    input_terminals = "inherit Inverse_Function;inherit I_Pick_Up;inherit TMS;inherit CTp;inherit I_Arms;inherit I_Brms;inherit I_Crms;inherit Reset;inherit DT;inherit Ts;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "[(\'Inverse_Function\', True), (\'I_Pick_Up\', True), (\'TMS\', True), (\'CTp\', True), (\'I_Arms\', True), (\'I_Brms\', True), (\'I_Crms\', True), (\'Reset\', True), (\'DT\', True), (\'Ts\', True)]"
                    output_fnc = "/*Begin code section*/
Irms[0] = I_Arms;Irms[1] = I_Brms;Irms[2] = I_Crms;

switch ( (int)Inverse_Function) // Switch Inverse function selected by user
{
    case 0: // Standard Inverse IEC
    {
        B = 0.14; A = 0.02; L = 0; multiplier = TMS;
        break;
    }
    case 1: // Very Inverse IEC
    {
        B = 13.5; A = 1; L = 0; multiplier = TMS;
        break;
    }
    case 2: // Extremely Inverse IEC
    {
        B = 80; A = 2; L = 0; multiplier = TMS;
        break;
    }
    case 3: // Long Time Inverse UK
    {
        B = 120; A = 1; L = 0; multiplier = TMS;
        break;
    }

    case 4: // Rectifier UK
    {
        B = 45900; A = 5.6; L = 0; multiplier = TMS;
        break;
    }
    case 5: // Moderately Invese IEEE
    {
        B = 0.0515; A = 0.02; L = 0.114; multiplier = DT;
        break;
    }
    case 6: // Very Inverse IEEE
    {
        B = 19.61; A = 2; L = 0.491; multiplier = DT;
        break;
    }
    case 7: // Extremely Inverse IEEE
    {
        B = 28.2; A = 2; L = 0.1217; multiplier = DT;
        break;
    }
    case 8: //  Inverse US
    {
        B = 5.95; A = 2; L = 0.18; multiplier = DT;
        break;
    }
    case 9: //  Inverse US
    {
        B = 0.16758; A = 0.02; L = 0.11858; multiplier = DT;
        break;
    }
    default: //  Inverse US
    {
        B = 0.14; A = 0.02; L = 0; multiplier = TMS;
        break;
    }
    
}



if ((int)Reset == 1 ) // Reset statement
{
    trans = 0;
    counter = 0;
    Flag = 0;
}
else if (trans == 0 )
{
    Ipk_2 = I_Pick_Up*CTp/5.0; // Pick-Up current in the primary side
    
    for(i=0; i<3; i++){
        M[i] = Irms[i]/Ipk_2; // Normalize RMS current based on the pickup.
        if(M[i]<=1.0){
            t[i] = 1e6;
        }
        else{
            t[i] = multiplier*((B/(pow(M[i],A)-1))+L); // Time folows IEC function
        }
    }
    
    if((t[0]<=t[1])&&(t[0]<=t[2])){
        time = t[0];
    }
    else if(t[1]<=t[2]){
        time = t[1];
    }
    else{
        time = t[2];
    }
    for(i=0; i<3; i++){
        if(Irms[i]>Ipk_2){
            Flag = 1;
            break;
        }
        else{
            Flag = 0;
        }
    }
}
    if(counter > time){
        out = 1;
        trans = 1;
    }
    else{
        out = 0;
        trans = 0;
    }
    
    counter *= Flag;

    counter += Flag  * Ts;
// OUTPUT
OUT = out;
    time_out = time;
/*End code section*/"
                    output_terminals = "real OUT;inherit time_out;"
                    output_terminals_dimensions = "inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "[(\'OUT\', True), (\'time_out\', True)]"
                }
                [
                    position = 8128, 8960
                    size = 224, 208
                ]

                component sys_signal_switch "Signal switch2" {
                    criterion = "ctrl != threshold"
                }
                [
                    position = 8480, 8976
                ]

                component src_constant Constant6 {
                    execution_rate = "Ts_relay"
                    value = "0"
                }
                [
                    position = 8352, 9024
                    hide_name = True
                ]

                component sys_signal_switch "Signal switch1" {
                    criterion = "ctrl != threshold"
                }
                [
                    position = 8464, 8544
                ]

                component src_constant Constant2 {
                    execution_rate = "Ts_relay"
                    signal_type = "uint"
                    value = "dir_selected"
                }
                [
                    position = 8464, 8464
                    rotation = right
                    hide_name = True
                ]

                component src_constant Constant3 {
                    execution_rate = "Ts_relay"
                }
                [
                    position = 8336, 8592
                    hide_name = True
                ]

                component gen_c_function "C function (Directional Protection)" {
                    global_variables = "real threshold_Low[3];real threshold_high[3];real vec[6];uint i;uint j;real Flag;real val[3];"
                    init_fnc = "/*Begin code section*/
// Input

// Output
Directional_Trip = 0;
// Transition variables inicialization
Flag = 0;
/*End code section*/"
                    input_terminals = "inherit I_a;inherit I_b;inherit I_c;inherit V_ab;inherit V_ca;inherit V_bc;inherit Reset;inherit RCA;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "[(\'I_a\', True), (\'I_b\', True), (\'I_c\', True), (\'V_ab\', True), (\'V_ca\', True), (\'V_bc\', True), (\'Reset\', True), (\'RCA\', True)]"
                    output_fnc = "/*Begin code section*/
// Voltage and Current vector
vec[0] = V_bc; vec[1] = V_ca; vec[2] = V_ab; 
vec[3] = I_a; vec[4] = I_b;vec[5] = I_c;

if ((int)Reset == 1 ) // Reset Statement
{
    Flag = 0; // Trip not allowed

}
else // All angles are placed from 1st to 4th quadrant 
{
    for (i=0;i<3;i++)
    {
        if(vec[i] < 0){vec[i]+=360;}
        if(vec[i+3] < 0){vec[i+3]+=360;}
        val[i] = vec[i]-vec[i+3]+RCA;
        if (val[i] > 360){val[i] -= 360;}
        if (val[i] < 0){val[i] += 360;}
        if ((val[i] >=270 && val[i] < 360) || (val[i] >=0 && val[i] <=90)){Flag = 1;break;}
        else {Flag = 0;}
    }
    
    }

    // OUTPUT
    Directional_Trip = Flag;
/*End code section*/"
                    output_terminals = "real Directional_Trip;"
                    output_terminals_dimensions = "inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "[(\'Directional_Trip\', True)]"
                }
                [
                    position = 8128, 8528
                    size = 224, 208
                ]

                component gen_probe "Directional Trip" {
                }
                [
                    position = 8352, 8376
                ]

                component msr_phase "Phase Difference1" {
                }
                [
                    position = 7856, 8056
                    hide_name = True
                ]

                component msr_phase "Phase Difference2" {
                }
                [
                    position = 7856, 7992
                    hide_name = True
                ]

                component msr_phase "Phase Difference3" {
                }
                [
                    position = 7856, 7928
                    hide_name = True
                ]

                component msr_phase "Phase Difference4" {
                }
                [
                    position = 7856, 7856
                    hide_name = True
                ]

                component src_sine "Sinusoidal Source3" {
                    execution_rate = "Ts_relay"
                    frequency = "60"
                }
                [
                    position = 7608, 7848
                    hide_name = True
                ]

                component msr_phase "Phase Difference5" {
                }
                [
                    position = 7856, 8128
                    hide_name = True
                ]

                component msr_phase "Phase Difference6" {
                }
                [
                    position = 7856, 8192
                    hide_name = True
                ]

                component gen_probe "I_A_(Angle)" {
                }
                [
                    position = 7968, 7856
                ]

                component gen_probe "I_B_(Angle)" {
                }
                [
                    position = 7968, 7928
                ]

                component gen_probe "I_C_(Angle)" {
                }
                [
                    position = 7968, 7992
                ]

                component gen_probe "V_BC_(Angle)" {
                }
                [
                    position = 7968, 8056
                ]

                component gen_probe "V_AB_(Angle)" {
                }
                [
                    position = 7968, 8192
                ]

                component gen_probe "V_CA_(Angle)" {
                }
                [
                    position = 7968, 8128
                ]

                component gen_bus_split "Basic Measurements (Split)" {
                    outputs = "9"
                }
                [
                    position = 7152, 8024
                ]

                component gen_probe "I_A(RMS)" {
                }
                [
                    position = 8520, 7848
                ]

                component gen_probe "I_B(RMS)" {
                }
                [
                    position = 8520, 7960
                ]

                component gen_probe "I_C(RMS)" {
                }
                [
                    position = 8520, 7904
                ]

                component gen_probe CTp_Stt {
                }
                [
                    position = 7456, 8760
                ]

                component gen_probe time {
                }
                [
                    position = 8304, 9104
                ]

                component src_constant Constant7 {
                    execution_rate = "Ts_relay"
                    value = "RCA"
                }
                [
                    position = 7272, 9016
                    hide_name = True
                ]

                component gen_probe RCA {
                }
                [
                    position = 7456, 8984
                ]

                component src_scada_input Enable {
                    def_value = "Enable"
                    execution_rate = "Ts_relay"
                    format = "uint"
                    max = "1"
                    min = "0"
                    signal_type = "uint"
                    unit = ""
                }
                [
                    position = 8480, 8896
                    rotation = right
                ]

                port "DOCR Trip" {
                    position = right:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8624, 8976
                ]

                port BM {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6984, 8024
                ]

                tag Goto39 {
                    value = "CTp"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8800
                    hide_name = True
                ]

                tag Goto40 {
                    value = "DT"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8608
                    hide_name = True
                ]

                tag Goto41 {
                    value = "I_Pick-Up"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8536
                    hide_name = True
                ]

                tag Goto42 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8456
                    hide_name = True
                ]

                tag Goto48 {
                    value = "Inverse_Function"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8880
                    hide_name = True
                ]

                tag Goto49 {
                    value = "TMS"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8704
                    hide_name = True
                ]

                tag Goto50 {
                    value = "Ts_relay"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8952
                    hide_name = True
                ]

                tag From20 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8080
                    hide_name = True
                    size = 99, 20
                ]

                tag From21 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8128
                    hide_name = True
                    size = 99, 20
                ]

                tag From22 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8176
                    hide_name = True
                    size = 99, 20
                ]

                tag From25 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8096
                    hide_name = True
                ]

                tag From26 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8144
                    hide_name = True
                ]

                tag From27 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8192
                    hide_name = True
                ]

                tag From28 {
                    value = "CTp"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8928
                    hide_name = True
                ]

                tag From29 {
                    value = "TMS"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8912
                    hide_name = True
                ]

                tag From30 {
                    value = "I_Pick-Up"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8896
                    hide_name = True
                ]

                tag From31 {
                    value = "Inverse_Function"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8880
                    hide_name = True
                ]

                tag From32 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8992
                    hide_name = True
                ]

                tag From34 {
                    value = "DT"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 9008
                    hide_name = True
                ]

                tag Goto38 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8648, 8544
                    hide_name = True
                    size = 104, 20
                ]

                tag From35 {
                    value = "Ts_relay"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7808, 9024
                    hide_name = True
                    size = 99, 20
                ]

                tag From5 {
                    value = "I_A_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8448
                    hide_name = True
                ]

                tag From6 {
                    value = "I_B_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8472
                    hide_name = True
                ]

                tag From7 {
                    value = "I_C_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8496
                    hide_name = True
                ]

                tag From8 {
                    value = "V_AB_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8520
                    hide_name = True
                ]

                tag From9 {
                    value = "V_CA_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8544
                    hide_name = True
                ]

                tag From10 {
                    value = "V_BC_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8568
                    hide_name = True
                ]

                tag From23 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8592
                    hide_name = True
                ]

                tag Goto7 {
                    value = "V_BC_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8032
                    hide_name = True
                ]

                tag Goto8 {
                    value = "V_AB_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8168
                    hide_name = True
                ]

                tag Goto9 {
                    value = "V_CA_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8104
                    hide_name = True
                ]

                tag Goto10 {
                    value = "I_A_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7824
                    hide_name = True
                ]

                tag Goto11 {
                    value = "I_B_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7896
                    hide_name = True
                ]

                tag Goto12 {
                    value = "I_C_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7968
                    hide_name = True
                ]

                tag Goto13 {
                    value = "I_A"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 7960
                    hide_name = True
                ]

                tag Goto14 {
                    value = "I_B"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 7976
                    hide_name = True
                ]

                tag Goto15 {
                    value = "I_C"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 7992
                    hide_name = True
                ]

                tag Goto16 {
                    value = "V_BC"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 8008
                    hide_name = True
                ]

                tag Goto17 {
                    value = "V_CA"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 8024
                    hide_name = True
                ]

                tag Goto18 {
                    value = "V_AB"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 8040
                    hide_name = True
                ]

                tag From13 {
                    value = "I_A"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 7864
                    hide_name = True
                ]

                tag From14 {
                    value = "I_B"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 7936
                    hide_name = True
                ]

                tag From15 {
                    value = "I_C"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8000
                    hide_name = True
                ]

                tag From16 {
                    value = "V_BC"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8064
                    hide_name = True
                ]

                tag From36 {
                    value = "V_CA"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8136
                    hide_name = True
                ]

                tag From37 {
                    value = "V_AB"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8200
                    hide_name = True
                ]

                tag Goto45 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 8056
                    hide_name = True
                ]

                tag Goto46 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 8072
                    hide_name = True
                ]

                tag Goto47 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 8088
                    hide_name = True
                ]

                tag Goto51 {
                    value = "IA(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8088
                    hide_name = True
                    size = 104, 20
                ]

                tag Goto52 {
                    value = "IB(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8136
                    hide_name = True
                    size = 104, 20
                ]

                tag Goto53 {
                    value = "IC(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8184
                    hide_name = True
                    size = 104, 20
                ]

                tag From38 {
                    value = "IA(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8944
                    hide_name = True
                ]

                tag From39 {
                    value = "IB(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8960
                    hide_name = True
                ]

                tag From40 {
                    value = "IC(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8976
                    hide_name = True
                ]

                tag From41 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7848
                    hide_name = True
                ]

                tag From42 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7904
                    hide_name = True
                ]

                tag From43 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7960
                    hide_name = True
                ]

                tag Goto54 {
                    value = "RCA"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 9016
                    hide_name = True
                ]

                tag From44 {
                    value = "RCA"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8608
                    hide_name = True
                ]

                junction Junction81 sp
                [
                    position = 7328, 8456
                ]

                junction Junction84 sp
                [
                    position = 7352, 8536
                ]

                junction Junction86 sp
                [
                    position = 7328, 8608
                ]

                junction Junction88 sp
                [
                    position = 7336, 8704
                ]

                junction Junction89 sp
                [
                    position = 8296, 8528
                ]

                junction Junction1 sp
                [
                    position = 7936, 7856
                ]

                junction Junction2 sp
                [
                    position = 7936, 7928
                ]

                junction Junction3 sp
                [
                    position = 7936, 7992
                ]

                junction Junction4 sp
                [
                    position = 7936, 8056
                ]

                junction Junction5 sp
                [
                    position = 7936, 8128
                ]

                junction Junction6 sp
                [
                    position = 7936, 8192
                ]

                junction Junction7 sp
                [
                    position = 7648, 7848
                ]

                junction Junction8 sp
                [
                    position = 7648, 7920
                ]

                junction Junction9 sp
                [
                    position = 7648, 7984
                ]

                junction Junction10 sp
                [
                    position = 7648, 8048
                ]

                junction Junction11 sp
                [
                    position = 7648, 8120
                ]

                junction Junction90 sp
                [
                    position = 7344, 8800
                ]

                junction Junction91 sp
                [
                    position = 7328, 9016
                ]

                comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Basic Measurements</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 7088, 7896
                ]

                comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Phase Measurements</p></body></html> ENDCOMMENT 
                [
                    position = 7784, 7744
                ]

                comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">RMS Currents Measurements</p></body></html> ENDCOMMENT 
                [
                    position = 8344, 7800
                ]

                comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SCADA INPUTS</p></body></html> ENDCOMMENT 
                [
                    position = 7296, 8352
                ]

                comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directionality &amp;&amp; Current (RMS)</p></body></html> ENDCOMMENT 
                [
                    position = 8328, 7992
                ]

                comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directional Protecction </p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 8040, 8368
                ]

                comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">OverCurrent Protection</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 8032, 8800
                ]

                connect Constant1.out Goto48 as Connection902
                [
                    breakpoints = 7328, 8880
                ]
                connect Reset.out Junction81 as Connection843
                connect Junction81 Goto42 as Connection844
                connect RS.in Junction81 as Connection845
                connect I_PKU.in Junction84 as Connection937
                connect Junction84 Goto41 as Connection938
                [
                    breakpoints = 7352, 8528
                ]
                connect I_Pick_Up.out Junction84 as Connection939
                connect Goto50 Constant4.out as Connection943
                connect DT.out Junction86 as Connection956
                connect Junction86 Goto40 as Connection957
                [
                    breakpoints = 7328, 8608
                ]
                connect DT_Stt.in Junction86 as Connection958
                connect Goto49 Junction88 as Connection964
                connect Junction88 TMS.out as Connection965
                connect TMS_Stt.in Junction88 as Connection966
                connect From20 Product1.in as Connection355
                connect From21 Product2.in as Connection357
                connect From22 Product3.in as Connection359
                connect From25 Product1.in1 as Connection708
                connect From26 Product2.in1 as Connection709
                connect From27 Product3.in1 as Connection710
                connect From28 "OverCurrent Inverse Function.CTp" as Connection714
                connect From29 "OverCurrent Inverse Function.TMS" as Connection715
                connect From30 "OverCurrent Inverse Function.I_Pick_Up" as Connection917
                connect From35 "OverCurrent Inverse Function.Ts" as Connection944
                connect Constant6.out "Signal switch2.in1" as Connection972
                connect "DOCR Trip" "Signal switch2.out" as Connection973
                connect Constant2.out "Signal switch1.in2" as Connection880
                connect Constant3.out "Signal switch1.in1" as Connection886
                connect From5 "C function (Directional Protection).I_a" as Connection336
                connect From6 "C function (Directional Protection).I_b" as Connection337
                connect From7 "C function (Directional Protection).I_c" as Connection338
                connect From8 "C function (Directional Protection).V_ab" as Connection339
                connect From9 "C function (Directional Protection).V_ca" as Connection340
                connect From10 "C function (Directional Protection).V_bc" as Connection341
                connect From23 "C function (Directional Protection).Reset" as Connection554
                connect Goto38 "Signal switch1.out" as Connection977
                connect "C function (Directional Protection).Directional_Trip" Junction89 as Connection979
                connect Junction89 "Signal switch1.in" as Connection980
                connect "Directional Trip.in" Junction89 as Connection981
                [
                    breakpoints = 8296, 8376; 8296, 8528
                ]
                connect "Basic Measurements (Split).in" BM as Connection243
                connect "I_A_(Angle).in" Junction1 as Connection317
                connect Junction1 "Phase Difference4.phase_diff" as Connection318
                connect Goto10 Junction1 as Connection319
                connect "Phase Difference3.phase_diff" Junction2 as Connection320
                connect Junction2 "I_B_(Angle).in" as Connection321
                connect Goto11 Junction2 as Connection322
                connect "Phase Difference2.phase_diff" Junction3 as Connection323
                connect Junction3 "I_C_(Angle).in" as Connection324
                connect Goto12 Junction3 as Connection325
                connect "V_BC_(Angle).in" Junction4 as Connection327
                connect Junction4 "Phase Difference1.phase_diff" as Connection328
                connect Goto7 Junction4 as Connection329
                connect "V_CA_(Angle).in" Junction5 as Connection982
                connect Junction5 "Phase Difference5.phase_diff" as Connection332
                connect Goto9 Junction5 as Connection983
                connect "V_AB_(Angle).in" Junction6 as Connection984
                connect Junction6 "Phase Difference6.phase_diff" as Connection985
                connect Goto8 Junction6 as Connection986
                connect "Sinusoidal Source3.out" Junction7 as Connection987
                connect Junction7 "Phase Difference4.signal2" as Connection988
                connect "Phase Difference3.signal2" Junction8 as Connection342
                connect Junction8 Junction7 as Connection343
                connect "Phase Difference2.signal2" Junction9 as Connection345
                connect Junction9 Junction8 as Connection346
                connect "Phase Difference1.signal2" Junction10 as Connection348
                connect Junction10 Junction9 as Connection349
                connect "Phase Difference5.signal2" Junction11 as Connection351
                connect Junction11 Junction10 as Connection352
                connect "Phase Difference6.signal2" Junction11 as Connection353
                connect Goto13 "Basic Measurements (Split).out" as Connection354
                connect Goto14 "Basic Measurements (Split).out1" as Connection989
                connect Goto15 "Basic Measurements (Split).out2" as Connection356
                connect Goto16 "Basic Measurements (Split).out3" as Connection990
                connect Goto17 "Basic Measurements (Split).out4" as Connection358
                connect Goto18 "Basic Measurements (Split).out5" as Connection991
                connect From13 "Phase Difference4.signal1" as Connection360
                connect From14 "Phase Difference3.signal1" as Connection361
                connect From15 "Phase Difference2.signal1" as Connection362
                connect From16 "Phase Difference1.signal1" as Connection363
                connect From36 "Phase Difference5.signal1" as Connection364
                connect From37 "Phase Difference6.signal1" as Connection365
                connect Goto51 Product1.out as Connection994
                connect Goto52 Product2.out as Connection995
                connect Goto53 Product3.out as Connection996
                connect From38 "OverCurrent Inverse Function.I_Arms" as Connection997
                connect From39 "OverCurrent Inverse Function.I_Brms" as Connection998
                connect From40 "OverCurrent Inverse Function.I_Crms" as Connection999
                connect From32 "OverCurrent Inverse Function.Reset" as Connection1000
                connect From34 "OverCurrent Inverse Function.DT" as Connection1001
                connect "Signal switch2.in" "OverCurrent Inverse Function.OUT" as Connection1009
                connect Goto45 "Basic Measurements (Split).out6" as Connection1010
                connect Goto46 "Basic Measurements (Split).out7" as Connection1011
                connect Goto47 "Basic Measurements (Split).out8" as Connection1012
                connect From41 "I_A(RMS).in" as Connection1013
                connect From42 "I_C(RMS).in" as Connection1014
                connect From43 "I_B(RMS).in" as Connection1015
                connect "OverCurrent Inverse Function.Inverse_Function" From31 as Connection1026
                [
                    breakpoints = 7960, 8880
                ]
                connect CTp.out Junction90 as Connection1028
                [
                    breakpoints = 7328, 8800
                ]
                connect Junction90 Goto39 as Connection1029
                connect CTp_Stt.in Junction90 as Connection1030
                connect time.in "OverCurrent Inverse Function.time_out" as Connection1031
                connect From44 "C function (Directional Protection).RCA" as Connection1033
                connect Goto54 Junction91 as Connection1034
                connect Junction91 Constant7.out as Connection1035
                connect RCA.in Junction91 as Connection1036
                connect Enable.out "Signal switch2.in2" as Connection1037

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Directional OverCurrent Block</p></body></html>"

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 7840, 8312
                size = 264, 216
            ]

            component gen_probe Trip {
            }
            [
                position = 8240, 8240
            ]

            component gen_comparator Comparator1 {
            }
            [
                position = 8160, 8320
                hide_name = True
            ]

            component src_constant Constant1 {
                execution_rate = "Ts"
                value = "0.5"
            }
            [
                position = 8056, 8400
                hide_name = True
            ]

            component gen_logic_op "Logical operator1" {
                operator = "NOT"
            }
            [
                position = 8304, 8320
            ]

            component "core/Rate Transition" "Rate Transition2" {
                execution_rate = "Ts"
            }
            [
                position = 8064, 8312
                hide_name = True
                size = 32, 32
            ]

            component "core/Rate Transition" "Rate Transition1" {
                execution_rate = "Ts_relay"
            }
            [
                position = 7616, 8312
                hide_name = True
                size = 32, 32
            ]

            port BM {
                position = left:auto
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 7536, 8312
            ]

            port "Trip DOCR" {
                position = right:auto
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8464, 8320
            ]

            comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Relay Output</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
            [
                position = 8408, 8240
            ]

            comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ANSI 67 (DOCR)</p></body></html> ENDCOMMENT 
            [
                position = 7784, 8168
            ]

            connect Constant1.out Comparator1.in2 as Connection69
            connect Comparator1.out Trip.in as Connection74
            [
                breakpoints = 8192, 8320
            ]
            connect "Trip DOCR" "Logical operator1.out" as Connection81
            connect "Logical operator1.in" Comparator1.out as Connection82
            connect Comparator1.in1 "Rate Transition2.out" as Connection85
            connect "Rate Transition2.in" "Function (67P).DOCR Trip" as Connection86
            connect BM "Rate Transition1.in" as Connection87
            connect "Rate Transition1.out" "Function (67P).BM" as Connection88

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Relay - 12 (Directional OverCurrent Relay)</p></body></html>"

                enable {
                    label = "Enable/Disable Relay"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "Enable"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "Enable"),int(0))
                    ENDCODE
                }

                Enable {
                    widget = edit
                    type = generic
                    default_value = "1"
                    nonvisible
                }

                function {
                    label = "I > 1 Function"
                    widget = combo
                    combo_values = "IEC Standard Inverse", "IEC Very Inverse", "IEC Extremely Inverse", "UK Long Time Inverse", "UK Rectifier", "IEEE Moderately Inverse", "IEEE Very Inverse", "IEEE Extremely Inverse", "US Inverse", "US Short Time Inverse"
                    type = string
                    default_value = "IEC Standard Inverse"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        dinamic(container_handle,"Dinamic",new_value)
                    ENDCODE

                    CODE property_value_edited
                        dinamic(container_handle,"Dinamic",new_value)
                    ENDCODE
                }

                fun_selected {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                direction {
                    label = "Direction / Non-Direction"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(0))
                    ENDCODE

                    CODE property_value_edited
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(0))
                    ENDCODE
                }

                dir_selected {
                    widget = edit
                    type = generic
                    default_value = "1"
                    nonvisible
                }

                I_Pick_Up {
                    label = "I > 1 Current Set"
                    widget = edit
                    type = generic
                    default_value = "15"
                    unit = "[A]"
                    group = "O/C Group"
                }

                TMS {
                    label = "I > 1 TMS "
                    widget = edit
                    type = generic
                    default_value = "0.313"
                    group = "O/C Group"
                }

                DT {
                    label = "I > 1 DT Adder"
                    widget = edit
                    type = generic
                    default_value = "0.3"
                    unit = "[A]"
                    group = "O/C Group"
                    nonvisible
                    disabled
                }

                CTp {
                    label = "Primary CT"
                    widget = edit
                    type = generic
                    default_value = "200"
                    group = "O/C Group"
                }

                RCA {
                    label = "I > Char angle"
                    widget = edit
                    type = generic
                    default_value = "45"
                    unit = "[deg]"
                    group = "O/C Group"
                }

                Ts_relay {
                    label = "Time Step"
                    widget = edit
                    type = generic
                    default_value = "Ts_new"
                    unit = "[s]"
                    group = "O/C Group"
                }

                properties {
                    label = "Press to visualize selected settings"
                    widget = button
                    type = string
                    default_value = "Show"
                    group = "O/C Group"
                    no_evaluate

                    CODE button_clicked
                        direction = mdl.get_property_disp_value(mdl.prop(container_handle, "direction"))
                        I_Pick_Up = mdl.get_property_disp_value(mdl.prop(container_handle, "I_Pick_Up"))
                        TMS = mdl.get_property_disp_value(mdl.prop(container_handle, "TMS"))
                        DT = mdl.get_property_disp_value(mdl.prop(container_handle, "DT"))
                        CTp = mdl.get_property_disp_value(mdl.prop(container_handle, "CTp"))
                        Ts_relay = mdl.get_property_disp_value(mdl.prop(container_handle, "Ts_relay"))
                        function = mdl.get_property_disp_value(mdl.prop(container_handle, "function"))
                        
                        
                        mdl.info('\n \n \n \n ')
                        mdl.info("###############     Relay - 12   ################# \n \n")
                        mdl.info("Selected function --> {}".format(function))
                        mdl.info("Directional relay --> {} ".format(direction))
                        mdl.info("Pick Up current set to --> {} [A]".format(I_Pick_Up))
                        mdl.info("Time multiple setting (TMS) set to --> {}".format(TMS))
                        mdl.info("Time dial setting (DT) set to --> {}".format(DT))
                        mdl.info("Primary CT set to --> {}".format(CTp))
                        mdl.info("Relay Time step (Ts) set to --> {}".format(Ts_relay))
                    ENDCODE
                }

                preview {
                    widget = button
                    type = string
                    default_value = "Preview OC Function"
                    group = "O/C Group"
                    no_evaluate

                    CODE button_clicked
                        graphic(container_handle,"Grafic")
                    ENDCODE
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE define_icon
                    image('p145.jpg')
                ENDCODE

                CODE init
                    from handlers.look_up_table import preview_lut
                    import matplotlib.pyplot as plt
                    
                    def dinamic(item_handle,prop,new_value):
                        if prop == "Dinamic":
                            I_Pick_Up = mdl.prop(item_handle, "I_Pick_Up")
                            TMS = mdl.prop(item_handle, "TMS")
                            DT = mdl.prop(item_handle, "DT")
                            Ts_relay = mdl.prop(item_handle, "Ts_relay")
                            fun_selected = mdl.prop(item_handle, "fun_selected")
                            
                            if new_value == "IEC Standard Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,0)
                                
                            elif new_value == "IEC Very Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,1)
                                
                            elif new_value == "IEC Extremely Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,2)
                                
                            elif new_value == "UK Long Time Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,3)
                                
                            elif new_value == "UK Rectifier":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,4)
                                
                            elif new_value == "IEEE Moderately Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,5)
                                
                            elif new_value == "IEEE Very Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,6)
                                
                            elif new_value == "IEEE Extremely Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,7)
                                
                            elif new_value == "US Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,8)
                                
                            elif new_value == "US Short Time Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,9)
                        
                    
                    
                    
                    def values(fun_selected):
                        if fun_selected == 0:
                            B = 0.14; A = 0.02; L = 0
                        elif fun_selected == 1:
                            B = 13.5; A = 1; L = 0
                        elif fun_selected == 2:
                            B = 80; A = 2; L = 0
                        elif fun_selected == 3:
                            B = 120; A = 1; L = 0
                        elif fun_selected == 4:
                            B = 45900; A = 5.6; L = 0
                        elif fun_selected == 5:
                            B = 0.0515; A = 0.02; L = 0.114
                        elif fun_selected == 6:
                            B = 19.61; A = 2; L = 0.491
                        elif fun_selected == 7:
                            B = 28.2; A = 2; L = 0.1217
                        elif fun_selected == 8:
                            B = 5.95; A = 2; L = 0.18
                        elif fun_selected == 9:
                            B = 0.16758; A = 0.02; L = 0.11858
                        return A,B,L;
                    
                    def graphic(item_handle,prop):
                            fun_selected = mdl.get_property_value(mdl.prop(item_handle, "fun_selected"))
                            TMS = float(mdl.get_property_disp_value(mdl.prop(item_handle, "TMS")))
                            DT = float(mdl.get_property_disp_value(mdl.prop(item_handle, "DT")))
                            A,B,L = values(fun_selected)
                            
                            multiplier =1
                            if ( mdl.is_property_enabled(mdl.prop(item_handle, "TMS")) == True):
                                if TMS > 0:
                                    multiplier = TMS
                            elif (mdl.is_property_enabled(mdl.prop(item_handle, "DT")) == True):
                                if DT > 0:
                                    multiplier = DT
                            
                            x = [];y = []
                            y = np.linspace(1,3,num=1000)
                            for M in y:
                                fun = multiplier*((B/((M**A)-1))+L)
                                x.append(fun)
                                
                            plt.plot(x,y)
                            plt.title('Characteristic Inverse Function')
                            plt.xlabel('Time [s]')
                            plt.ylabel('Current I(RMS)/I(Pick-UP)')
                            plt.xlim(0, 500)
                            plt.ylim(1, 3)
                            plt.grid(color='k', linestyle='-', linewidth=0.5)
                            plt.show()
                ENDCODE
            }
        }
        [
            position = 8240, 9888
            size = 136, 112
        ]

        component Subsystem Relay-4 {
            layout = dynamic
            component Subsystem "Function (67P)" {
                layout = dynamic
                component src_scada_input Reset {
                    execution_rate = "Ts_relay"
                    max = "1"
                    min = "0"
                    unit = ""
                }
                [
                    position = 7272, 8456
                ]

                component src_scada_input DT {
                    def_value = "0.025"
                    execution_rate = "Ts_relay"
                    max = "1.3"
                    min = "0.024"
                    unit = ""
                }
                [
                    position = 7272, 8608
                ]

                component src_constant Constant1 {
                    execution_rate = "Ts_relay"
                    value = "fun_selected"
                }
                [
                    position = 7272, 8880
                    hide_name = True
                ]

                component src_constant CTp {
                    execution_rate = "Ts_relay"
                    value = "CTp"
                }
                [
                    position = 7272, 8800
                ]

                component gen_probe RS {
                }
                [
                    position = 7456, 8424
                ]

                component gen_probe I_PKU {
                }
                [
                    position = 7456, 8488
                ]

                component src_scada_input I_Pick_Up {
                    def_value = "I_Pick_Up"
                    execution_rate = "Ts_relay"
                    unit = ""
                }
                [
                    position = 7272, 8536
                ]

                component src_constant Constant4 {
                    execution_rate = "Ts_relay"
                    value = "Ts_relay"
                }
                [
                    position = 7272, 8952
                    hide_name = True
                ]

                component gen_probe TMS_Stt {
                }
                [
                    position = 7456, 8656
                ]

                component src_scada_input TMS {
                    def_value = "TMS"
                    execution_rate = "Ts_relay"
                    unit = ""
                }
                [
                    position = 7272, 8704
                ]

                component gen_probe DT_Stt {
                }
                [
                    position = 7456, 8576
                ]

                component gen_product Product1 {
                }
                [
                    position = 8496, 8088
                    hide_name = True
                ]

                component gen_product Product2 {
                }
                [
                    position = 8496, 8136
                    hide_name = True
                ]

                component gen_product Product3 {
                }
                [
                    position = 8496, 8184
                    hide_name = True
                ]

                component gen_c_function "OverCurrent Inverse Function" {
                    global_variables = "real Irms[3];uint i;real M[3];real Ipk_2;real t[3];uint j;real Flag;real B;real A;real L;real multiplier;real counter;real out;real trans;real time;"
                    init_fnc = "/*Begin code section*/
B = 0.14; A = 0.02; L = 0; // Time Inverse Function parameters inicialization
Flag = 0;
TMS = 1;
CTp = 1;
Ipk_2= 1;
multiplier = 1;
out=0;
counter= 0; // 1/60 -> 1 cycle 
time = 1e9;
trans = 0;
/*End code section*/"
                    input_terminals = "inherit Inverse_Function;inherit I_Pick_Up;inherit TMS;inherit CTp;inherit I_Arms;inherit I_Brms;inherit I_Crms;inherit Reset;inherit DT;inherit Ts;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "[(\'Inverse_Function\', True), (\'I_Pick_Up\', True), (\'TMS\', True), (\'CTp\', True), (\'I_Arms\', True), (\'I_Brms\', True), (\'I_Crms\', True), (\'Reset\', True), (\'DT\', True), (\'Ts\', True)]"
                    output_fnc = "/*Begin code section*/
Irms[0] = I_Arms;Irms[1] = I_Brms;Irms[2] = I_Crms;

switch ( (int)Inverse_Function) // Switch Inverse function selected by user
{
    case 0: // Standard Inverse IEC
    {
        B = 0.14; A = 0.02; L = 0; multiplier = TMS;
        break;
    }
    case 1: // Very Inverse IEC
    {
        B = 13.5; A = 1; L = 0; multiplier = TMS;
        break;
    }
    case 2: // Extremely Inverse IEC
    {
        B = 80; A = 2; L = 0; multiplier = TMS;
        break;
    }
    case 3: // Long Time Inverse UK
    {
        B = 120; A = 1; L = 0; multiplier = TMS;
        break;
    }

    case 4: // Rectifier UK
    {
        B = 45900; A = 5.6; L = 0; multiplier = TMS;
        break;
    }
    case 5: // Moderately Invese IEEE
    {
        B = 0.0515; A = 0.02; L = 0.114; multiplier = DT;
        break;
    }
    case 6: // Very Inverse IEEE
    {
        B = 19.61; A = 2; L = 0.491; multiplier = DT;
        break;
    }
    case 7: // Extremely Inverse IEEE
    {
        B = 28.2; A = 2; L = 0.1217; multiplier = DT;
        break;
    }
    case 8: //  Inverse US
    {
        B = 5.95; A = 2; L = 0.18; multiplier = DT;
        break;
    }
    case 9: //  Inverse US
    {
        B = 0.16758; A = 0.02; L = 0.11858; multiplier = DT;
        break;
    }
    default: //  Inverse US
    {
        B = 0.14; A = 0.02; L = 0; multiplier = TMS;
        break;
    }
    
}



if ((int)Reset == 1 ) // Reset statement
{
    trans = 0;
    counter = 0;
    Flag = 0;
}
else if (trans == 0 )
{
    Ipk_2 = I_Pick_Up*CTp/5.0; // Pick-Up current in the primary side
    
    for(i=0; i<3; i++){
        M[i] = Irms[i]/Ipk_2; // Normalize RMS current based on the pickup.
        if(M[i]<=1.0){
            t[i] = 1e6;
        }
        else{
            t[i] = multiplier*((B/(pow(M[i],A)-1))+L); // Time folows IEC function
        }
    }
    
    if((t[0]<=t[1])&&(t[0]<=t[2])){
        time = t[0];
    }
    else if(t[1]<=t[2]){
        time = t[1];
    }
    else{
        time = t[2];
    }
    for(i=0; i<3; i++){
        if(Irms[i]>Ipk_2){
            Flag = 1;
            break;
        }
        else{
            Flag = 0;
        }
    }
}
    if(counter > time){
        out = 1;
        trans = 1;
    }
    else{
        out = 0;
        trans = 0;
    }
    
    counter *= Flag;

    counter += Flag  * Ts;
// OUTPUT
OUT = out;
    time_out = time;
/*End code section*/"
                    output_terminals = "real OUT;inherit time_out;"
                    output_terminals_dimensions = "inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "[(\'OUT\', True), (\'time_out\', True)]"
                }
                [
                    position = 8128, 8960
                    size = 224, 208
                ]

                component sys_signal_switch "Signal switch2" {
                    criterion = "ctrl != threshold"
                }
                [
                    position = 8480, 8976
                ]

                component src_constant Constant6 {
                    execution_rate = "Ts_relay"
                    value = "0"
                }
                [
                    position = 8352, 9024
                    hide_name = True
                ]

                component sys_signal_switch "Signal switch1" {
                    criterion = "ctrl != threshold"
                }
                [
                    position = 8464, 8544
                ]

                component src_constant Constant2 {
                    execution_rate = "Ts_relay"
                    signal_type = "uint"
                    value = "dir_selected"
                }
                [
                    position = 8464, 8464
                    rotation = right
                    hide_name = True
                ]

                component src_constant Constant3 {
                    execution_rate = "Ts_relay"
                }
                [
                    position = 8336, 8592
                    hide_name = True
                ]

                component gen_c_function "C function (Directional Protection)" {
                    global_variables = "real threshold_Low[3];real threshold_high[3];real vec[6];uint i;uint j;real Flag;real val[3];"
                    init_fnc = "/*Begin code section*/
// Input

// Output
Directional_Trip = 0;
// Transition variables inicialization
Flag = 0;
/*End code section*/"
                    input_terminals = "inherit I_a;inherit I_b;inherit I_c;inherit V_ab;inherit V_ca;inherit V_bc;inherit Reset;inherit RCA;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "[(\'I_a\', True), (\'I_b\', True), (\'I_c\', True), (\'V_ab\', True), (\'V_ca\', True), (\'V_bc\', True), (\'Reset\', True), (\'RCA\', True)]"
                    output_fnc = "/*Begin code section*/
// Voltage and Current vector
vec[0] = V_bc; vec[1] = V_ca; vec[2] = V_ab; 
vec[3] = I_a; vec[4] = I_b;vec[5] = I_c;

if ((int)Reset == 1 ) // Reset Statement
{
    Flag = 0; // Trip not allowed

}
else // All angles are placed from 1st to 4th quadrant 
{
    for (i=0;i<3;i++)
    {
        if(vec[i] < 0){vec[i]+=360;}
        if(vec[i+3] < 0){vec[i+3]+=360;}
        val[i] = vec[i]-vec[i+3]+RCA;
        if (val[i] > 360){val[i] -= 360;}
        if (val[i] < 0){val[i] += 360;}
        if ((val[i] >=270 && val[i] < 360) || (val[i] >=0 && val[i] <=90)){Flag = 1;break;}
        else {Flag = 0;}
    }
    
    }

    // OUTPUT
    Directional_Trip = Flag;
/*End code section*/"
                    output_terminals = "real Directional_Trip;"
                    output_terminals_dimensions = "inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "[(\'Directional_Trip\', True)]"
                }
                [
                    position = 8128, 8528
                    size = 224, 208
                ]

                component gen_probe "Directional Trip" {
                }
                [
                    position = 8352, 8376
                ]

                component msr_phase "Phase Difference1" {
                }
                [
                    position = 7856, 8056
                    hide_name = True
                ]

                component msr_phase "Phase Difference2" {
                }
                [
                    position = 7856, 7992
                    hide_name = True
                ]

                component msr_phase "Phase Difference3" {
                }
                [
                    position = 7856, 7928
                    hide_name = True
                ]

                component msr_phase "Phase Difference4" {
                }
                [
                    position = 7856, 7856
                    hide_name = True
                ]

                component src_sine "Sinusoidal Source3" {
                    execution_rate = "Ts_relay"
                    frequency = "60"
                }
                [
                    position = 7608, 7848
                    hide_name = True
                ]

                component msr_phase "Phase Difference5" {
                }
                [
                    position = 7856, 8128
                    hide_name = True
                ]

                component msr_phase "Phase Difference6" {
                }
                [
                    position = 7856, 8192
                    hide_name = True
                ]

                component gen_probe "I_A_(Angle)" {
                }
                [
                    position = 7968, 7856
                ]

                component gen_probe "I_B_(Angle)" {
                }
                [
                    position = 7968, 7928
                ]

                component gen_probe "I_C_(Angle)" {
                }
                [
                    position = 7968, 7992
                ]

                component gen_probe "V_BC_(Angle)" {
                }
                [
                    position = 7968, 8056
                ]

                component gen_probe "V_AB_(Angle)" {
                }
                [
                    position = 7968, 8192
                ]

                component gen_probe "V_CA_(Angle)" {
                }
                [
                    position = 7968, 8128
                ]

                component gen_bus_split "Basic Measurements (Split)" {
                    outputs = "9"
                }
                [
                    position = 7152, 8024
                ]

                component gen_probe "I_A(RMS)" {
                }
                [
                    position = 8520, 7848
                ]

                component gen_probe "I_B(RMS)" {
                }
                [
                    position = 8520, 7960
                ]

                component gen_probe "I_C(RMS)" {
                }
                [
                    position = 8520, 7904
                ]

                component gen_probe CTp_Stt {
                }
                [
                    position = 7456, 8760
                ]

                component gen_probe time {
                }
                [
                    position = 8304, 9104
                ]

                component src_constant Constant7 {
                    execution_rate = "Ts_relay"
                    value = "RCA"
                }
                [
                    position = 7272, 9016
                    hide_name = True
                ]

                component gen_probe RCA {
                }
                [
                    position = 7456, 8984
                ]

                component src_scada_input Enable {
                    def_value = "Enable"
                    execution_rate = "Ts_relay"
                    format = "uint"
                    max = "1"
                    min = "0"
                    signal_type = "uint"
                    unit = ""
                }
                [
                    position = 8480, 8888
                    rotation = right
                ]

                port "DOCR Trip" {
                    position = right:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8624, 8976
                ]

                port BM {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6984, 8024
                ]

                tag Goto39 {
                    value = "CTp"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8800
                    hide_name = True
                ]

                tag Goto40 {
                    value = "DT"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8608
                    hide_name = True
                ]

                tag Goto41 {
                    value = "I_Pick-Up"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8536
                    hide_name = True
                ]

                tag Goto42 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8456
                    hide_name = True
                ]

                tag Goto48 {
                    value = "Inverse_Function"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8880
                    hide_name = True
                ]

                tag Goto49 {
                    value = "TMS"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8704
                    hide_name = True
                ]

                tag Goto50 {
                    value = "Ts_relay"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8952
                    hide_name = True
                ]

                tag From20 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8080
                    hide_name = True
                    size = 99, 20
                ]

                tag From21 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8128
                    hide_name = True
                    size = 99, 20
                ]

                tag From22 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8176
                    hide_name = True
                    size = 99, 20
                ]

                tag From25 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8096
                    hide_name = True
                ]

                tag From26 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8144
                    hide_name = True
                ]

                tag From27 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8192
                    hide_name = True
                ]

                tag From28 {
                    value = "CTp"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8928
                    hide_name = True
                ]

                tag From29 {
                    value = "TMS"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8912
                    hide_name = True
                ]

                tag From30 {
                    value = "I_Pick-Up"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8896
                    hide_name = True
                ]

                tag From31 {
                    value = "Inverse_Function"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8880
                    hide_name = True
                ]

                tag From32 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8992
                    hide_name = True
                ]

                tag From34 {
                    value = "DT"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 9008
                    hide_name = True
                ]

                tag Goto38 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8648, 8544
                    hide_name = True
                    size = 104, 20
                ]

                tag From35 {
                    value = "Ts_relay"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7808, 9024
                    hide_name = True
                    size = 99, 20
                ]

                tag From5 {
                    value = "I_A_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8448
                    hide_name = True
                ]

                tag From6 {
                    value = "I_B_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8472
                    hide_name = True
                ]

                tag From7 {
                    value = "I_C_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8496
                    hide_name = True
                ]

                tag From8 {
                    value = "V_AB_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8520
                    hide_name = True
                ]

                tag From9 {
                    value = "V_CA_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8544
                    hide_name = True
                ]

                tag From10 {
                    value = "V_BC_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8568
                    hide_name = True
                ]

                tag From23 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8592
                    hide_name = True
                ]

                tag Goto7 {
                    value = "V_BC_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8032
                    hide_name = True
                ]

                tag Goto8 {
                    value = "V_AB_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8168
                    hide_name = True
                ]

                tag Goto9 {
                    value = "V_CA_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8104
                    hide_name = True
                ]

                tag Goto10 {
                    value = "I_A_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7824
                    hide_name = True
                ]

                tag Goto11 {
                    value = "I_B_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7896
                    hide_name = True
                ]

                tag Goto12 {
                    value = "I_C_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7968
                    hide_name = True
                ]

                tag Goto13 {
                    value = "I_A"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 7960
                    hide_name = True
                ]

                tag Goto14 {
                    value = "I_B"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 7976
                    hide_name = True
                ]

                tag Goto15 {
                    value = "I_C"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 7992
                    hide_name = True
                ]

                tag Goto16 {
                    value = "V_BC"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 8008
                    hide_name = True
                ]

                tag Goto17 {
                    value = "V_CA"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 8024
                    hide_name = True
                ]

                tag Goto18 {
                    value = "V_AB"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 8040
                    hide_name = True
                ]

                tag From13 {
                    value = "I_A"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 7864
                    hide_name = True
                ]

                tag From14 {
                    value = "I_B"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 7936
                    hide_name = True
                ]

                tag From15 {
                    value = "I_C"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8000
                    hide_name = True
                ]

                tag From16 {
                    value = "V_BC"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8064
                    hide_name = True
                ]

                tag From36 {
                    value = "V_CA"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8136
                    hide_name = True
                ]

                tag From37 {
                    value = "V_AB"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8200
                    hide_name = True
                ]

                tag Goto45 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 8056
                    hide_name = True
                ]

                tag Goto46 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 8072
                    hide_name = True
                ]

                tag Goto47 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 8088
                    hide_name = True
                ]

                tag Goto51 {
                    value = "IA(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8088
                    hide_name = True
                    size = 104, 20
                ]

                tag Goto52 {
                    value = "IB(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8136
                    hide_name = True
                    size = 104, 20
                ]

                tag Goto53 {
                    value = "IC(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8184
                    hide_name = True
                    size = 104, 20
                ]

                tag From38 {
                    value = "IA(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8944
                    hide_name = True
                ]

                tag From39 {
                    value = "IB(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8960
                    hide_name = True
                ]

                tag From40 {
                    value = "IC(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8976
                    hide_name = True
                ]

                tag From41 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7848
                    hide_name = True
                ]

                tag From42 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7904
                    hide_name = True
                ]

                tag From43 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7960
                    hide_name = True
                ]

                tag Goto54 {
                    value = "RCA"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 9016
                    hide_name = True
                ]

                tag From44 {
                    value = "RCA"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8608
                    hide_name = True
                ]

                junction Junction81 sp
                [
                    position = 7328, 8456
                ]

                junction Junction84 sp
                [
                    position = 7352, 8536
                ]

                junction Junction86 sp
                [
                    position = 7328, 8608
                ]

                junction Junction88 sp
                [
                    position = 7336, 8704
                ]

                junction Junction89 sp
                [
                    position = 8296, 8528
                ]

                junction Junction1 sp
                [
                    position = 7936, 7856
                ]

                junction Junction2 sp
                [
                    position = 7936, 7928
                ]

                junction Junction3 sp
                [
                    position = 7936, 7992
                ]

                junction Junction4 sp
                [
                    position = 7936, 8056
                ]

                junction Junction5 sp
                [
                    position = 7936, 8128
                ]

                junction Junction6 sp
                [
                    position = 7936, 8192
                ]

                junction Junction7 sp
                [
                    position = 7648, 7848
                ]

                junction Junction8 sp
                [
                    position = 7648, 7920
                ]

                junction Junction9 sp
                [
                    position = 7648, 7984
                ]

                junction Junction10 sp
                [
                    position = 7648, 8048
                ]

                junction Junction11 sp
                [
                    position = 7648, 8120
                ]

                junction Junction90 sp
                [
                    position = 7344, 8800
                ]

                junction Junction91 sp
                [
                    position = 7328, 9016
                ]

                comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Basic Measurements</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 7088, 7896
                ]

                comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Phase Measurements</p></body></html> ENDCOMMENT 
                [
                    position = 7784, 7744
                ]

                comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">RMS Currents Measurements</p></body></html> ENDCOMMENT 
                [
                    position = 8344, 7800
                ]

                comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SCADA INPUTS</p></body></html> ENDCOMMENT 
                [
                    position = 7296, 8352
                ]

                comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directionality &amp;&amp; Current (RMS)</p></body></html> ENDCOMMENT 
                [
                    position = 8328, 7992
                ]

                comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directional Protecction </p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 8040, 8368
                ]

                comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">OverCurrent Protection</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 8032, 8800
                ]

                connect Constant1.out Goto48 as Connection902
                [
                    breakpoints = 7328, 8880
                ]
                connect Reset.out Junction81 as Connection843
                connect Junction81 Goto42 as Connection844
                connect RS.in Junction81 as Connection845
                connect I_PKU.in Junction84 as Connection937
                connect Junction84 Goto41 as Connection938
                [
                    breakpoints = 7352, 8528
                ]
                connect I_Pick_Up.out Junction84 as Connection939
                connect Goto50 Constant4.out as Connection943
                connect DT.out Junction86 as Connection956
                connect Junction86 Goto40 as Connection957
                [
                    breakpoints = 7328, 8608
                ]
                connect DT_Stt.in Junction86 as Connection958
                connect Goto49 Junction88 as Connection964
                connect Junction88 TMS.out as Connection965
                connect TMS_Stt.in Junction88 as Connection966
                connect From20 Product1.in as Connection355
                connect From21 Product2.in as Connection357
                connect From22 Product3.in as Connection359
                connect From25 Product1.in1 as Connection708
                connect From26 Product2.in1 as Connection709
                connect From27 Product3.in1 as Connection710
                connect From28 "OverCurrent Inverse Function.CTp" as Connection714
                connect From29 "OverCurrent Inverse Function.TMS" as Connection715
                connect From30 "OverCurrent Inverse Function.I_Pick_Up" as Connection917
                connect From35 "OverCurrent Inverse Function.Ts" as Connection944
                connect Constant6.out "Signal switch2.in1" as Connection972
                connect "DOCR Trip" "Signal switch2.out" as Connection973
                connect Constant2.out "Signal switch1.in2" as Connection880
                connect Constant3.out "Signal switch1.in1" as Connection886
                connect From5 "C function (Directional Protection).I_a" as Connection336
                connect From6 "C function (Directional Protection).I_b" as Connection337
                connect From7 "C function (Directional Protection).I_c" as Connection338
                connect From8 "C function (Directional Protection).V_ab" as Connection339
                connect From9 "C function (Directional Protection).V_ca" as Connection340
                connect From10 "C function (Directional Protection).V_bc" as Connection341
                connect From23 "C function (Directional Protection).Reset" as Connection554
                connect Goto38 "Signal switch1.out" as Connection977
                connect "C function (Directional Protection).Directional_Trip" Junction89 as Connection979
                connect Junction89 "Signal switch1.in" as Connection980
                connect "Directional Trip.in" Junction89 as Connection981
                [
                    breakpoints = 8296, 8376; 8296, 8528
                ]
                connect "Basic Measurements (Split).in" BM as Connection243
                connect "I_A_(Angle).in" Junction1 as Connection317
                connect Junction1 "Phase Difference4.phase_diff" as Connection318
                connect Goto10 Junction1 as Connection319
                connect "Phase Difference3.phase_diff" Junction2 as Connection320
                connect Junction2 "I_B_(Angle).in" as Connection321
                connect Goto11 Junction2 as Connection322
                connect "Phase Difference2.phase_diff" Junction3 as Connection323
                connect Junction3 "I_C_(Angle).in" as Connection324
                connect Goto12 Junction3 as Connection325
                connect "V_BC_(Angle).in" Junction4 as Connection327
                connect Junction4 "Phase Difference1.phase_diff" as Connection328
                connect Goto7 Junction4 as Connection329
                connect "V_CA_(Angle).in" Junction5 as Connection982
                connect Junction5 "Phase Difference5.phase_diff" as Connection332
                connect Goto9 Junction5 as Connection983
                connect "V_AB_(Angle).in" Junction6 as Connection984
                connect Junction6 "Phase Difference6.phase_diff" as Connection985
                connect Goto8 Junction6 as Connection986
                connect "Sinusoidal Source3.out" Junction7 as Connection987
                connect Junction7 "Phase Difference4.signal2" as Connection988
                connect "Phase Difference3.signal2" Junction8 as Connection342
                connect Junction8 Junction7 as Connection343
                connect "Phase Difference2.signal2" Junction9 as Connection345
                connect Junction9 Junction8 as Connection346
                connect "Phase Difference1.signal2" Junction10 as Connection348
                connect Junction10 Junction9 as Connection349
                connect "Phase Difference5.signal2" Junction11 as Connection351
                connect Junction11 Junction10 as Connection352
                connect "Phase Difference6.signal2" Junction11 as Connection353
                connect Goto13 "Basic Measurements (Split).out" as Connection354
                connect Goto14 "Basic Measurements (Split).out1" as Connection989
                connect Goto15 "Basic Measurements (Split).out2" as Connection356
                connect Goto16 "Basic Measurements (Split).out3" as Connection990
                connect Goto17 "Basic Measurements (Split).out4" as Connection358
                connect Goto18 "Basic Measurements (Split).out5" as Connection991
                connect From13 "Phase Difference4.signal1" as Connection360
                connect From14 "Phase Difference3.signal1" as Connection361
                connect From15 "Phase Difference2.signal1" as Connection362
                connect From16 "Phase Difference1.signal1" as Connection363
                connect From36 "Phase Difference5.signal1" as Connection364
                connect From37 "Phase Difference6.signal1" as Connection365
                connect Goto51 Product1.out as Connection994
                connect Goto52 Product2.out as Connection995
                connect Goto53 Product3.out as Connection996
                connect From38 "OverCurrent Inverse Function.I_Arms" as Connection997
                connect From39 "OverCurrent Inverse Function.I_Brms" as Connection998
                connect From40 "OverCurrent Inverse Function.I_Crms" as Connection999
                connect From32 "OverCurrent Inverse Function.Reset" as Connection1000
                connect From34 "OverCurrent Inverse Function.DT" as Connection1001
                connect "Signal switch2.in" "OverCurrent Inverse Function.OUT" as Connection1009
                connect Goto45 "Basic Measurements (Split).out6" as Connection1010
                connect Goto46 "Basic Measurements (Split).out7" as Connection1011
                connect Goto47 "Basic Measurements (Split).out8" as Connection1012
                connect From41 "I_A(RMS).in" as Connection1013
                connect From42 "I_C(RMS).in" as Connection1014
                connect From43 "I_B(RMS).in" as Connection1015
                connect "OverCurrent Inverse Function.Inverse_Function" From31 as Connection1026
                [
                    breakpoints = 7960, 8880
                ]
                connect CTp.out Junction90 as Connection1028
                [
                    breakpoints = 7328, 8800
                ]
                connect Junction90 Goto39 as Connection1029
                connect CTp_Stt.in Junction90 as Connection1030
                connect time.in "OverCurrent Inverse Function.time_out" as Connection1031
                connect From44 "C function (Directional Protection).RCA" as Connection1033
                connect Goto54 Junction91 as Connection1034
                connect Junction91 Constant7.out as Connection1035
                connect RCA.in Junction91 as Connection1036
                connect Enable.out "Signal switch2.in2" as Connection1037

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Directional OverCurrent Block</p></body></html>"

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 7840, 8312
                size = 264, 216
            ]

            component gen_probe Trip {
            }
            [
                position = 8240, 8240
            ]

            component gen_comparator Comparator1 {
            }
            [
                position = 8160, 8320
                hide_name = True
            ]

            component src_constant Constant1 {
                execution_rate = "Ts"
                value = "0.5"
            }
            [
                position = 8056, 8400
                hide_name = True
            ]

            component gen_logic_op "Logical operator1" {
                operator = "NOT"
            }
            [
                position = 8304, 8320
            ]

            component "core/Rate Transition" "Rate Transition2" {
                execution_rate = "Ts"
            }
            [
                position = 8064, 8312
                hide_name = True
                size = 32, 32
            ]

            component "core/Rate Transition" "Rate Transition1" {
                execution_rate = "Ts_relay"
            }
            [
                position = 7616, 8312
                hide_name = True
                size = 32, 32
            ]

            port BM {
                position = left:auto
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 7536, 8312
            ]

            port "Trip DOCR" {
                position = right:auto
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8464, 8320
            ]

            comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Relay Output</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
            [
                position = 8408, 8240
            ]

            comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ANSI 67 (DOCR)</p></body></html> ENDCOMMENT 
            [
                position = 7784, 8168
            ]

            connect Constant1.out Comparator1.in2 as Connection69
            connect Comparator1.out Trip.in as Connection74
            [
                breakpoints = 8192, 8320
            ]
            connect "Trip DOCR" "Logical operator1.out" as Connection81
            connect "Logical operator1.in" Comparator1.out as Connection82
            connect Comparator1.in1 "Rate Transition2.out" as Connection85
            connect "Rate Transition2.in" "Function (67P).DOCR Trip" as Connection86
            connect BM "Rate Transition1.in" as Connection87
            connect "Rate Transition1.out" "Function (67P).BM" as Connection88

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Relay - 4 (Directional OverCurrent Relay)</p></body></html>"

                enable {
                    label = "Enable/Disable Relay"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "Enable"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "Enable"),int(0))
                    ENDCODE
                }

                Enable {
                    widget = edit
                    type = generic
                    default_value = "1"
                    nonvisible
                }

                function {
                    label = "I > 1 Function"
                    widget = combo
                    combo_values = "IEC Standard Inverse", "IEC Very Inverse", "IEC Extremely Inverse", "UK Long Time Inverse", "UK Rectifier", "IEEE Moderately Inverse", "IEEE Very Inverse", "IEEE Extremely Inverse", "US Inverse", "US Short Time Inverse"
                    type = string
                    default_value = "IEC Standard Inverse"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        dinamic(container_handle,"Dinamic",new_value)
                    ENDCODE

                    CODE property_value_edited
                        dinamic(container_handle,"Dinamic",new_value)
                    ENDCODE
                }

                fun_selected {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                direction {
                    label = "Direction / Non-Direction"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(0))
                    ENDCODE

                    CODE property_value_edited
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(0))
                    ENDCODE
                }

                dir_selected {
                    widget = edit
                    type = generic
                    default_value = "1"
                    nonvisible
                }

                I_Pick_Up {
                    label = "I > 1 Current Set"
                    widget = edit
                    type = generic
                    default_value = "3"
                    unit = "[A]"
                    group = "O/C Group"
                }

                TMS {
                    label = "I > 1 TMS "
                    widget = edit
                    type = generic
                    default_value = "0.347"
                    group = "O/C Group"
                }

                DT {
                    label = "I > 1 DT Adder"
                    widget = edit
                    type = generic
                    default_value = "0.3"
                    unit = "[A]"
                    group = "O/C Group"
                    nonvisible
                    disabled
                }

                CTp {
                    label = "Primary CT"
                    widget = edit
                    type = generic
                    default_value = "200"
                    group = "O/C Group"
                }

                RCA {
                    label = "I > Char angle"
                    widget = edit
                    type = generic
                    default_value = "45"
                    unit = "[deg]"
                    group = "O/C Group"
                }

                Ts_relay {
                    label = "Time Step"
                    widget = edit
                    type = generic
                    default_value = "Ts_new"
                    unit = "[s]"
                    group = "O/C Group"
                }

                properties {
                    label = "Press to visualize selected settings"
                    widget = button
                    type = string
                    default_value = "Show"
                    group = "O/C Group"
                    no_evaluate

                    CODE button_clicked
                        direction = mdl.get_property_disp_value(mdl.prop(container_handle, "direction"))
                        I_Pick_Up = mdl.get_property_disp_value(mdl.prop(container_handle, "I_Pick_Up"))
                        TMS = mdl.get_property_disp_value(mdl.prop(container_handle, "TMS"))
                        DT = mdl.get_property_disp_value(mdl.prop(container_handle, "DT"))
                        CTp = mdl.get_property_disp_value(mdl.prop(container_handle, "CTp"))
                        Ts_relay = mdl.get_property_disp_value(mdl.prop(container_handle, "Ts_relay"))
                        function = mdl.get_property_disp_value(mdl.prop(container_handle, "function"))
                        
                        
                        mdl.info('\n \n \n \n ')
                        mdl.info("###############     Relay - 4   ################# \n \n")
                        mdl.info("Selected function --> {}".format(function))
                        mdl.info("Directional relay --> {} ".format(direction))
                        mdl.info("Pick Up current set to --> {} [A]".format(I_Pick_Up))
                        mdl.info("Time multiple setting (TMS) set to --> {}".format(TMS))
                        mdl.info("Time dial setting (DT) set to --> {}".format(DT))
                        mdl.info("Primary CT set to --> {}".format(CTp))
                        mdl.info("Relay Time step (Ts) set to --> {}".format(Ts_relay))
                    ENDCODE
                }

                preview {
                    widget = button
                    type = string
                    default_value = "Preview OC Function"
                    group = "O/C Group"
                    no_evaluate

                    CODE button_clicked
                        graphic(container_handle,"Grafic")
                    ENDCODE
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE define_icon
                    image('p145.jpg')
                ENDCODE

                CODE init
                    from handlers.look_up_table import preview_lut
                    import matplotlib.pyplot as plt
                    
                    def dinamic(item_handle,prop,new_value):
                        if prop == "Dinamic":
                            I_Pick_Up = mdl.prop(item_handle, "I_Pick_Up")
                            TMS = mdl.prop(item_handle, "TMS")
                            DT = mdl.prop(item_handle, "DT")
                            Ts_relay = mdl.prop(item_handle, "Ts_relay")
                            fun_selected = mdl.prop(item_handle, "fun_selected")
                            
                            if new_value == "IEC Standard Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,0)
                                
                            elif new_value == "IEC Very Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,1)
                                
                            elif new_value == "IEC Extremely Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,2)
                                
                            elif new_value == "UK Long Time Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,3)
                                
                            elif new_value == "UK Rectifier":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,4)
                                
                            elif new_value == "IEEE Moderately Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,5)
                                
                            elif new_value == "IEEE Very Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,6)
                                
                            elif new_value == "IEEE Extremely Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,7)
                                
                            elif new_value == "US Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,8)
                                
                            elif new_value == "US Short Time Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,9)
                        
                    
                    
                    
                    def values(fun_selected):
                        if fun_selected == 0:
                            B = 0.14; A = 0.02; L = 0
                        elif fun_selected == 1:
                            B = 13.5; A = 1; L = 0
                        elif fun_selected == 2:
                            B = 80; A = 2; L = 0
                        elif fun_selected == 3:
                            B = 120; A = 1; L = 0
                        elif fun_selected == 4:
                            B = 45900; A = 5.6; L = 0
                        elif fun_selected == 5:
                            B = 0.0515; A = 0.02; L = 0.114
                        elif fun_selected == 6:
                            B = 19.61; A = 2; L = 0.491
                        elif fun_selected == 7:
                            B = 28.2; A = 2; L = 0.1217
                        elif fun_selected == 8:
                            B = 5.95; A = 2; L = 0.18
                        elif fun_selected == 9:
                            B = 0.16758; A = 0.02; L = 0.11858
                        return A,B,L;
                    
                    def graphic(item_handle,prop):
                            fun_selected = mdl.get_property_value(mdl.prop(item_handle, "fun_selected"))
                            TMS = float(mdl.get_property_disp_value(mdl.prop(item_handle, "TMS")))
                            DT = float(mdl.get_property_disp_value(mdl.prop(item_handle, "DT")))
                            A,B,L = values(fun_selected)
                            
                            multiplier =1
                            if ( mdl.is_property_enabled(mdl.prop(item_handle, "TMS")) == True):
                                if TMS > 0:
                                    multiplier = TMS
                            elif (mdl.is_property_enabled(mdl.prop(item_handle, "DT")) == True):
                                if DT > 0:
                                    multiplier = DT
                            
                            x = [];y = []
                            y = np.linspace(1,3,num=1000)
                            for M in y:
                                fun = multiplier*((B/((M**A)-1))+L)
                                x.append(fun)
                                
                            plt.plot(x,y)
                            plt.title('Characteristic Inverse Function')
                            plt.xlabel('Time [s]')
                            plt.ylabel('Current I(RMS)/I(Pick-UP)')
                            plt.xlim(0, 500)
                            plt.ylim(1, 3)
                            plt.grid(color='k', linestyle='-', linewidth=0.5)
                            plt.show()
                ENDCODE
            }
        }
        [
            position = 10176, 7728
            rotation = left
            scale = 1, -1
            size = 136, 112
        ]

        component Subsystem "Couplin(4ph)-1" {
            layout = dynamic
            component pas_capacitor C4 {
                capacitance = "Cap"
            }
            [
                position = 8488, 8344
                rotation = right
            ]

            component pas_capacitor C5 {
                capacitance = "Cap"
            }
            [
                position = 8552, 8344
                rotation = right
            ]

            component pas_capacitor C6 {
                capacitance = "Cap"
            }
            [
                position = 8624, 8344
                rotation = right
            ]

            component pas_capacitor C1 {
                capacitance = "Cap"
            }
            [
                position = 7856, 8344
                rotation = right
            ]

            component pas_capacitor C2 {
                capacitance = "Cap"
            }
            [
                position = 7928, 8344
                rotation = right
            ]

            component pas_capacitor C3 {
                capacitance = "Cap"
            }
            [
                position = 8000, 8344
                rotation = right
            ]

            component "core/Four Phase TLM Core Coupling" "Core Coupling 6" {
                embedded_components = "True"
                inductance = "L"
            }
            [
                position = 8240, 8224
                hide_name = True
                size = 12, 352
            ]

            port Port1 {
                label = "A+"
                position = left:1
                kind = pe
            }
            [
                position = 7704, 8080
            ]

            port Port2 {
                label = "B+"
                position = left:2
                kind = pe
            }
            [
                position = 7704, 8176
            ]

            port Port3 {
                label = "C+"
                position = left:3
                kind = pe
            }
            [
                position = 7704, 8272
            ]

            port Port4 {
                label = "A-"
                position = right:4
                kind = pe
            }
            [
                position = 8800, 8080
                scale = -1, 1
            ]

            port Port5 {
                label = "B-"
                position = right:5
                kind = pe
            }
            [
                position = 8800, 8176
                scale = -1, 1
            ]

            port Port6 {
                label = "C-"
                position = right:6
                kind = pe
            }
            [
                position = 8800, 8272
                scale = -1, 1
            ]

            port Port7 {
                label = "G1"
                position = bottom:7
                kind = pe
            }
            [
                position = 8184, 8512
                rotation = left
            ]

            port Port8 {
                label = "G2"
                position = bottom:8
                kind = pe
            }
            [
                position = 8288, 8512
                rotation = left
            ]

            junction Junction1 pe
            [
                position = 7856, 8080
            ]

            junction Junction2 pe
            [
                position = 7928, 8176
            ]

            junction Junction3 pe
            [
                position = 8000, 8272
            ]

            junction Junction4 pe
            [
                position = 8488, 8080
            ]

            junction Junction5 pe
            [
                position = 8552, 8176
            ]

            junction Junction6 pe
            [
                position = 8624, 8272
            ]

            junction Junction7 pe
            [
                position = 8184, 8384
            ]

            junction Junction8 pe
            [
                position = 8288, 8384
            ]

            connect Port1 Junction1 as Connection7
            connect Junction1 "Core Coupling 6.a_in" as Connection8
            connect C1.p_node Junction1 as Connection9
            connect Port2 Junction2 as Connection10
            connect Junction2 "Core Coupling 6.b_in" as Connection11
            connect C2.p_node Junction2 as Connection12
            connect Port3 Junction3 as Connection13
            connect Junction3 "Core Coupling 6.c_in" as Connection14
            connect C3.p_node Junction3 as Connection15
            connect Port4 Junction4 as Connection16
            connect Junction4 "Core Coupling 6.a_out" as Connection17
            connect C4.p_node Junction4 as Connection18
            connect Port5 Junction5 as Connection19
            connect Junction5 "Core Coupling 6.b_out" as Connection20
            connect C5.p_node Junction5 as Connection21
            connect Port6 Junction6 as Connection22
            connect Junction6 "Core Coupling 6.c_out" as Connection23
            connect C6.p_node Junction6 as Connection24
            connect C1.n_node C2.n_node as Connection31
            connect C3.n_node C2.n_node as Connection32
            connect Port7 Junction7 as Connection34
            connect Junction7 C2.n_node as Connection35
            connect "Core Coupling 6.d_in" Junction7 as Connection36
            connect C4.n_node C5.n_node as Connection37
            connect C6.n_node C5.n_node as Connection38
            connect Port8 Junction8 as Connection40
            connect Junction8 C5.n_node as Connection41
            connect "Core Coupling 6.d_out" Junction8 as Connection42

            Cap = "C"
            L = "L2"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Four Phase TML Core Coupling with Capacitors in Parallel.</p></body></html>"

                L {
                    label = "Set inductance value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[H]"
                }

                Cap {
                    label = "Set capacitors value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[F]"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE define_icon
                ENDCODE
            }
        }
        [
            position = 9128, 7384
            size = 48, 64
        ]

        component Subsystem "Couplin(3ph)-1" {
            layout = dynamic
            component pas_capacitor C4 {
                capacitance = "Cap"
            }
            [
                position = 8488, 8344
                rotation = right
            ]

            component pas_capacitor C5 {
                capacitance = "Cap"
            }
            [
                position = 8552, 8344
                rotation = right
            ]

            component pas_capacitor C6 {
                capacitance = "Cap"
            }
            [
                position = 8624, 8344
                rotation = right
            ]

            component "core/Three Phase TLM Core Coupling" "Core Coupling 1" {
                embedded_components = "True"
                inductance = "L"
            }
            [
                position = 8208, 8176
                size = 12, 256
            ]

            component pas_capacitor C1 {
                capacitance = "Cap"
            }
            [
                position = 7856, 8344
                rotation = right
            ]

            component pas_capacitor C2 {
                capacitance = "Cap"
            }
            [
                position = 7928, 8344
                rotation = right
            ]

            component pas_capacitor C3 {
                capacitance = "Cap"
            }
            [
                position = 8000, 8344
                rotation = right
            ]

            port Port1 {
                label = "A+"
                position = left:1
                kind = pe
            }
            [
                position = 7704, 8080
            ]

            port Port2 {
                label = "B+"
                position = left:2
                kind = pe
            }
            [
                position = 7704, 8176
            ]

            port Port3 {
                label = "C+"
                position = left:3
                kind = pe
            }
            [
                position = 7704, 8272
            ]

            port Port4 {
                label = "A-"
                position = right:4
                kind = pe
            }
            [
                position = 8800, 8080
                scale = -1, 1
            ]

            port Port5 {
                label = "B-"
                position = right:5
                kind = pe
            }
            [
                position = 8800, 8176
                scale = -1, 1
            ]

            port Port6 {
                label = "C-"
                position = right:6
                kind = pe
            }
            [
                position = 8800, 8272
                scale = -1, 1
            ]

            port Port7 {
                label = "GND1"
                position = bottom:7
                kind = pe
            }
            [
                position = 7928, 8464
                rotation = left
                hide_name = True
            ]

            port Port8 {
                label = "GND2"
                position = bottom:8
                kind = pe
            }
            [
                position = 8552, 8448
                rotation = left
                hide_name = True
            ]

            junction Junction1 pe
            [
                position = 7856, 8080
            ]

            junction Junction2 pe
            [
                position = 7928, 8176
            ]

            junction Junction3 pe
            [
                position = 8000, 8272
            ]

            junction Junction4 pe
            [
                position = 8624, 8272
            ]

            junction Junction5 pe
            [
                position = 8552, 8176
            ]

            junction Junction6 pe
            [
                position = 8488, 8080
            ]

            junction Junction7 pe
            [
                position = 8552, 8384
            ]

            junction Junction8 pe
            [
                position = 7928, 8384
            ]

            connect C1.p_node Junction1 as Connection35
            connect Junction1 Port1 as Connection36
            [
                breakpoints = 7856, 8080
            ]
            connect "Core Coupling 1.a_in" Junction1 as Connection37
            connect Port2 Junction2 as Connection38
            connect Junction2 C2.p_node as Connection39
            [
                breakpoints = 7928, 8176
            ]
            connect "Core Coupling 1.b_in" Junction2 as Connection40
            connect Port3 Junction3 as Connection41
            connect Junction3 C3.p_node as Connection42
            [
                breakpoints = 8000, 8272
            ]
            connect "Core Coupling 1.c_in" Junction3 as Connection43
            connect C6.p_node Junction4 as Connection44
            connect Junction4 Port6 as Connection45
            [
                breakpoints = 8624, 8272
            ]
            connect "Core Coupling 1.c_out" Junction4 as Connection46
            connect Port5 Junction5 as Connection47
            connect Junction5 C5.p_node as Connection48
            [
                breakpoints = 8552, 8176
            ]
            connect C1.n_node C2.n_node as Connection25
            connect "Core Coupling 1.b_out" Junction5 as Connection49
            connect C4.p_node Junction6 as Connection50
            connect C6.n_node C5.n_node as Connection28
            connect Junction6 Port4 as Connection51
            [
                breakpoints = 8488, 8080
            ]
            connect "Core Coupling 1.a_out" Junction6 as Connection52
            connect C4.n_node Junction7 as Connection53
            connect Junction7 C5.n_node as Connection54
            connect Port8 Junction7 as Connection55
            connect C3.n_node Junction8 as Connection56
            connect Junction8 C2.n_node as Connection57
            connect Port7 Junction8 as Connection58

            Cap = "C"
            L = "L5"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Three Phase TML Core Coupling with Capacitors in Parallel.</p></body></html>"

                L {
                    label = "Set inductance value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[H]"
                }

                Cap {
                    label = "Set capacitors value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[F]"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE
            }
        }
        [
            position = 6952, 10088
            hide_name = True
            size = 48, 64
        ]

        component Subsystem "Couplin(4ph)-2" {
            layout = dynamic
            component pas_capacitor C4 {
                capacitance = "Cap"
            }
            [
                position = 8488, 8344
                rotation = right
            ]

            component pas_capacitor C5 {
                capacitance = "Cap"
            }
            [
                position = 8552, 8344
                rotation = right
            ]

            component pas_capacitor C6 {
                capacitance = "Cap"
            }
            [
                position = 8624, 8344
                rotation = right
            ]

            component pas_capacitor C1 {
                capacitance = "Cap"
            }
            [
                position = 7856, 8344
                rotation = right
            ]

            component pas_capacitor C2 {
                capacitance = "Cap"
            }
            [
                position = 7928, 8344
                rotation = right
            ]

            component pas_capacitor C3 {
                capacitance = "Cap"
            }
            [
                position = 8000, 8344
                rotation = right
            ]

            component "core/Four Phase TLM Core Coupling" "Core Coupling 6" {
                embedded_components = "True"
                inductance = "L"
            }
            [
                position = 8240, 8224
                hide_name = True
                size = 12, 352
            ]

            port Port1 {
                label = "A+"
                position = left:1
                kind = pe
            }
            [
                position = 7704, 8080
            ]

            port Port2 {
                label = "B+"
                position = left:2
                kind = pe
            }
            [
                position = 7704, 8176
            ]

            port Port3 {
                label = "C+"
                position = left:3
                kind = pe
            }
            [
                position = 7704, 8272
            ]

            port Port4 {
                label = "A-"
                position = right:4
                kind = pe
            }
            [
                position = 8800, 8080
                scale = -1, 1
            ]

            port Port5 {
                label = "B-"
                position = right:5
                kind = pe
            }
            [
                position = 8800, 8176
                scale = -1, 1
            ]

            port Port6 {
                label = "C-"
                position = right:6
                kind = pe
            }
            [
                position = 8800, 8272
                scale = -1, 1
            ]

            port Port7 {
                label = "G1"
                position = bottom:7
                kind = pe
            }
            [
                position = 8184, 8512
                rotation = left
            ]

            port Port8 {
                label = "G2"
                position = bottom:8
                kind = pe
            }
            [
                position = 8288, 8512
                rotation = left
            ]

            junction Junction1 pe
            [
                position = 7856, 8080
            ]

            junction Junction2 pe
            [
                position = 7928, 8176
            ]

            junction Junction3 pe
            [
                position = 8000, 8272
            ]

            junction Junction4 pe
            [
                position = 8488, 8080
            ]

            junction Junction5 pe
            [
                position = 8552, 8176
            ]

            junction Junction6 pe
            [
                position = 8624, 8272
            ]

            junction Junction7 pe
            [
                position = 8184, 8384
            ]

            junction Junction8 pe
            [
                position = 8288, 8384
            ]

            connect Port1 Junction1 as Connection7
            connect Junction1 "Core Coupling 6.a_in" as Connection8
            connect C1.p_node Junction1 as Connection9
            connect Port2 Junction2 as Connection10
            connect Junction2 "Core Coupling 6.b_in" as Connection11
            connect C2.p_node Junction2 as Connection12
            connect Port3 Junction3 as Connection13
            connect Junction3 "Core Coupling 6.c_in" as Connection14
            connect C3.p_node Junction3 as Connection15
            connect Port4 Junction4 as Connection16
            connect Junction4 "Core Coupling 6.a_out" as Connection17
            connect C4.p_node Junction4 as Connection18
            connect Port5 Junction5 as Connection19
            connect Junction5 "Core Coupling 6.b_out" as Connection20
            connect C5.p_node Junction5 as Connection21
            connect Port6 Junction6 as Connection22
            connect Junction6 "Core Coupling 6.c_out" as Connection23
            connect C6.p_node Junction6 as Connection24
            connect C1.n_node C2.n_node as Connection31
            connect C3.n_node C2.n_node as Connection32
            connect Port7 Junction7 as Connection34
            connect Junction7 C2.n_node as Connection35
            connect "Core Coupling 6.d_in" Junction7 as Connection36
            connect C4.n_node C5.n_node as Connection37
            connect C6.n_node C5.n_node as Connection38
            connect Port8 Junction8 as Connection40
            connect Junction8 C5.n_node as Connection41
            connect "Core Coupling 6.d_out" Junction8 as Connection42

            Cap = "C"
            L = "L7"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Four Phase TML Core Coupling with Capacitors in Parallel.</p></body></html>"

                L {
                    label = "Set inductance value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[H]"
                }

                Cap {
                    label = "Set capacitors value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[F]"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE define_icon
                ENDCODE
            }
        }
        [
            position = 6992, 8616
            hide_name = True
            scale = 1, -1
            size = 48, 64
        ]

        component Subsystem "Couplin(4ph)-3" {
            layout = dynamic
            component pas_capacitor C4 {
                capacitance = "Cap"
            }
            [
                position = 8488, 8344
                rotation = right
            ]

            component pas_capacitor C5 {
                capacitance = "Cap"
            }
            [
                position = 8552, 8344
                rotation = right
            ]

            component pas_capacitor C6 {
                capacitance = "Cap"
            }
            [
                position = 8624, 8344
                rotation = right
            ]

            component pas_capacitor C1 {
                capacitance = "Cap"
            }
            [
                position = 7856, 8344
                rotation = right
            ]

            component pas_capacitor C2 {
                capacitance = "Cap"
            }
            [
                position = 7928, 8344
                rotation = right
            ]

            component pas_capacitor C3 {
                capacitance = "Cap"
            }
            [
                position = 8000, 8344
                rotation = right
            ]

            component "core/Four Phase TLM Core Coupling" "Core Coupling 6" {
                embedded_components = "True"
                inductance = "L"
            }
            [
                position = 8240, 8224
                hide_name = True
                size = 12, 352
            ]

            port Port1 {
                label = "A+"
                position = left:1
                kind = pe
            }
            [
                position = 7704, 8080
            ]

            port Port2 {
                label = "B+"
                position = left:2
                kind = pe
            }
            [
                position = 7704, 8176
            ]

            port Port3 {
                label = "C+"
                position = left:3
                kind = pe
            }
            [
                position = 7704, 8272
            ]

            port Port4 {
                label = "A-"
                position = right:4
                kind = pe
            }
            [
                position = 8800, 8080
                scale = -1, 1
            ]

            port Port5 {
                label = "B-"
                position = right:5
                kind = pe
            }
            [
                position = 8800, 8176
                scale = -1, 1
            ]

            port Port6 {
                label = "C-"
                position = right:6
                kind = pe
            }
            [
                position = 8800, 8272
                scale = -1, 1
            ]

            port Port7 {
                label = "G1"
                position = bottom:7
                kind = pe
            }
            [
                position = 8184, 8512
                rotation = left
            ]

            port Port8 {
                label = "G2"
                position = bottom:8
                kind = pe
            }
            [
                position = 8288, 8512
                rotation = left
            ]

            junction Junction1 pe
            [
                position = 7856, 8080
            ]

            junction Junction2 pe
            [
                position = 7928, 8176
            ]

            junction Junction3 pe
            [
                position = 8000, 8272
            ]

            junction Junction4 pe
            [
                position = 8488, 8080
            ]

            junction Junction5 pe
            [
                position = 8552, 8176
            ]

            junction Junction6 pe
            [
                position = 8624, 8272
            ]

            junction Junction7 pe
            [
                position = 8184, 8384
            ]

            junction Junction8 pe
            [
                position = 8288, 8384
            ]

            connect Port1 Junction1 as Connection7
            connect Junction1 "Core Coupling 6.a_in" as Connection8
            connect C1.p_node Junction1 as Connection9
            connect Port2 Junction2 as Connection10
            connect Junction2 "Core Coupling 6.b_in" as Connection11
            connect C2.p_node Junction2 as Connection12
            connect Port3 Junction3 as Connection13
            connect Junction3 "Core Coupling 6.c_in" as Connection14
            connect C3.p_node Junction3 as Connection15
            connect Port4 Junction4 as Connection16
            connect Junction4 "Core Coupling 6.a_out" as Connection17
            connect C4.p_node Junction4 as Connection18
            connect Port5 Junction5 as Connection19
            connect Junction5 "Core Coupling 6.b_out" as Connection20
            connect C5.p_node Junction5 as Connection21
            connect Port6 Junction6 as Connection22
            connect Junction6 "Core Coupling 6.c_out" as Connection23
            connect C6.p_node Junction6 as Connection24
            connect C1.n_node C2.n_node as Connection31
            connect C3.n_node C2.n_node as Connection32
            connect Port7 Junction7 as Connection34
            connect Junction7 C2.n_node as Connection35
            connect "Core Coupling 6.d_in" Junction7 as Connection36
            connect C4.n_node C5.n_node as Connection37
            connect C6.n_node C5.n_node as Connection38
            connect Port8 Junction8 as Connection40
            connect Junction8 C5.n_node as Connection41
            connect "Core Coupling 6.d_out" Junction8 as Connection42

            Cap = "C"
            L = "L6"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Four Phase TML Core Coupling with Capacitors in Parallel.</p></body></html>"

                L {
                    label = "Set inductance value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[H]"
                }

                Cap {
                    label = "Set capacitors value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[F]"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE define_icon
                ENDCODE
            }
        }
        [
            position = 5808, 7384
            hide_name = True
            size = 48, 64
        ]

        component Subsystem "Couplin(3ph)-2" {
            layout = dynamic
            component pas_capacitor C4 {
                capacitance = "Cap"
            }
            [
                position = 8488, 8344
                rotation = right
            ]

            component pas_capacitor C5 {
                capacitance = "Cap"
            }
            [
                position = 8552, 8344
                rotation = right
            ]

            component pas_capacitor C6 {
                capacitance = "Cap"
            }
            [
                position = 8624, 8344
                rotation = right
            ]

            component "core/Three Phase TLM Core Coupling" "Core Coupling 1" {
                inductance = "L"
            }
            [
                position = 8208, 8176
                size = 12, 256
            ]

            component pas_capacitor C1 {
                capacitance = "Cap"
            }
            [
                position = 7856, 8344
                rotation = right
            ]

            component pas_capacitor C2 {
                capacitance = "Cap"
            }
            [
                position = 7928, 8344
                rotation = right
            ]

            component pas_capacitor C3 {
                capacitance = "Cap"
            }
            [
                position = 8000, 8344
                rotation = right
            ]

            port Port1 {
                label = "A+"
                position = left:1
                kind = pe
            }
            [
                position = 7704, 8080
            ]

            port Port2 {
                label = "B+"
                position = left:2
                kind = pe
            }
            [
                position = 7704, 8176
            ]

            port Port3 {
                label = "C+"
                position = left:3
                kind = pe
            }
            [
                position = 7704, 8272
            ]

            port Port4 {
                label = "A-"
                position = right:4
                kind = pe
            }
            [
                position = 8800, 8080
                scale = -1, 1
            ]

            port Port5 {
                label = "B-"
                position = right:5
                kind = pe
            }
            [
                position = 8800, 8176
                scale = -1, 1
            ]

            port Port6 {
                label = "C-"
                position = right:6
                kind = pe
            }
            [
                position = 8800, 8272
                scale = -1, 1
            ]

            port Port7 {
                label = "GND1"
                position = bottom:7
                kind = pe
            }
            [
                position = 7928, 8464
                rotation = left
                hide_name = True
            ]

            port Port8 {
                label = "GND2"
                position = bottom:8
                kind = pe
            }
            [
                position = 8552, 8448
                rotation = left
                hide_name = True
            ]

            junction Junction1 pe
            [
                position = 7856, 8080
            ]

            junction Junction2 pe
            [
                position = 7928, 8176
            ]

            junction Junction3 pe
            [
                position = 8000, 8272
            ]

            junction Junction4 pe
            [
                position = 8624, 8272
            ]

            junction Junction5 pe
            [
                position = 8552, 8176
            ]

            junction Junction6 pe
            [
                position = 8488, 8080
            ]

            junction Junction7 pe
            [
                position = 8552, 8384
            ]

            junction Junction8 pe
            [
                position = 7928, 8384
            ]

            connect C1.p_node Junction1 as Connection35
            connect Junction1 Port1 as Connection36
            [
                breakpoints = 7856, 8080
            ]
            connect "Core Coupling 1.a_in" Junction1 as Connection37
            connect Port2 Junction2 as Connection38
            connect Junction2 C2.p_node as Connection39
            [
                breakpoints = 7928, 8176
            ]
            connect "Core Coupling 1.b_in" Junction2 as Connection40
            connect Port3 Junction3 as Connection41
            connect Junction3 C3.p_node as Connection42
            [
                breakpoints = 8000, 8272
            ]
            connect "Core Coupling 1.c_in" Junction3 as Connection43
            connect C6.p_node Junction4 as Connection44
            connect Junction4 Port6 as Connection45
            [
                breakpoints = 8624, 8272
            ]
            connect "Core Coupling 1.c_out" Junction4 as Connection46
            connect Port5 Junction5 as Connection47
            connect Junction5 C5.p_node as Connection48
            [
                breakpoints = 8552, 8176
            ]
            connect C1.n_node C2.n_node as Connection25
            connect "Core Coupling 1.b_out" Junction5 as Connection49
            connect C4.p_node Junction6 as Connection50
            connect C6.n_node C5.n_node as Connection28
            connect Junction6 Port4 as Connection51
            [
                breakpoints = 8488, 8080
            ]
            connect "Core Coupling 1.a_out" Junction6 as Connection52
            connect C4.n_node Junction7 as Connection53
            connect Junction7 C5.n_node as Connection54
            connect Port8 Junction7 as Connection55
            connect C3.n_node Junction8 as Connection56
            connect Junction8 C2.n_node as Connection57
            connect Port7 Junction8 as Connection58

            Cap = "C"
            L = "L3"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Three Phase TML Core Coupling with Capacitors in Parallel.</p></body></html>"

                L {
                    label = "Set inductance value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[H]"
                }

                Cap {
                    label = "Set capacitors value"
                    widget = edit
                    type = generic
                    default_value = "0"
                    unit = "[F]"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE
            }
        }
        [
            position = 10416, 9064
            rotation = left
            size = 48, 64
        ]

        component "core/Transmission Line" Line-2 {
            C_sequence_metric = "C_seq"
            L_sequence_metric = "L2_seq"
            Length_metric = "D2"
            R_sequence_metric = "R2_seq"
            model = "PI"
            model_def = "Sequence"
            unit_sys = "metric"
        }
        [
            position = 9688, 7384
            size = 256, 72
        ]

        component "core/Transmission Line" Line-3_section-1 {
            C_sequence_metric = "C_seq"
            L_sequence_metric = "L3_seq"
            Length_metric = "D3*0.05"
            R_sequence_metric = "R3_seq"
            model = "PI"
            model_def = "Sequence"
            unit_sys = "metric"
        }
        [
            position = 10416, 8032
            rotation = left
            size = 256, 72
        ]

        component "core/Transmission Line" Line-4 {
            C_sequence_metric = "C_seq"
            L_sequence_metric = "L4_seq"
            Length_metric = "D4"
            R_sequence_metric = "R4_seq"
            model = "PI"
            model_def = "Sequence"
            unit_sys = "metric"
        }
        [
            position = 9224, 10088
            size = 256, 72
        ]

        component "core/Transmission Line" Line-7 {
            C_sequence_metric = "C_seq"
            L_sequence_metric = "L7_seq"
            Length_metric = "D7"
            R_sequence_metric = "R7_seq"
            model = "PI"
            model_def = "Sequence"
            unit_sys = "metric"
        }
        [
            position = 6744, 8616
            size = 256, 72
        ]

        component "core/Transmission Line" Line-5 {
            C_sequence_metric = "C_seq"
            L_sequence_metric = "L5_seq"
            Length_metric = "D5"
            R_sequence_metric = "R5_seq"
            model = "PI"
            model_def = "Sequence"
            unit_sys = "metric"
        }
        [
            position = 6688, 10088
            size = 256, 72
        ]

        component "core/Transmission Line" Line-6 {
            C_sequence_metric = "C_seq"
            L_sequence_metric = "L6_seq"
            Length_metric = "D6"
            R_sequence_metric = "R6_seq"
            model = "PI"
            model_def = "Sequence"
            unit_sys = "metric"
        }
        [
            position = 5272, 8720
            rotation = left
            size = 256, 72
        ]

        component "core/Transmission Line" Line-1 {
            C_sequence_metric = "C_seq"
            L_sequence_metric = "L1_seq"
            Length_metric = "D1"
            R_sequence_metric = "R1_seq"
            model = "PI"
            model_def = "Sequence"
            unit_sys = "metric"
        }
        [
            position = 7168, 7384
            size = 256, 72
        ]

        component "core/Triple Pole Single Throw Contactor" S11 {
            ctrl_src = "Model"
            off_delay = "1/12"
            on_delay = "1/12"
        }
        [
            position = 10416, 9688
            rotation = left
            size = 64, 256
        ]

        component Subsystem "Measurements Block - 11" {
            layout = dynamic
            component "core/Current Measurement" I_A {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7288, 7952
                size = 64, 32
            ]

            component "core/Current Measurement" I_B {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7240, 8016
                size = 64, 32
            ]

            component "core/Current Measurement" I_C {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7192, 8112
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_BC {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8552, 7856
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_AB {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8312, 7856
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_CA {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8792, 7872
                size = 64, 32
            ]

            component gen_bus_join "Basic Measurements (Join)" {
                inputs = "9"
            }
            [
                position = 8152, 7528
            ]

            component "core/Current RMS" IrmsA {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7600, 7952
                size = 64, 32
            ]

            component "core/Current RMS" IrmsB {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7536, 8016
                size = 64, 32
            ]

            component "core/Current RMS" IrmsC {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7488, 8112
                size = 64, 32
            ]

            port B+ {
                position = left:2
                kind = pe
            }
            [
                position = 7048, 8016
            ]

            port A- {
                position = right:1
                kind = pe
            }
            [
                position = 9624, 7952
                rotation = down
            ]

            port C+ {
                position = left:3
                kind = pe
            }
            [
                position = 7048, 8112
            ]

            port B- {
                position = right:2
                kind = pe
            }
            [
                position = 9624, 8016
                rotation = down
            ]

            port A+ {
                position = left:1
                kind = pe
            }
            [
                position = 7048, 7952
            ]

            port C- {
                position = right:3
                kind = pe
            }
            [
                position = 9624, 8112
                rotation = down
            ]

            port BM {
                position = top:auto
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8232, 7528
            ]

            tag Goto4 {
                value = "Irms_A"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7888
                hide_name = True
            ]

            tag Goto5 {
                value = "Irms_B"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7856
                hide_name = True
            ]

            tag Goto6 {
                value = "Irms_C"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7824
                hide_name = True
            ]

            tag Goto10 {
                value = "V_BC"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8552, 7768
                rotation = left
                hide_name = True
            ]

            tag Goto11 {
                value = "V_AB"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8312, 7768
                rotation = left
                hide_name = True
            ]

            tag Goto12 {
                value = "V_CA"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8792, 7776
                rotation = left
                hide_name = True
                scale = -1, 1
            ]

            tag From7 {
                value = "I_A"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7464
                hide_name = True
            ]

            tag From8 {
                value = "I_B"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7480
                hide_name = True
            ]

            tag From9 {
                value = "I_C"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7496
                hide_name = True
            ]

            tag From10 {
                value = "V_BC"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7512
                hide_name = True
            ]

            tag From11 {
                value = "V_AB"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7544
                hide_name = True
            ]

            tag From12 {
                value = "V_CA"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7528
                hide_name = True
            ]

            tag From13 {
                value = "Irms_A"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7560
                hide_name = True
            ]

            tag From14 {
                value = "Irms_B"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7576
                hide_name = True
            ]

            tag From15 {
                value = "Irms_C"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7592
                hide_name = True
            ]

            tag Goto13 {
                value = "I_A"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7880
                hide_name = True
            ]

            tag Goto14 {
                value = "I_B"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7832
                hide_name = True
            ]

            tag Goto15 {
                value = "I_C"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7800
                hide_name = True
            ]

            junction Junction53 pe
            [
                position = 8344, 8016
            ]

            junction Junction54 pe
            [
                position = 8280, 7952
            ]

            junction Junction55 pe
            [
                position = 8520, 8016
            ]

            junction Junction56 pe
            [
                position = 8584, 8112
            ]

            junction Junction57 pe
            [
                position = 8760, 8112
            ]

            junction Junction58 pe
            [
                position = 8824, 7952
            ]

            connect I_C.p_node C+ as Connection3
            connect I_B.p_node B+ as Connection1
            connect I_A.p_node A+ as Connection5
            connect Goto10 V_BC.out as Connection155
            connect Goto11 V_AB.out as Connection162
            connect Goto12 V_CA.out as Connection178
            connect V_AB.n_node Junction53 as Connection334
            connect V_AB.p_node Junction54 as Connection337
            connect Junction55 Junction53 as Connection339
            connect V_BC.p_node Junction55 as Connection340
            connect V_BC.n_node Junction56 as Connection343
            connect Junction56 Junction57 as Connection344
            connect V_CA.p_node Junction57 as Connection346
            connect Junction54 Junction58 as Connection347
            [
                breakpoints = 8280, 7952; 8392, 7952; 8392, 7952; 8392, 7952; 8440, 7952; 8456, 7952; 8456, 7952; 8456, 7952; 8456, 7952
            ]
            connect V_CA.n_node Junction58 as Connection349
            connect "Basic Measurements (Join).out" BM as Connection368
            connect C- Junction57 as Connection396
            [
                breakpoints = 9416, 8112; 9352, 8112; 9232, 8112; 9168, 8112; 8760, 8112
            ]
            connect Junction55 B- as Connection395
            [
                breakpoints = 8520, 8016; 8520, 8016; 8976, 8016; 9040, 8016; 9040, 8016; 9168, 8016; 9232, 8016
            ]
            connect Junction58 A- as Connection394
            [
                breakpoints = 8824, 7952; 8824, 7952; 8976, 7952; 8976, 7952; 9040, 7952; 9352, 7952; 9416, 7952
            ]
            connect From7 "Basic Measurements (Join).in" as Connection400
            connect From8 "Basic Measurements (Join).in1" as Connection401
            connect From9 "Basic Measurements (Join).in2" as Connection402
            connect From10 "Basic Measurements (Join).in3" as Connection403
            connect From12 "Basic Measurements (Join).in4" as Connection404
            connect From11 "Basic Measurements (Join).in5" as Connection405
            connect Junction54 IrmsA.n_node as Connection406
            connect IrmsA.p_node I_A.n_node as Connection407
            connect I_B.n_node IrmsB.p_node as Connection408
            connect IrmsB.n_node Junction53 as Connection409
            connect I_C.n_node IrmsC.p_node as Connection410
            connect IrmsC.n_node Junction56 as Connection411
            connect From13 "Basic Measurements (Join).in6" as Connection415
            connect From14 "Basic Measurements (Join).in7" as Connection416
            [
                breakpoints = 8120, 7576
            ]
            connect From15 "Basic Measurements (Join).in8" as Connection417
            [
                breakpoints = 8120, 7592
            ]
            connect Goto13 I_A.out as Connection418
            connect Goto14 I_B.out as Connection419
            connect Goto15 I_C.out as Connection420
            connect Goto4 IrmsA.out as Connection421
            connect Goto5 IrmsB.out as Connection422
            connect Goto6 IrmsC.out as Connection423
        }
        [
            position = 10416, 9856
            rotation = left
            size = 104, 240
        ]

        component Subsystem Relay-11 {
            layout = dynamic
            component Subsystem "Function (67P)" {
                layout = dynamic
                component src_scada_input Reset {
                    execution_rate = "Ts_relay"
                    max = "1"
                    min = "0"
                    unit = ""
                }
                [
                    position = 7272, 8456
                ]

                component src_scada_input DT {
                    def_value = "0.025"
                    execution_rate = "Ts_relay"
                    max = "1.3"
                    min = "0.024"
                    unit = ""
                }
                [
                    position = 7272, 8608
                ]

                component src_constant Constant1 {
                    execution_rate = "Ts_relay"
                    value = "fun_selected"
                }
                [
                    position = 7272, 8880
                    hide_name = True
                ]

                component src_constant CTp {
                    execution_rate = "Ts_relay"
                    value = "CTp"
                }
                [
                    position = 7272, 8800
                ]

                component gen_probe RS {
                }
                [
                    position = 7456, 8424
                ]

                component gen_probe I_PKU {
                }
                [
                    position = 7456, 8488
                ]

                component src_scada_input I_Pick_Up {
                    def_value = "I_Pick_Up"
                    execution_rate = "Ts_relay"
                    unit = ""
                }
                [
                    position = 7272, 8536
                ]

                component src_constant Constant4 {
                    execution_rate = "Ts_relay"
                    value = "Ts_relay"
                }
                [
                    position = 7272, 8952
                    hide_name = True
                ]

                component gen_probe TMS_Stt {
                }
                [
                    position = 7456, 8656
                ]

                component src_scada_input TMS {
                    def_value = "TMS"
                    execution_rate = "Ts_relay"
                    unit = ""
                }
                [
                    position = 7272, 8704
                ]

                component gen_probe DT_Stt {
                }
                [
                    position = 7456, 8576
                ]

                component gen_product Product1 {
                }
                [
                    position = 8496, 8088
                    hide_name = True
                ]

                component gen_product Product2 {
                }
                [
                    position = 8496, 8136
                    hide_name = True
                ]

                component gen_product Product3 {
                }
                [
                    position = 8496, 8184
                    hide_name = True
                ]

                component gen_c_function "OverCurrent Inverse Function" {
                    global_variables = "real Irms[3];uint i;real M[3];real Ipk_2;real t[3];uint j;real Flag;real B;real A;real L;real multiplier;real counter;real out;real trans;real time;"
                    init_fnc = "/*Begin code section*/
B = 0.14; A = 0.02; L = 0; // Time Inverse Function parameters inicialization
Flag = 0;
TMS = 1;
CTp = 1;
Ipk_2= 1;
multiplier = 1;
out=0;
counter= 0; // 1/60 -> 1 cycle 
time = 1e9;
trans = 0;
/*End code section*/"
                    input_terminals = "inherit Inverse_Function;inherit I_Pick_Up;inherit TMS;inherit CTp;inherit I_Arms;inherit I_Brms;inherit I_Crms;inherit Reset;inherit DT;inherit Ts;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "[(\'Inverse_Function\', True), (\'I_Pick_Up\', True), (\'TMS\', True), (\'CTp\', True), (\'I_Arms\', True), (\'I_Brms\', True), (\'I_Crms\', True), (\'Reset\', True), (\'DT\', True), (\'Ts\', True)]"
                    output_fnc = "/*Begin code section*/
Irms[0] = I_Arms;Irms[1] = I_Brms;Irms[2] = I_Crms;

switch ( (int)Inverse_Function) // Switch Inverse function selected by user
{
    case 0: // Standard Inverse IEC
    {
        B = 0.14; A = 0.02; L = 0; multiplier = TMS;
        break;
    }
    case 1: // Very Inverse IEC
    {
        B = 13.5; A = 1; L = 0; multiplier = TMS;
        break;
    }
    case 2: // Extremely Inverse IEC
    {
        B = 80; A = 2; L = 0; multiplier = TMS;
        break;
    }
    case 3: // Long Time Inverse UK
    {
        B = 120; A = 1; L = 0; multiplier = TMS;
        break;
    }

    case 4: // Rectifier UK
    {
        B = 45900; A = 5.6; L = 0; multiplier = TMS;
        break;
    }
    case 5: // Moderately Invese IEEE
    {
        B = 0.0515; A = 0.02; L = 0.114; multiplier = DT;
        break;
    }
    case 6: // Very Inverse IEEE
    {
        B = 19.61; A = 2; L = 0.491; multiplier = DT;
        break;
    }
    case 7: // Extremely Inverse IEEE
    {
        B = 28.2; A = 2; L = 0.1217; multiplier = DT;
        break;
    }
    case 8: //  Inverse US
    {
        B = 5.95; A = 2; L = 0.18; multiplier = DT;
        break;
    }
    case 9: //  Inverse US
    {
        B = 0.16758; A = 0.02; L = 0.11858; multiplier = DT;
        break;
    }
    default: //  Inverse US
    {
        B = 0.14; A = 0.02; L = 0; multiplier = TMS;
        break;
    }
    
}



if ((int)Reset == 1 ) // Reset statement
{
    trans = 0;
    counter = 0;
    Flag = 0;
}
else if (trans == 0 )
{
    Ipk_2 = I_Pick_Up*CTp/5.0; // Pick-Up current in the primary side
    
    for(i=0; i<3; i++){
        M[i] = Irms[i]/Ipk_2; // Normalize RMS current based on the pickup.
        if(M[i]<=1.0){
            t[i] = 1e6;
        }
        else{
            t[i] = multiplier*((B/(pow(M[i],A)-1))+L); // Time folows IEC function
        }
    }
    
    if((t[0]<=t[1])&&(t[0]<=t[2])){
        time = t[0];
    }
    else if(t[1]<=t[2]){
        time = t[1];
    }
    else{
        time = t[2];
    }
    for(i=0; i<3; i++){
        if(Irms[i]>Ipk_2){
            Flag = 1;
            break;
        }
        else{
            Flag = 0;
        }
    }
}
    if(counter > time){
        out = 1;
        trans = 1;
    }
    else{
        out = 0;
        trans = 0;
    }
    
    counter *= Flag;

    counter += Flag  * Ts;
// OUTPUT
OUT = out;
    time_out = time;
/*End code section*/"
                    output_terminals = "real OUT;inherit time_out;"
                    output_terminals_dimensions = "inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "[(\'OUT\', True), (\'time_out\', True)]"
                }
                [
                    position = 8128, 8960
                    size = 224, 208
                ]

                component sys_signal_switch "Signal switch2" {
                    criterion = "ctrl != threshold"
                }
                [
                    position = 8480, 8976
                ]

                component src_constant Constant6 {
                    execution_rate = "Ts_relay"
                    value = "0"
                }
                [
                    position = 8352, 9024
                    hide_name = True
                ]

                component sys_signal_switch "Signal switch1" {
                    criterion = "ctrl != threshold"
                }
                [
                    position = 8464, 8544
                ]

                component src_constant Constant2 {
                    execution_rate = "Ts_relay"
                    signal_type = "uint"
                    value = "dir_selected"
                }
                [
                    position = 8464, 8464
                    rotation = right
                    hide_name = True
                ]

                component src_constant Constant3 {
                    execution_rate = "Ts_relay"
                }
                [
                    position = 8336, 8592
                    hide_name = True
                ]

                component gen_c_function "C function (Directional Protection)" {
                    global_variables = "real threshold_Low[3];real threshold_high[3];real vec[6];uint i;uint j;real Flag;real val[3];"
                    init_fnc = "/*Begin code section*/
// Input

// Output
Directional_Trip = 0;
// Transition variables inicialization
Flag = 0;
/*End code section*/"
                    input_terminals = "inherit I_a;inherit I_b;inherit I_c;inherit V_ab;inherit V_ca;inherit V_bc;inherit Reset;inherit RCA;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "[(\'I_a\', True), (\'I_b\', True), (\'I_c\', True), (\'V_ab\', True), (\'V_ca\', True), (\'V_bc\', True), (\'Reset\', True), (\'RCA\', True)]"
                    output_fnc = "/*Begin code section*/
// Voltage and Current vector
vec[0] = V_bc; vec[1] = V_ca; vec[2] = V_ab; 
vec[3] = I_a; vec[4] = I_b;vec[5] = I_c;

if ((int)Reset == 1 ) // Reset Statement
{
    Flag = 0; // Trip not allowed

}
else // All angles are placed from 1st to 4th quadrant 
{
    for (i=0;i<3;i++)
    {
        if(vec[i] < 0){vec[i]+=360;}
        if(vec[i+3] < 0){vec[i+3]+=360;}
        val[i] = vec[i]-vec[i+3]+RCA;
        if (val[i] > 360){val[i] -= 360;}
        if (val[i] < 0){val[i] += 360;}
        if ((val[i] >=270 && val[i] < 360) || (val[i] >=0 && val[i] <=90)){Flag = 1;break;}
        else {Flag = 0;}
    }
    
    }

    // OUTPUT
    Directional_Trip = Flag;
/*End code section*/"
                    output_terminals = "real Directional_Trip;"
                    output_terminals_dimensions = "inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "[(\'Directional_Trip\', True)]"
                }
                [
                    position = 8128, 8528
                    size = 224, 208
                ]

                component gen_probe "Directional Trip" {
                }
                [
                    position = 8352, 8376
                ]

                component msr_phase "Phase Difference1" {
                }
                [
                    position = 7856, 8056
                    hide_name = True
                ]

                component msr_phase "Phase Difference2" {
                }
                [
                    position = 7856, 7992
                    hide_name = True
                ]

                component msr_phase "Phase Difference3" {
                }
                [
                    position = 7856, 7928
                    hide_name = True
                ]

                component msr_phase "Phase Difference4" {
                }
                [
                    position = 7856, 7856
                    hide_name = True
                ]

                component src_sine "Sinusoidal Source3" {
                    execution_rate = "Ts_relay"
                    frequency = "60"
                }
                [
                    position = 7608, 7848
                    hide_name = True
                ]

                component msr_phase "Phase Difference5" {
                }
                [
                    position = 7856, 8128
                    hide_name = True
                ]

                component msr_phase "Phase Difference6" {
                }
                [
                    position = 7856, 8192
                    hide_name = True
                ]

                component gen_probe "I_A_(Angle)" {
                }
                [
                    position = 7968, 7856
                ]

                component gen_probe "I_B_(Angle)" {
                }
                [
                    position = 7968, 7928
                ]

                component gen_probe "I_C_(Angle)" {
                }
                [
                    position = 7968, 7992
                ]

                component gen_probe "V_BC_(Angle)" {
                }
                [
                    position = 7968, 8056
                ]

                component gen_probe "V_AB_(Angle)" {
                }
                [
                    position = 7968, 8192
                ]

                component gen_probe "V_CA_(Angle)" {
                }
                [
                    position = 7968, 8128
                ]

                component gen_bus_split "Basic Measurements (Split)" {
                    outputs = "9"
                }
                [
                    position = 7152, 8024
                ]

                component gen_probe "I_A(RMS)" {
                }
                [
                    position = 8520, 7848
                ]

                component gen_probe "I_B(RMS)" {
                }
                [
                    position = 8520, 7960
                ]

                component gen_probe "I_C(RMS)" {
                }
                [
                    position = 8520, 7904
                ]

                component gen_probe CTp_Stt {
                }
                [
                    position = 7456, 8760
                ]

                component gen_probe time {
                }
                [
                    position = 8304, 9104
                ]

                component src_constant Constant7 {
                    execution_rate = "Ts_relay"
                    value = "RCA"
                }
                [
                    position = 7272, 9016
                    hide_name = True
                ]

                component gen_probe RCA {
                }
                [
                    position = 7456, 8984
                ]

                component src_scada_input Enable {
                    def_value = "Enable"
                    execution_rate = "Ts_relay"
                    format = "uint"
                    max = "1"
                    min = "0"
                    signal_type = "uint"
                    unit = ""
                }
                [
                    position = 8480, 8896
                    rotation = right
                ]

                port "DOCR Trip" {
                    position = right:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8624, 8976
                ]

                port BM {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6984, 8024
                ]

                tag Goto39 {
                    value = "CTp"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8800
                    hide_name = True
                ]

                tag Goto40 {
                    value = "DT"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8608
                    hide_name = True
                ]

                tag Goto41 {
                    value = "I_Pick-Up"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8536
                    hide_name = True
                ]

                tag Goto42 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8456
                    hide_name = True
                ]

                tag Goto48 {
                    value = "Inverse_Function"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8880
                    hide_name = True
                ]

                tag Goto49 {
                    value = "TMS"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8704
                    hide_name = True
                ]

                tag Goto50 {
                    value = "Ts_relay"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8952
                    hide_name = True
                ]

                tag From20 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8080
                    hide_name = True
                    size = 99, 20
                ]

                tag From21 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8128
                    hide_name = True
                    size = 99, 20
                ]

                tag From22 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8176
                    hide_name = True
                    size = 99, 20
                ]

                tag From25 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8096
                    hide_name = True
                ]

                tag From26 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8144
                    hide_name = True
                ]

                tag From27 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8192
                    hide_name = True
                ]

                tag From28 {
                    value = "CTp"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8928
                    hide_name = True
                ]

                tag From29 {
                    value = "TMS"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8912
                    hide_name = True
                ]

                tag From30 {
                    value = "I_Pick-Up"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8896
                    hide_name = True
                ]

                tag From31 {
                    value = "Inverse_Function"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8880
                    hide_name = True
                ]

                tag From32 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8992
                    hide_name = True
                ]

                tag From34 {
                    value = "DT"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 9008
                    hide_name = True
                ]

                tag Goto38 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8648, 8544
                    hide_name = True
                    size = 104, 20
                ]

                tag From35 {
                    value = "Ts_relay"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7808, 9024
                    hide_name = True
                    size = 99, 20
                ]

                tag From5 {
                    value = "I_A_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8448
                    hide_name = True
                ]

                tag From6 {
                    value = "I_B_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8472
                    hide_name = True
                ]

                tag From7 {
                    value = "I_C_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8496
                    hide_name = True
                ]

                tag From8 {
                    value = "V_AB_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8520
                    hide_name = True
                ]

                tag From9 {
                    value = "V_CA_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8544
                    hide_name = True
                ]

                tag From10 {
                    value = "V_BC_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8568
                    hide_name = True
                ]

                tag From23 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8592
                    hide_name = True
                ]

                tag Goto7 {
                    value = "V_BC_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8032
                    hide_name = True
                ]

                tag Goto8 {
                    value = "V_AB_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8168
                    hide_name = True
                ]

                tag Goto9 {
                    value = "V_CA_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8104
                    hide_name = True
                ]

                tag Goto10 {
                    value = "I_A_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7824
                    hide_name = True
                ]

                tag Goto11 {
                    value = "I_B_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7896
                    hide_name = True
                ]

                tag Goto12 {
                    value = "I_C_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7968
                    hide_name = True
                ]

                tag Goto13 {
                    value = "I_A"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 7960
                    hide_name = True
                ]

                tag Goto14 {
                    value = "I_B"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 7976
                    hide_name = True
                ]

                tag Goto15 {
                    value = "I_C"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 7992
                    hide_name = True
                ]

                tag Goto16 {
                    value = "V_BC"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 8008
                    hide_name = True
                ]

                tag Goto17 {
                    value = "V_CA"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 8024
                    hide_name = True
                ]

                tag Goto18 {
                    value = "V_AB"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 8040
                    hide_name = True
                ]

                tag From13 {
                    value = "I_A"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 7864
                    hide_name = True
                ]

                tag From14 {
                    value = "I_B"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 7936
                    hide_name = True
                ]

                tag From15 {
                    value = "I_C"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8000
                    hide_name = True
                ]

                tag From16 {
                    value = "V_BC"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8064
                    hide_name = True
                ]

                tag From36 {
                    value = "V_CA"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8136
                    hide_name = True
                ]

                tag From37 {
                    value = "V_AB"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8200
                    hide_name = True
                ]

                tag Goto45 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 8056
                    hide_name = True
                ]

                tag Goto46 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 8072
                    hide_name = True
                ]

                tag Goto47 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 8088
                    hide_name = True
                ]

                tag Goto51 {
                    value = "IA(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8088
                    hide_name = True
                    size = 104, 20
                ]

                tag Goto52 {
                    value = "IB(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8136
                    hide_name = True
                    size = 104, 20
                ]

                tag Goto53 {
                    value = "IC(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8184
                    hide_name = True
                    size = 104, 20
                ]

                tag From38 {
                    value = "IA(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8944
                    hide_name = True
                ]

                tag From39 {
                    value = "IB(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8960
                    hide_name = True
                ]

                tag From40 {
                    value = "IC(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8976
                    hide_name = True
                ]

                tag From41 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7848
                    hide_name = True
                ]

                tag From42 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7904
                    hide_name = True
                ]

                tag From43 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7960
                    hide_name = True
                ]

                tag Goto54 {
                    value = "RCA"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 9016
                    hide_name = True
                ]

                tag From44 {
                    value = "RCA"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8608
                    hide_name = True
                ]

                junction Junction81 sp
                [
                    position = 7328, 8456
                ]

                junction Junction84 sp
                [
                    position = 7352, 8536
                ]

                junction Junction86 sp
                [
                    position = 7328, 8608
                ]

                junction Junction88 sp
                [
                    position = 7336, 8704
                ]

                junction Junction89 sp
                [
                    position = 8296, 8528
                ]

                junction Junction1 sp
                [
                    position = 7936, 7856
                ]

                junction Junction2 sp
                [
                    position = 7936, 7928
                ]

                junction Junction3 sp
                [
                    position = 7936, 7992
                ]

                junction Junction4 sp
                [
                    position = 7936, 8056
                ]

                junction Junction5 sp
                [
                    position = 7936, 8128
                ]

                junction Junction6 sp
                [
                    position = 7936, 8192
                ]

                junction Junction7 sp
                [
                    position = 7648, 7848
                ]

                junction Junction8 sp
                [
                    position = 7648, 7920
                ]

                junction Junction9 sp
                [
                    position = 7648, 7984
                ]

                junction Junction10 sp
                [
                    position = 7648, 8048
                ]

                junction Junction11 sp
                [
                    position = 7648, 8120
                ]

                junction Junction90 sp
                [
                    position = 7344, 8800
                ]

                junction Junction91 sp
                [
                    position = 7328, 9016
                ]

                comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Basic Measurements</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 7088, 7896
                ]

                comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Phase Measurements</p></body></html> ENDCOMMENT 
                [
                    position = 7784, 7744
                ]

                comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">RMS Currents Measurements</p></body></html> ENDCOMMENT 
                [
                    position = 8344, 7800
                ]

                comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SCADA INPUTS</p></body></html> ENDCOMMENT 
                [
                    position = 7296, 8352
                ]

                comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directionality &amp;&amp; Current (RMS)</p></body></html> ENDCOMMENT 
                [
                    position = 8328, 7992
                ]

                comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directional Protecction </p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 8040, 8368
                ]

                comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">OverCurrent Protection</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 8032, 8800
                ]

                connect Constant1.out Goto48 as Connection902
                [
                    breakpoints = 7328, 8880
                ]
                connect Reset.out Junction81 as Connection843
                connect Junction81 Goto42 as Connection844
                connect RS.in Junction81 as Connection845
                connect I_PKU.in Junction84 as Connection937
                connect Junction84 Goto41 as Connection938
                [
                    breakpoints = 7352, 8528
                ]
                connect I_Pick_Up.out Junction84 as Connection939
                connect Goto50 Constant4.out as Connection943
                connect DT.out Junction86 as Connection956
                connect Junction86 Goto40 as Connection957
                [
                    breakpoints = 7328, 8608
                ]
                connect DT_Stt.in Junction86 as Connection958
                connect Goto49 Junction88 as Connection964
                connect Junction88 TMS.out as Connection965
                connect TMS_Stt.in Junction88 as Connection966
                connect From20 Product1.in as Connection355
                connect From21 Product2.in as Connection357
                connect From22 Product3.in as Connection359
                connect From25 Product1.in1 as Connection708
                connect From26 Product2.in1 as Connection709
                connect From27 Product3.in1 as Connection710
                connect From28 "OverCurrent Inverse Function.CTp" as Connection714
                connect From29 "OverCurrent Inverse Function.TMS" as Connection715
                connect From30 "OverCurrent Inverse Function.I_Pick_Up" as Connection917
                connect From35 "OverCurrent Inverse Function.Ts" as Connection944
                connect Constant6.out "Signal switch2.in1" as Connection972
                connect "DOCR Trip" "Signal switch2.out" as Connection973
                connect Constant2.out "Signal switch1.in2" as Connection880
                connect Constant3.out "Signal switch1.in1" as Connection886
                connect From5 "C function (Directional Protection).I_a" as Connection336
                connect From6 "C function (Directional Protection).I_b" as Connection337
                connect From7 "C function (Directional Protection).I_c" as Connection338
                connect From8 "C function (Directional Protection).V_ab" as Connection339
                connect From9 "C function (Directional Protection).V_ca" as Connection340
                connect From10 "C function (Directional Protection).V_bc" as Connection341
                connect From23 "C function (Directional Protection).Reset" as Connection554
                connect Goto38 "Signal switch1.out" as Connection977
                connect "C function (Directional Protection).Directional_Trip" Junction89 as Connection979
                connect Junction89 "Signal switch1.in" as Connection980
                connect "Directional Trip.in" Junction89 as Connection981
                [
                    breakpoints = 8296, 8376; 8296, 8528
                ]
                connect "Basic Measurements (Split).in" BM as Connection243
                connect "I_A_(Angle).in" Junction1 as Connection317
                connect Junction1 "Phase Difference4.phase_diff" as Connection318
                connect Goto10 Junction1 as Connection319
                connect "Phase Difference3.phase_diff" Junction2 as Connection320
                connect Junction2 "I_B_(Angle).in" as Connection321
                connect Goto11 Junction2 as Connection322
                connect "Phase Difference2.phase_diff" Junction3 as Connection323
                connect Junction3 "I_C_(Angle).in" as Connection324
                connect Goto12 Junction3 as Connection325
                connect "V_BC_(Angle).in" Junction4 as Connection327
                connect Junction4 "Phase Difference1.phase_diff" as Connection328
                connect Goto7 Junction4 as Connection329
                connect "V_CA_(Angle).in" Junction5 as Connection982
                connect Junction5 "Phase Difference5.phase_diff" as Connection332
                connect Goto9 Junction5 as Connection983
                connect "V_AB_(Angle).in" Junction6 as Connection984
                connect Junction6 "Phase Difference6.phase_diff" as Connection985
                connect Goto8 Junction6 as Connection986
                connect "Sinusoidal Source3.out" Junction7 as Connection987
                connect Junction7 "Phase Difference4.signal2" as Connection988
                connect "Phase Difference3.signal2" Junction8 as Connection342
                connect Junction8 Junction7 as Connection343
                connect "Phase Difference2.signal2" Junction9 as Connection345
                connect Junction9 Junction8 as Connection346
                connect "Phase Difference1.signal2" Junction10 as Connection348
                connect Junction10 Junction9 as Connection349
                connect "Phase Difference5.signal2" Junction11 as Connection351
                connect Junction11 Junction10 as Connection352
                connect "Phase Difference6.signal2" Junction11 as Connection353
                connect Goto13 "Basic Measurements (Split).out" as Connection354
                connect Goto14 "Basic Measurements (Split).out1" as Connection989
                connect Goto15 "Basic Measurements (Split).out2" as Connection356
                connect Goto16 "Basic Measurements (Split).out3" as Connection990
                connect Goto17 "Basic Measurements (Split).out4" as Connection358
                connect Goto18 "Basic Measurements (Split).out5" as Connection991
                connect From13 "Phase Difference4.signal1" as Connection360
                connect From14 "Phase Difference3.signal1" as Connection361
                connect From15 "Phase Difference2.signal1" as Connection362
                connect From16 "Phase Difference1.signal1" as Connection363
                connect From36 "Phase Difference5.signal1" as Connection364
                connect From37 "Phase Difference6.signal1" as Connection365
                connect Goto51 Product1.out as Connection994
                connect Goto52 Product2.out as Connection995
                connect Goto53 Product3.out as Connection996
                connect From38 "OverCurrent Inverse Function.I_Arms" as Connection997
                connect From39 "OverCurrent Inverse Function.I_Brms" as Connection998
                connect From40 "OverCurrent Inverse Function.I_Crms" as Connection999
                connect From32 "OverCurrent Inverse Function.Reset" as Connection1000
                connect From34 "OverCurrent Inverse Function.DT" as Connection1001
                connect "Signal switch2.in" "OverCurrent Inverse Function.OUT" as Connection1009
                connect Goto45 "Basic Measurements (Split).out6" as Connection1010
                connect Goto46 "Basic Measurements (Split).out7" as Connection1011
                connect Goto47 "Basic Measurements (Split).out8" as Connection1012
                connect From41 "I_A(RMS).in" as Connection1013
                connect From42 "I_C(RMS).in" as Connection1014
                connect From43 "I_B(RMS).in" as Connection1015
                connect "OverCurrent Inverse Function.Inverse_Function" From31 as Connection1026
                [
                    breakpoints = 7960, 8880
                ]
                connect CTp.out Junction90 as Connection1028
                [
                    breakpoints = 7328, 8800
                ]
                connect Junction90 Goto39 as Connection1029
                connect CTp_Stt.in Junction90 as Connection1030
                connect time.in "OverCurrent Inverse Function.time_out" as Connection1031
                connect From44 "C function (Directional Protection).RCA" as Connection1033
                connect Goto54 Junction91 as Connection1034
                connect Junction91 Constant7.out as Connection1035
                connect RCA.in Junction91 as Connection1036
                connect Enable.out "Signal switch2.in2" as Connection1037

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Directional OverCurrent Block</p></body></html>"

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 7840, 8312
                size = 264, 216
            ]

            component gen_probe Trip {
            }
            [
                position = 8240, 8240
            ]

            component gen_comparator Comparator1 {
            }
            [
                position = 8160, 8320
                hide_name = True
            ]

            component src_constant Constant1 {
                execution_rate = "Ts"
                value = "0.5"
            }
            [
                position = 8056, 8400
                hide_name = True
            ]

            component gen_logic_op "Logical operator1" {
                operator = "NOT"
            }
            [
                position = 8304, 8320
            ]

            component "core/Rate Transition" "Rate Transition2" {
                execution_rate = "Ts"
            }
            [
                position = 8064, 8312
                hide_name = True
                size = 32, 32
            ]

            component "core/Rate Transition" "Rate Transition1" {
                execution_rate = "Ts_relay"
            }
            [
                position = 7616, 8312
                hide_name = True
                size = 32, 32
            ]

            port BM {
                position = left:auto
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 7536, 8312
            ]

            port "Trip DOCR" {
                position = right:auto
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8464, 8320
            ]

            comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Relay Output</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
            [
                position = 8408, 8240
            ]

            comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ANSI 67 (DOCR)</p></body></html> ENDCOMMENT 
            [
                position = 7784, 8168
            ]

            connect Constant1.out Comparator1.in2 as Connection69
            connect Comparator1.out Trip.in as Connection74
            [
                breakpoints = 8192, 8320
            ]
            connect "Trip DOCR" "Logical operator1.out" as Connection81
            connect "Logical operator1.in" Comparator1.out as Connection82
            connect Comparator1.in1 "Rate Transition2.out" as Connection85
            connect "Rate Transition2.in" "Function (67P).DOCR Trip" as Connection86
            connect BM "Rate Transition1.in" as Connection87
            connect "Rate Transition1.out" "Function (67P).BM" as Connection88

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Relay - 11 (Directional OverCurrent Relay)</p></body></html>"

                enable {
                    label = "Enable/Disable Relay"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "Enable"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "Enable"),int(0))
                    ENDCODE
                }

                Enable {
                    widget = edit
                    type = generic
                    default_value = "1"
                    nonvisible
                }

                function {
                    label = "I > 1 Function"
                    widget = combo
                    combo_values = "IEC Standard Inverse", "IEC Very Inverse", "IEC Extremely Inverse", "UK Long Time Inverse", "UK Rectifier", "IEEE Moderately Inverse", "IEEE Very Inverse", "IEEE Extremely Inverse", "US Inverse", "US Short Time Inverse"
                    type = string
                    default_value = "IEC Standard Inverse"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        dinamic(container_handle,"Dinamic",new_value)
                    ENDCODE

                    CODE property_value_edited
                        dinamic(container_handle,"Dinamic",new_value)
                    ENDCODE
                }

                fun_selected {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                direction {
                    label = "Direction / Non-Direction"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(0))
                    ENDCODE

                    CODE property_value_edited
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(0))
                    ENDCODE
                }

                dir_selected {
                    widget = edit
                    type = generic
                    default_value = "1"
                    nonvisible
                }

                I_Pick_Up {
                    label = "I > 1 Current Set"
                    widget = edit
                    type = generic
                    default_value = "15"
                    unit = "[A]"
                    group = "O/C Group"
                }

                TMS {
                    label = "I > 1 TMS "
                    widget = edit
                    type = generic
                    default_value = "0.313"
                    group = "O/C Group"
                }

                DT {
                    label = "I > 1 DT Adder"
                    widget = edit
                    type = generic
                    default_value = "0.3"
                    unit = "[A]"
                    group = "O/C Group"
                    nonvisible
                    disabled
                }

                CTp {
                    label = "Primary CT"
                    widget = edit
                    type = generic
                    default_value = "200"
                    group = "O/C Group"
                }

                RCA {
                    label = "I > Char angle"
                    widget = edit
                    type = generic
                    default_value = "45"
                    unit = "[deg]"
                    group = "O/C Group"
                }

                Ts_relay {
                    label = "Time Step"
                    widget = edit
                    type = generic
                    default_value = "Ts_new"
                    unit = "[s]"
                    group = "O/C Group"
                }

                properties {
                    label = "Press to visualize selected settings"
                    widget = button
                    type = string
                    default_value = "Show"
                    group = "O/C Group"
                    no_evaluate

                    CODE button_clicked
                        direction = mdl.get_property_disp_value(mdl.prop(container_handle, "direction"))
                        I_Pick_Up = mdl.get_property_disp_value(mdl.prop(container_handle, "I_Pick_Up"))
                        TMS = mdl.get_property_disp_value(mdl.prop(container_handle, "TMS"))
                        DT = mdl.get_property_disp_value(mdl.prop(container_handle, "DT"))
                        CTp = mdl.get_property_disp_value(mdl.prop(container_handle, "CTp"))
                        Ts_relay = mdl.get_property_disp_value(mdl.prop(container_handle, "Ts_relay"))
                        function = mdl.get_property_disp_value(mdl.prop(container_handle, "function"))
                        
                        
                        mdl.info('\n \n \n \n ')
                        mdl.info("###############     Relay - 11   ################# \n \n")
                        mdl.info("Selected function --> {}".format(function))
                        mdl.info("Directional relay --> {} ".format(direction))
                        mdl.info("Pick Up current set to --> {} [A]".format(I_Pick_Up))
                        mdl.info("Time multiple setting (TMS) set to --> {}".format(TMS))
                        mdl.info("Time dial setting (DT) set to --> {}".format(DT))
                        mdl.info("Primary CT set to --> {}".format(CTp))
                        mdl.info("Relay Time step (Ts) set to --> {}".format(Ts_relay))
                    ENDCODE
                }

                preview {
                    widget = button
                    type = string
                    default_value = "Preview OC Function"
                    group = "O/C Group"
                    no_evaluate

                    CODE button_clicked
                        graphic(container_handle,"Grafic")
                    ENDCODE
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE define_icon
                    image('p145.jpg')
                ENDCODE

                CODE init
                    from handlers.look_up_table import preview_lut
                    import matplotlib.pyplot as plt
                    
                    def dinamic(item_handle,prop,new_value):
                        if prop == "Dinamic":
                            I_Pick_Up = mdl.prop(item_handle, "I_Pick_Up")
                            TMS = mdl.prop(item_handle, "TMS")
                            DT = mdl.prop(item_handle, "DT")
                            Ts_relay = mdl.prop(item_handle, "Ts_relay")
                            fun_selected = mdl.prop(item_handle, "fun_selected")
                            
                            if new_value == "IEC Standard Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,0)
                                
                            elif new_value == "IEC Very Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,1)
                                
                            elif new_value == "IEC Extremely Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,2)
                                
                            elif new_value == "UK Long Time Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,3)
                                
                            elif new_value == "UK Rectifier":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,4)
                                
                            elif new_value == "IEEE Moderately Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,5)
                                
                            elif new_value == "IEEE Very Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,6)
                                
                            elif new_value == "IEEE Extremely Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,7)
                                
                            elif new_value == "US Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,8)
                                
                            elif new_value == "US Short Time Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,9)
                        
                    
                    
                    
                    def values(fun_selected):
                        if fun_selected == 0:
                            B = 0.14; A = 0.02; L = 0
                        elif fun_selected == 1:
                            B = 13.5; A = 1; L = 0
                        elif fun_selected == 2:
                            B = 80; A = 2; L = 0
                        elif fun_selected == 3:
                            B = 120; A = 1; L = 0
                        elif fun_selected == 4:
                            B = 45900; A = 5.6; L = 0
                        elif fun_selected == 5:
                            B = 0.0515; A = 0.02; L = 0.114
                        elif fun_selected == 6:
                            B = 19.61; A = 2; L = 0.491
                        elif fun_selected == 7:
                            B = 28.2; A = 2; L = 0.1217
                        elif fun_selected == 8:
                            B = 5.95; A = 2; L = 0.18
                        elif fun_selected == 9:
                            B = 0.16758; A = 0.02; L = 0.11858
                        return A,B,L;
                    
                    def graphic(item_handle,prop):
                            fun_selected = mdl.get_property_value(mdl.prop(item_handle, "fun_selected"))
                            TMS = float(mdl.get_property_disp_value(mdl.prop(item_handle, "TMS")))
                            DT = float(mdl.get_property_disp_value(mdl.prop(item_handle, "DT")))
                            A,B,L = values(fun_selected)
                            
                            multiplier =1
                            if ( mdl.is_property_enabled(mdl.prop(item_handle, "TMS")) == True):
                                if TMS > 0:
                                    multiplier = TMS
                            elif (mdl.is_property_enabled(mdl.prop(item_handle, "DT")) == True):
                                if DT > 0:
                                    multiplier = DT
                            
                            x = [];y = []
                            y = np.linspace(1,3,num=1000)
                            for M in y:
                                fun = multiplier*((B/((M**A)-1))+L)
                                x.append(fun)
                                
                            plt.plot(x,y)
                            plt.title('Characteristic Inverse Function')
                            plt.xlabel('Time [s]')
                            plt.ylabel('Current I(RMS)/I(Pick-UP)')
                            plt.xlim(0, 500)
                            plt.ylim(1, 3)
                            plt.grid(color='k', linestyle='-', linewidth=0.5)
                            plt.show()
                ENDCODE
            }
        }
        [
            position = 10192, 9776
            rotation = left
            size = 136, 112
        ]

        component "core/Transmission Line" Line-3_section-2 {
            C_sequence_metric = "C_seq"
            L_sequence_metric = "L3_seq"
            Length_metric = "D3*0.95"
            R_sequence_metric = "R3_seq"
            model = "PI"
            model_def = "Sequence"
            unit_sys = "metric"
        }
        [
            position = 10416, 8432
            rotation = left
            size = 256, 72
        ]

        component "core/Triple Pole Single Throw Contactor" S3 {
            ctrl_src = "Model"
            off_delay = "1/12"
            on_delay = "1/12"
        }
        [
            position = 8912, 7384
            size = 64, 256
        ]

        component Subsystem "Measurements Block - 3" {
            layout = dynamic
            component "core/Current Measurement" I_A {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7288, 7952
                size = 64, 32
            ]

            component "core/Current Measurement" I_B {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7240, 8016
                size = 64, 32
            ]

            component "core/Current Measurement" I_C {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7192, 8112
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_BC {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8552, 7856
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_AB {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8312, 7856
                size = 64, 32
            ]

            component "core/Voltage Measurement" V_CA {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8792, 7872
                size = 64, 32
            ]

            component gen_bus_join "Basic Measurements (Join)" {
                inputs = "9"
            }
            [
                position = 8152, 7528
            ]

            component "core/Current RMS" IrmsA {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7600, 7952
                size = 64, 32
            ]

            component "core/Current RMS" IrmsB {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7536, 8016
                size = 64, 32
            ]

            component "core/Current RMS" IrmsC {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7488, 8112
                size = 64, 32
            ]

            port B+ {
                position = left:2
                kind = pe
            }
            [
                position = 7048, 8016
            ]

            port A- {
                position = right:1
                kind = pe
            }
            [
                position = 9624, 7952
                rotation = down
            ]

            port C+ {
                position = left:3
                kind = pe
            }
            [
                position = 7048, 8112
            ]

            port B- {
                position = right:2
                kind = pe
            }
            [
                position = 9624, 8016
                rotation = down
            ]

            port A+ {
                position = left:1
                kind = pe
            }
            [
                position = 7048, 7952
            ]

            port C- {
                position = right:3
                kind = pe
            }
            [
                position = 9624, 8112
                rotation = down
            ]

            port BM {
                position = top:auto
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8232, 7528
            ]

            tag Goto4 {
                value = "Irms_A"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7888
                hide_name = True
            ]

            tag Goto5 {
                value = "Irms_B"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7856
                hide_name = True
            ]

            tag Goto6 {
                value = "Irms_C"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7672, 7824
                hide_name = True
            ]

            tag Goto10 {
                value = "V_BC"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8552, 7768
                rotation = left
                hide_name = True
            ]

            tag Goto11 {
                value = "V_AB"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8312, 7768
                rotation = left
                hide_name = True
            ]

            tag Goto12 {
                value = "V_CA"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 8792, 7776
                rotation = left
                hide_name = True
                scale = -1, 1
            ]

            tag From7 {
                value = "I_A"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7464
                hide_name = True
            ]

            tag From8 {
                value = "I_B"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7480
                hide_name = True
            ]

            tag From9 {
                value = "I_C"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7496
                hide_name = True
            ]

            tag From10 {
                value = "V_BC"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7512
                hide_name = True
            ]

            tag From11 {
                value = "V_AB"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7544
                hide_name = True
            ]

            tag From12 {
                value = "V_CA"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7528
                hide_name = True
            ]

            tag From13 {
                value = "Irms_A"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 8008, 7560
                hide_name = True
            ]

            tag From14 {
                value = "Irms_B"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7944, 7576
                hide_name = True
            ]

            tag From15 {
                value = "Irms_C"
                scope = local
                kind = sp
                direction = out
            }
            [
                position = 7880, 7592
                hide_name = True
            ]

            tag Goto13 {
                value = "I_A"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7880
                hide_name = True
            ]

            tag Goto14 {
                value = "I_B"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7832
                hide_name = True
            ]

            tag Goto15 {
                value = "I_C"
                scope = local
                kind = sp
                direction = in
            }
            [
                position = 7344, 7800
                hide_name = True
            ]

            junction Junction53 pe
            [
                position = 8344, 8016
            ]

            junction Junction54 pe
            [
                position = 8280, 7952
            ]

            junction Junction55 pe
            [
                position = 8520, 8016
            ]

            junction Junction56 pe
            [
                position = 8584, 8112
            ]

            junction Junction57 pe
            [
                position = 8760, 8112
            ]

            junction Junction58 pe
            [
                position = 8824, 7952
            ]

            connect I_C.p_node C+ as Connection3
            connect I_B.p_node B+ as Connection1
            connect I_A.p_node A+ as Connection5
            connect Goto10 V_BC.out as Connection155
            connect Goto11 V_AB.out as Connection162
            connect Goto12 V_CA.out as Connection178
            connect V_AB.n_node Junction53 as Connection334
            connect V_AB.p_node Junction54 as Connection337
            connect Junction55 Junction53 as Connection339
            connect V_BC.p_node Junction55 as Connection340
            connect V_BC.n_node Junction56 as Connection343
            connect Junction56 Junction57 as Connection344
            connect V_CA.p_node Junction57 as Connection346
            connect Junction54 Junction58 as Connection347
            [
                breakpoints = 8280, 7952; 8392, 7952; 8392, 7952; 8392, 7952; 8440, 7952; 8456, 7952; 8456, 7952; 8456, 7952; 8456, 7952
            ]
            connect V_CA.n_node Junction58 as Connection349
            connect "Basic Measurements (Join).out" BM as Connection368
            connect C- Junction57 as Connection396
            [
                breakpoints = 9416, 8112; 9352, 8112; 9232, 8112; 9168, 8112; 8760, 8112
            ]
            connect Junction55 B- as Connection395
            [
                breakpoints = 8520, 8016; 8520, 8016; 8976, 8016; 9040, 8016; 9040, 8016; 9168, 8016; 9232, 8016
            ]
            connect Junction58 A- as Connection394
            [
                breakpoints = 8824, 7952; 8824, 7952; 8976, 7952; 8976, 7952; 9040, 7952; 9352, 7952; 9416, 7952
            ]
            connect From7 "Basic Measurements (Join).in" as Connection400
            connect From8 "Basic Measurements (Join).in1" as Connection401
            connect From9 "Basic Measurements (Join).in2" as Connection402
            connect From10 "Basic Measurements (Join).in3" as Connection403
            connect From12 "Basic Measurements (Join).in4" as Connection404
            connect From11 "Basic Measurements (Join).in5" as Connection405
            connect Junction54 IrmsA.n_node as Connection406
            connect IrmsA.p_node I_A.n_node as Connection407
            connect I_B.n_node IrmsB.p_node as Connection408
            connect IrmsB.n_node Junction53 as Connection409
            connect I_C.n_node IrmsC.p_node as Connection410
            connect IrmsC.n_node Junction56 as Connection411
            connect From13 "Basic Measurements (Join).in6" as Connection415
            connect From14 "Basic Measurements (Join).in7" as Connection416
            [
                breakpoints = 8120, 7576
            ]
            connect From15 "Basic Measurements (Join).in8" as Connection417
            [
                breakpoints = 8120, 7592
            ]
            connect Goto13 I_A.out as Connection418
            connect Goto14 I_B.out as Connection419
            connect Goto15 I_C.out as Connection420
            connect Goto4 IrmsA.out as Connection421
            connect Goto5 IrmsB.out as Connection422
            connect Goto6 IrmsC.out as Connection423
        }
        [
            position = 8704, 7384
            size = 104, 240
        ]

        component Subsystem Relay-3 {
            layout = dynamic
            component Subsystem "Function (67P)" {
                layout = dynamic
                component src_scada_input Reset {
                    execution_rate = "Ts_relay"
                    max = "1"
                    min = "0"
                    unit = ""
                }
                [
                    position = 7272, 8456
                ]

                component src_scada_input DT {
                    def_value = "0.025"
                    execution_rate = "Ts_relay"
                    max = "1.3"
                    min = "0.024"
                    unit = ""
                }
                [
                    position = 7272, 8608
                ]

                component src_constant Constant1 {
                    execution_rate = "Ts_relay"
                    value = "fun_selected"
                }
                [
                    position = 7272, 8880
                    hide_name = True
                ]

                component src_constant CTp {
                    execution_rate = "Ts_relay"
                    value = "CTp"
                }
                [
                    position = 7272, 8800
                ]

                component gen_probe RS {
                }
                [
                    position = 7456, 8424
                ]

                component gen_probe I_PKU {
                }
                [
                    position = 7456, 8488
                ]

                component src_scada_input I_Pick_Up {
                    def_value = "I_Pick_Up"
                    execution_rate = "Ts_relay"
                    unit = ""
                }
                [
                    position = 7272, 8536
                ]

                component src_constant Constant4 {
                    execution_rate = "Ts_relay"
                    value = "Ts_relay"
                }
                [
                    position = 7272, 8952
                    hide_name = True
                ]

                component gen_probe TMS_Stt {
                }
                [
                    position = 7456, 8656
                ]

                component src_scada_input TMS {
                    def_value = "TMS"
                    execution_rate = "Ts_relay"
                    unit = ""
                }
                [
                    position = 7272, 8704
                ]

                component gen_probe DT_Stt {
                }
                [
                    position = 7456, 8576
                ]

                component gen_product Product1 {
                }
                [
                    position = 8496, 8088
                    hide_name = True
                ]

                component gen_product Product2 {
                }
                [
                    position = 8496, 8136
                    hide_name = True
                ]

                component gen_product Product3 {
                }
                [
                    position = 8496, 8184
                    hide_name = True
                ]

                component gen_c_function "OverCurrent Inverse Function" {
                    global_variables = "real Irms[3];uint i;real M[3];real Ipk_2;real t[3];uint j;real Flag;real B;real A;real L;real multiplier;real counter;real out;real trans;real time;"
                    init_fnc = "/*Begin code section*/
B = 0.14; A = 0.02; L = 0; // Time Inverse Function parameters inicialization
Flag = 0;
TMS = 1;
CTp = 1;
Ipk_2= 1;
multiplier = 1;
out=0;
counter= 0; // 1/60 -> 1 cycle 
time = 1e9;
trans = 0;
/*End code section*/"
                    input_terminals = "inherit Inverse_Function;inherit I_Pick_Up;inherit TMS;inherit CTp;inherit I_Arms;inherit I_Brms;inherit I_Crms;inherit Reset;inherit DT;inherit Ts;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "[(\'Inverse_Function\', True), (\'I_Pick_Up\', True), (\'TMS\', True), (\'CTp\', True), (\'I_Arms\', True), (\'I_Brms\', True), (\'I_Crms\', True), (\'Reset\', True), (\'DT\', True), (\'Ts\', True)]"
                    output_fnc = "/*Begin code section*/
Irms[0] = I_Arms;Irms[1] = I_Brms;Irms[2] = I_Crms;

switch ( (int)Inverse_Function) // Switch Inverse function selected by user
{
    case 0: // Standard Inverse IEC
    {
        B = 0.14; A = 0.02; L = 0; multiplier = TMS;
        break;
    }
    case 1: // Very Inverse IEC
    {
        B = 13.5; A = 1; L = 0; multiplier = TMS;
        break;
    }
    case 2: // Extremely Inverse IEC
    {
        B = 80; A = 2; L = 0; multiplier = TMS;
        break;
    }
    case 3: // Long Time Inverse UK
    {
        B = 120; A = 1; L = 0; multiplier = TMS;
        break;
    }

    case 4: // Rectifier UK
    {
        B = 45900; A = 5.6; L = 0; multiplier = TMS;
        break;
    }
    case 5: // Moderately Invese IEEE
    {
        B = 0.0515; A = 0.02; L = 0.114; multiplier = DT;
        break;
    }
    case 6: // Very Inverse IEEE
    {
        B = 19.61; A = 2; L = 0.491; multiplier = DT;
        break;
    }
    case 7: // Extremely Inverse IEEE
    {
        B = 28.2; A = 2; L = 0.1217; multiplier = DT;
        break;
    }
    case 8: //  Inverse US
    {
        B = 5.95; A = 2; L = 0.18; multiplier = DT;
        break;
    }
    case 9: //  Inverse US
    {
        B = 0.16758; A = 0.02; L = 0.11858; multiplier = DT;
        break;
    }
    default: //  Inverse US
    {
        B = 0.14; A = 0.02; L = 0; multiplier = TMS;
        break;
    }
    
}



if ((int)Reset == 1 ) // Reset statement
{
    trans = 0;
    counter = 0;
    Flag = 0;
}
else if (trans == 0 )
{
    Ipk_2 = I_Pick_Up*CTp/5.0; // Pick-Up current in the primary side
    
    for(i=0; i<3; i++){
        M[i] = Irms[i]/Ipk_2; // Normalize RMS current based on the pickup.
        if(M[i]<=1.0){
            t[i] = 1e6;
        }
        else{
            t[i] = multiplier*((B/(pow(M[i],A)-1))+L); // Time folows IEC function
        }
    }
    
    if((t[0]<=t[1])&&(t[0]<=t[2])){
        time = t[0];
    }
    else if(t[1]<=t[2]){
        time = t[1];
    }
    else{
        time = t[2];
    }
    for(i=0; i<3; i++){
        if(Irms[i]>Ipk_2){
            Flag = 1;
            break;
        }
        else{
            Flag = 0;
        }
    }
}
    if(counter > time){
        out = 1;
        trans = 1;
    }
    else{
        out = 0;
        trans = 0;
    }
    
    counter *= Flag;

    counter += Flag  * Ts;
// OUTPUT
OUT = out;
    time_out = time;
/*End code section*/"
                    output_terminals = "real OUT;inherit time_out;"
                    output_terminals_dimensions = "inherit;inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "[(\'OUT\', True), (\'time_out\', True)]"
                }
                [
                    position = 8128, 8960
                    size = 224, 208
                ]

                component sys_signal_switch "Signal switch2" {
                    criterion = "ctrl != threshold"
                }
                [
                    position = 8480, 8976
                ]

                component src_constant Constant6 {
                    execution_rate = "Ts_relay"
                    value = "0"
                }
                [
                    position = 8352, 9024
                    hide_name = True
                ]

                component sys_signal_switch "Signal switch1" {
                    criterion = "ctrl != threshold"
                }
                [
                    position = 8464, 8544
                ]

                component src_constant Constant2 {
                    execution_rate = "Ts_relay"
                    signal_type = "uint"
                    value = "dir_selected"
                }
                [
                    position = 8464, 8464
                    rotation = right
                    hide_name = True
                ]

                component src_constant Constant3 {
                    execution_rate = "Ts_relay"
                }
                [
                    position = 8336, 8592
                    hide_name = True
                ]

                component gen_c_function "C function (Directional Protection)" {
                    global_variables = "real threshold_Low[3];real threshold_high[3];real vec[6];uint i;uint j;real Flag;real val[3];"
                    init_fnc = "/*Begin code section*/
// Input

// Output
Directional_Trip = 0;
// Transition variables inicialization
Flag = 0;
/*End code section*/"
                    input_terminals = "inherit I_a;inherit I_b;inherit I_c;inherit V_ab;inherit V_ca;inherit V_bc;inherit Reset;inherit RCA;"
                    input_terminals_dimensions = "inherit;inherit;inherit;inherit;inherit;inherit;inherit;inherit"
                    input_terminals_feedthrough = "[\'\']"
                    input_terminals_show_labels = "[(\'I_a\', True), (\'I_b\', True), (\'I_c\', True), (\'V_ab\', True), (\'V_ca\', True), (\'V_bc\', True), (\'Reset\', True), (\'RCA\', True)]"
                    output_fnc = "/*Begin code section*/
// Voltage and Current vector
vec[0] = V_bc; vec[1] = V_ca; vec[2] = V_ab; 
vec[3] = I_a; vec[4] = I_b;vec[5] = I_c;

if ((int)Reset == 1 ) // Reset Statement
{
    Flag = 0; // Trip not allowed

}
else // All angles are placed from 1st to 4th quadrant 
{
    for (i=0;i<3;i++)
    {
        if(vec[i] < 0){vec[i]+=360;}
        if(vec[i+3] < 0){vec[i+3]+=360;}
        val[i] = vec[i]-vec[i+3]+RCA;
        if (val[i] > 360){val[i] -= 360;}
        if (val[i] < 0){val[i] += 360;}
        if ((val[i] >=270 && val[i] < 360) || (val[i] >=0 && val[i] <=90)){Flag = 1;break;}
        else {Flag = 0;}
    }
    
    }

    // OUTPUT
    Directional_Trip = Flag;
/*End code section*/"
                    output_terminals = "real Directional_Trip;"
                    output_terminals_dimensions = "inherit"
                    output_terminals_feedthrough = "[\'\']"
                    output_terminals_show_labels = "[(\'Directional_Trip\', True)]"
                }
                [
                    position = 8128, 8528
                    size = 224, 208
                ]

                component gen_probe "Directional Trip" {
                }
                [
                    position = 8352, 8376
                ]

                component msr_phase "Phase Difference1" {
                }
                [
                    position = 7856, 8056
                    hide_name = True
                ]

                component msr_phase "Phase Difference2" {
                }
                [
                    position = 7856, 7992
                    hide_name = True
                ]

                component msr_phase "Phase Difference3" {
                }
                [
                    position = 7856, 7928
                    hide_name = True
                ]

                component msr_phase "Phase Difference4" {
                }
                [
                    position = 7856, 7856
                    hide_name = True
                ]

                component src_sine "Sinusoidal Source3" {
                    execution_rate = "Ts_relay"
                    frequency = "60"
                }
                [
                    position = 7608, 7848
                    hide_name = True
                ]

                component msr_phase "Phase Difference5" {
                }
                [
                    position = 7856, 8128
                    hide_name = True
                ]

                component msr_phase "Phase Difference6" {
                }
                [
                    position = 7856, 8192
                    hide_name = True
                ]

                component gen_probe "I_A_(Angle)" {
                }
                [
                    position = 7968, 7856
                ]

                component gen_probe "I_B_(Angle)" {
                }
                [
                    position = 7968, 7928
                ]

                component gen_probe "I_C_(Angle)" {
                }
                [
                    position = 7968, 7992
                ]

                component gen_probe "V_BC_(Angle)" {
                }
                [
                    position = 7968, 8056
                ]

                component gen_probe "V_AB_(Angle)" {
                }
                [
                    position = 7968, 8192
                ]

                component gen_probe "V_CA_(Angle)" {
                }
                [
                    position = 7968, 8128
                ]

                component gen_bus_split "Basic Measurements (Split)" {
                    outputs = "9"
                }
                [
                    position = 7152, 8024
                ]

                component gen_probe "I_A(RMS)" {
                }
                [
                    position = 8520, 7848
                ]

                component gen_probe "I_B(RMS)" {
                }
                [
                    position = 8520, 7960
                ]

                component gen_probe "I_C(RMS)" {
                }
                [
                    position = 8520, 7904
                ]

                component gen_probe CTp_Stt {
                }
                [
                    position = 7456, 8760
                ]

                component gen_probe time {
                }
                [
                    position = 8304, 9104
                ]

                component src_constant Constant7 {
                    execution_rate = "Ts_relay"
                    value = "RCA"
                }
                [
                    position = 7272, 9016
                    hide_name = True
                ]

                component gen_probe RCA {
                }
                [
                    position = 7456, 8984
                ]

                component src_scada_input Enable {
                    def_value = "Enable"
                    execution_rate = "Ts_relay"
                    format = "uint"
                    max = "1"
                    min = "0"
                    signal_type = "uint"
                    unit = ""
                }
                [
                    position = 8480, 8896
                    rotation = right
                ]

                port "DOCR Trip" {
                    position = right:auto
                    kind = sp
                    direction =  in
                    sp_type {
                        default = inherit
                        readonly = True
                    }
                }
                [
                    position = 8624, 8976
                ]

                port BM {
                    position = left:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 6984, 8024
                ]

                tag Goto39 {
                    value = "CTp"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8800
                    hide_name = True
                ]

                tag Goto40 {
                    value = "DT"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8608
                    hide_name = True
                ]

                tag Goto41 {
                    value = "I_Pick-Up"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8536
                    hide_name = True
                ]

                tag Goto42 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7392, 8456
                    hide_name = True
                ]

                tag Goto48 {
                    value = "Inverse_Function"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8880
                    hide_name = True
                ]

                tag Goto49 {
                    value = "TMS"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8704
                    hide_name = True
                ]

                tag Goto50 {
                    value = "Ts_relay"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 8952
                    hide_name = True
                ]

                tag From20 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8080
                    hide_name = True
                    size = 99, 20
                ]

                tag From21 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8128
                    hide_name = True
                    size = 99, 20
                ]

                tag From22 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8256, 8176
                    hide_name = True
                    size = 99, 20
                ]

                tag From25 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8096
                    hide_name = True
                ]

                tag From26 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8144
                    hide_name = True
                ]

                tag From27 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8384, 8192
                    hide_name = True
                ]

                tag From28 {
                    value = "CTp"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8928
                    hide_name = True
                ]

                tag From29 {
                    value = "TMS"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8912
                    hide_name = True
                ]

                tag From30 {
                    value = "I_Pick-Up"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8896
                    hide_name = True
                ]

                tag From31 {
                    value = "Inverse_Function"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8880
                    hide_name = True
                ]

                tag From32 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8992
                    hide_name = True
                ]

                tag From34 {
                    value = "DT"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 9008
                    hide_name = True
                ]

                tag Goto38 {
                    value = "Trip_Directional"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8648, 8544
                    hide_name = True
                    size = 104, 20
                ]

                tag From35 {
                    value = "Ts_relay"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7808, 9024
                    hide_name = True
                    size = 99, 20
                ]

                tag From5 {
                    value = "I_A_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8448
                    hide_name = True
                ]

                tag From6 {
                    value = "I_B_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8472
                    hide_name = True
                ]

                tag From7 {
                    value = "I_C_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8496
                    hide_name = True
                ]

                tag From8 {
                    value = "V_AB_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8520
                    hide_name = True
                ]

                tag From9 {
                    value = "V_CA_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7848, 8544
                    hide_name = True
                ]

                tag From10 {
                    value = "V_BC_(Angle)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8568
                    hide_name = True
                ]

                tag From23 {
                    value = "Reset"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7840, 8592
                    hide_name = True
                ]

                tag Goto7 {
                    value = "V_BC_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8032
                    hide_name = True
                ]

                tag Goto8 {
                    value = "V_AB_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8168
                    hide_name = True
                ]

                tag Goto9 {
                    value = "V_CA_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 8104
                    hide_name = True
                ]

                tag Goto10 {
                    value = "I_A_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7824
                    hide_name = True
                ]

                tag Goto11 {
                    value = "I_B_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7896
                    hide_name = True
                ]

                tag Goto12 {
                    value = "I_C_(Angle)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8048, 7968
                    hide_name = True
                ]

                tag Goto13 {
                    value = "I_A"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 7960
                    hide_name = True
                ]

                tag Goto14 {
                    value = "I_B"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 7976
                    hide_name = True
                ]

                tag Goto15 {
                    value = "I_C"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 7992
                    hide_name = True
                ]

                tag Goto16 {
                    value = "V_BC"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 8008
                    hide_name = True
                ]

                tag Goto17 {
                    value = "V_CA"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 8024
                    hide_name = True
                ]

                tag Goto18 {
                    value = "V_AB"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 8040
                    hide_name = True
                ]

                tag From13 {
                    value = "I_A"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 7864
                    hide_name = True
                ]

                tag From14 {
                    value = "I_B"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 7936
                    hide_name = True
                ]

                tag From15 {
                    value = "I_C"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8000
                    hide_name = True
                ]

                tag From16 {
                    value = "V_BC"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8064
                    hide_name = True
                ]

                tag From36 {
                    value = "V_CA"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8136
                    hide_name = True
                ]

                tag From37 {
                    value = "V_AB"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7760, 8200
                    hide_name = True
                ]

                tag Goto45 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7256, 8056
                    hide_name = True
                ]

                tag Goto46 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7320, 8072
                    hide_name = True
                ]

                tag Goto47 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7384, 8088
                    hide_name = True
                ]

                tag Goto51 {
                    value = "IA(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8088
                    hide_name = True
                    size = 104, 20
                ]

                tag Goto52 {
                    value = "IB(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8136
                    hide_name = True
                    size = 104, 20
                ]

                tag Goto53 {
                    value = "IC(RMS)"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 8608, 8184
                    hide_name = True
                    size = 104, 20
                ]

                tag From38 {
                    value = "IA(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8944
                    hide_name = True
                ]

                tag From39 {
                    value = "IB(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7824, 8960
                    hide_name = True
                ]

                tag From40 {
                    value = "IC(RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7888, 8976
                    hide_name = True
                ]

                tag From41 {
                    value = "I_A (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7848
                    hide_name = True
                ]

                tag From42 {
                    value = "I_B (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7904
                    hide_name = True
                ]

                tag From43 {
                    value = "I_C (RMS)"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 8408, 7960
                    hide_name = True
                ]

                tag Goto54 {
                    value = "RCA"
                    scope = local
                    kind = sp
                    direction = in
                }
                [
                    position = 7400, 9016
                    hide_name = True
                ]

                tag From44 {
                    value = "RCA"
                    scope = local
                    kind = sp
                    direction = out
                }
                [
                    position = 7912, 8608
                    hide_name = True
                ]

                junction Junction81 sp
                [
                    position = 7328, 8456
                ]

                junction Junction84 sp
                [
                    position = 7352, 8536
                ]

                junction Junction86 sp
                [
                    position = 7328, 8608
                ]

                junction Junction88 sp
                [
                    position = 7336, 8704
                ]

                junction Junction89 sp
                [
                    position = 8296, 8528
                ]

                junction Junction1 sp
                [
                    position = 7936, 7856
                ]

                junction Junction2 sp
                [
                    position = 7936, 7928
                ]

                junction Junction3 sp
                [
                    position = 7936, 7992
                ]

                junction Junction4 sp
                [
                    position = 7936, 8056
                ]

                junction Junction5 sp
                [
                    position = 7936, 8128
                ]

                junction Junction6 sp
                [
                    position = 7936, 8192
                ]

                junction Junction7 sp
                [
                    position = 7648, 7848
                ]

                junction Junction8 sp
                [
                    position = 7648, 7920
                ]

                junction Junction9 sp
                [
                    position = 7648, 7984
                ]

                junction Junction10 sp
                [
                    position = 7648, 8048
                ]

                junction Junction11 sp
                [
                    position = 7648, 8120
                ]

                junction Junction90 sp
                [
                    position = 7344, 8800
                ]

                junction Junction91 sp
                [
                    position = 7328, 9016
                ]

                comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Basic Measurements</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 7088, 7896
                ]

                comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Phase Measurements</p></body></html> ENDCOMMENT 
                [
                    position = 7784, 7744
                ]

                comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">RMS Currents Measurements</p></body></html> ENDCOMMENT 
                [
                    position = 8344, 7800
                ]

                comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">SCADA INPUTS</p></body></html> ENDCOMMENT 
                [
                    position = 7296, 8352
                ]

                comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directionality &amp;&amp; Current (RMS)</p></body></html> ENDCOMMENT 
                [
                    position = 8328, 7992
                ]

                comment Comment6 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directional Protecction </p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 8040, 8368
                ]

                comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">OverCurrent Protection</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
                [
                    position = 8032, 8800
                ]

                connect Constant1.out Goto48 as Connection902
                [
                    breakpoints = 7328, 8880
                ]
                connect Reset.out Junction81 as Connection843
                connect Junction81 Goto42 as Connection844
                connect RS.in Junction81 as Connection845
                connect I_PKU.in Junction84 as Connection937
                connect Junction84 Goto41 as Connection938
                [
                    breakpoints = 7352, 8528
                ]
                connect I_Pick_Up.out Junction84 as Connection939
                connect Goto50 Constant4.out as Connection943
                connect DT.out Junction86 as Connection956
                connect Junction86 Goto40 as Connection957
                [
                    breakpoints = 7328, 8608
                ]
                connect DT_Stt.in Junction86 as Connection958
                connect Goto49 Junction88 as Connection964
                connect Junction88 TMS.out as Connection965
                connect TMS_Stt.in Junction88 as Connection966
                connect From20 Product1.in as Connection355
                connect From21 Product2.in as Connection357
                connect From22 Product3.in as Connection359
                connect From25 Product1.in1 as Connection708
                connect From26 Product2.in1 as Connection709
                connect From27 Product3.in1 as Connection710
                connect From28 "OverCurrent Inverse Function.CTp" as Connection714
                connect From29 "OverCurrent Inverse Function.TMS" as Connection715
                connect From30 "OverCurrent Inverse Function.I_Pick_Up" as Connection917
                connect From35 "OverCurrent Inverse Function.Ts" as Connection944
                connect Constant6.out "Signal switch2.in1" as Connection972
                connect "DOCR Trip" "Signal switch2.out" as Connection973
                connect Constant2.out "Signal switch1.in2" as Connection880
                connect Constant3.out "Signal switch1.in1" as Connection886
                connect From5 "C function (Directional Protection).I_a" as Connection336
                connect From6 "C function (Directional Protection).I_b" as Connection337
                connect From7 "C function (Directional Protection).I_c" as Connection338
                connect From8 "C function (Directional Protection).V_ab" as Connection339
                connect From9 "C function (Directional Protection).V_ca" as Connection340
                connect From10 "C function (Directional Protection).V_bc" as Connection341
                connect From23 "C function (Directional Protection).Reset" as Connection554
                connect Goto38 "Signal switch1.out" as Connection977
                connect "C function (Directional Protection).Directional_Trip" Junction89 as Connection979
                connect Junction89 "Signal switch1.in" as Connection980
                connect "Directional Trip.in" Junction89 as Connection981
                [
                    breakpoints = 8296, 8376; 8296, 8528
                ]
                connect "Basic Measurements (Split).in" BM as Connection243
                connect "I_A_(Angle).in" Junction1 as Connection317
                connect Junction1 "Phase Difference4.phase_diff" as Connection318
                connect Goto10 Junction1 as Connection319
                connect "Phase Difference3.phase_diff" Junction2 as Connection320
                connect Junction2 "I_B_(Angle).in" as Connection321
                connect Goto11 Junction2 as Connection322
                connect "Phase Difference2.phase_diff" Junction3 as Connection323
                connect Junction3 "I_C_(Angle).in" as Connection324
                connect Goto12 Junction3 as Connection325
                connect "V_BC_(Angle).in" Junction4 as Connection327
                connect Junction4 "Phase Difference1.phase_diff" as Connection328
                connect Goto7 Junction4 as Connection329
                connect "V_CA_(Angle).in" Junction5 as Connection982
                connect Junction5 "Phase Difference5.phase_diff" as Connection332
                connect Goto9 Junction5 as Connection983
                connect "V_AB_(Angle).in" Junction6 as Connection984
                connect Junction6 "Phase Difference6.phase_diff" as Connection985
                connect Goto8 Junction6 as Connection986
                connect "Sinusoidal Source3.out" Junction7 as Connection987
                connect Junction7 "Phase Difference4.signal2" as Connection988
                connect "Phase Difference3.signal2" Junction8 as Connection342
                connect Junction8 Junction7 as Connection343
                connect "Phase Difference2.signal2" Junction9 as Connection345
                connect Junction9 Junction8 as Connection346
                connect "Phase Difference1.signal2" Junction10 as Connection348
                connect Junction10 Junction9 as Connection349
                connect "Phase Difference5.signal2" Junction11 as Connection351
                connect Junction11 Junction10 as Connection352
                connect "Phase Difference6.signal2" Junction11 as Connection353
                connect Goto13 "Basic Measurements (Split).out" as Connection354
                connect Goto14 "Basic Measurements (Split).out1" as Connection989
                connect Goto15 "Basic Measurements (Split).out2" as Connection356
                connect Goto16 "Basic Measurements (Split).out3" as Connection990
                connect Goto17 "Basic Measurements (Split).out4" as Connection358
                connect Goto18 "Basic Measurements (Split).out5" as Connection991
                connect From13 "Phase Difference4.signal1" as Connection360
                connect From14 "Phase Difference3.signal1" as Connection361
                connect From15 "Phase Difference2.signal1" as Connection362
                connect From16 "Phase Difference1.signal1" as Connection363
                connect From36 "Phase Difference5.signal1" as Connection364
                connect From37 "Phase Difference6.signal1" as Connection365
                connect Goto51 Product1.out as Connection994
                connect Goto52 Product2.out as Connection995
                connect Goto53 Product3.out as Connection996
                connect From38 "OverCurrent Inverse Function.I_Arms" as Connection997
                connect From39 "OverCurrent Inverse Function.I_Brms" as Connection998
                connect From40 "OverCurrent Inverse Function.I_Crms" as Connection999
                connect From32 "OverCurrent Inverse Function.Reset" as Connection1000
                connect From34 "OverCurrent Inverse Function.DT" as Connection1001
                connect "Signal switch2.in" "OverCurrent Inverse Function.OUT" as Connection1009
                connect Goto45 "Basic Measurements (Split).out6" as Connection1010
                connect Goto46 "Basic Measurements (Split).out7" as Connection1011
                connect Goto47 "Basic Measurements (Split).out8" as Connection1012
                connect From41 "I_A(RMS).in" as Connection1013
                connect From42 "I_C(RMS).in" as Connection1014
                connect From43 "I_B(RMS).in" as Connection1015
                connect "OverCurrent Inverse Function.Inverse_Function" From31 as Connection1026
                [
                    breakpoints = 7960, 8880
                ]
                connect CTp.out Junction90 as Connection1028
                [
                    breakpoints = 7328, 8800
                ]
                connect Junction90 Goto39 as Connection1029
                connect CTp_Stt.in Junction90 as Connection1030
                connect time.in "OverCurrent Inverse Function.time_out" as Connection1031
                connect From44 "C function (Directional Protection).RCA" as Connection1033
                connect Goto54 Junction91 as Connection1034
                connect Junction91 Constant7.out as Connection1035
                connect RCA.in Junction91 as Connection1036
                connect Enable.out "Signal switch2.in2" as Connection1037

                mask {
                    description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Directional OverCurrent Block</p></body></html>"

                    CODE open
                        from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                    
                        dialog = RegularComponentPropertiesDialog(
                            component=component,
                            property_container=component.masks[-1],
                            current_diagram=current_diagram
                        )
                        dialog.exec_()
                        
                    ENDCODE
                }
            }
            [
                position = 7840, 8312
                size = 264, 216
            ]

            component gen_probe Trip {
            }
            [
                position = 8240, 8240
            ]

            component gen_comparator Comparator1 {
            }
            [
                position = 8160, 8320
                hide_name = True
            ]

            component src_constant Constant1 {
                execution_rate = "Ts"
                value = "0.5"
            }
            [
                position = 8056, 8400
                hide_name = True
            ]

            component gen_logic_op "Logical operator1" {
                operator = "NOT"
            }
            [
                position = 8304, 8320
            ]

            component "core/Rate Transition" "Rate Transition2" {
                execution_rate = "Ts"
            }
            [
                position = 8064, 8312
                hide_name = True
                size = 32, 32
            ]

            component "core/Rate Transition" "Rate Transition1" {
                execution_rate = "Ts_relay"
            }
            [
                position = 7616, 8312
                hide_name = True
                size = 32, 32
            ]

            port BM {
                position = left:auto
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 7536, 8312
            ]

            port "Trip DOCR" {
                position = right:auto
                kind = sp
                direction =  in
                sp_type {
                    default = inherit
                    readonly = True
                }
            }
            [
                position = 8464, 8320
            ]

            comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Relay Output</p><p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html> ENDCOMMENT 
            [
                position = 8408, 8240
            ]

            comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ANSI 67 (DOCR)</p></body></html> ENDCOMMENT 
            [
                position = 7784, 8168
            ]

            connect Constant1.out Comparator1.in2 as Connection69
            connect Comparator1.out Trip.in as Connection74
            [
                breakpoints = 8192, 8320
            ]
            connect "Trip DOCR" "Logical operator1.out" as Connection81
            connect "Logical operator1.in" Comparator1.out as Connection82
            connect Comparator1.in1 "Rate Transition2.out" as Connection85
            connect "Rate Transition2.in" "Function (67P).DOCR Trip" as Connection86
            connect BM "Rate Transition1.in" as Connection87
            connect "Rate Transition1.out" "Function (67P).BM" as Connection88

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">Relay - 3 (Directional OverCurrent Relay)</p></body></html>"

                enable {
                    label = "Enable/Disable Relay"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "Enable"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "Enable"),int(0))
                    ENDCODE
                }

                Enable {
                    widget = edit
                    type = generic
                    default_value = "1"
                    nonvisible
                }

                function {
                    label = "I > 1 Function"
                    widget = combo
                    combo_values = "IEC Standard Inverse", "IEC Very Inverse", "IEC Extremely Inverse", "UK Long Time Inverse", "UK Rectifier", "IEEE Moderately Inverse", "IEEE Very Inverse", "IEEE Extremely Inverse", "US Inverse", "US Short Time Inverse"
                    type = string
                    default_value = "IEC Standard Inverse"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        dinamic(container_handle,"Dinamic",new_value)
                    ENDCODE

                    CODE property_value_edited
                        dinamic(container_handle,"Dinamic",new_value)
                    ENDCODE
                }

                fun_selected {
                    widget = edit
                    type = generic
                    default_value = "0"
                    nonvisible
                }

                direction {
                    label = "Direction / Non-Direction"
                    widget = checkbox
                    type = bool
                    default_value = "True"
                    group = "O/C Group"
                    no_evaluate

                    CODE property_value_changed
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(0))
                    ENDCODE

                    CODE property_value_edited
                        if new_value:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(1))
                        else:
                            mdl.set_property_value(mdl.prop(container_handle, "dir_selected"),int(0))
                    ENDCODE
                }

                dir_selected {
                    widget = edit
                    type = generic
                    default_value = "1"
                    nonvisible
                }

                I_Pick_Up {
                    label = "I > 1 Current Set"
                    widget = edit
                    type = generic
                    default_value = "15"
                    unit = "[A]"
                    group = "O/C Group"
                }

                TMS {
                    label = "I > 1 TMS "
                    widget = edit
                    type = generic
                    default_value = "0.313"
                    group = "O/C Group"
                }

                DT {
                    label = "I > 1 DT Adder"
                    widget = edit
                    type = generic
                    default_value = "0.3"
                    unit = "[A]"
                    group = "O/C Group"
                    nonvisible
                    disabled
                }

                CTp {
                    label = "Primary CT"
                    widget = edit
                    type = generic
                    default_value = "200"
                    group = "O/C Group"
                }

                RCA {
                    label = "I > Char angle"
                    widget = edit
                    type = generic
                    default_value = "45"
                    unit = "[deg]"
                    group = "O/C Group"
                }

                Ts_relay {
                    label = "Time Step"
                    widget = edit
                    type = generic
                    default_value = "Ts_new"
                    unit = "[s]"
                    group = "O/C Group"
                }

                properties {
                    label = "Press to visualize selected settings"
                    widget = button
                    type = string
                    default_value = "Show"
                    group = "O/C Group"
                    no_evaluate

                    CODE button_clicked
                        direction = mdl.get_property_disp_value(mdl.prop(container_handle, "direction"))
                        I_Pick_Up = mdl.get_property_disp_value(mdl.prop(container_handle, "I_Pick_Up"))
                        TMS = mdl.get_property_disp_value(mdl.prop(container_handle, "TMS"))
                        DT = mdl.get_property_disp_value(mdl.prop(container_handle, "DT"))
                        CTp = mdl.get_property_disp_value(mdl.prop(container_handle, "CTp"))
                        Ts_relay = mdl.get_property_disp_value(mdl.prop(container_handle, "Ts_relay"))
                        function = mdl.get_property_disp_value(mdl.prop(container_handle, "function"))
                        
                        
                        mdl.info('\n \n \n \n ')
                        mdl.info("###############     Relay - 3   ################# \n \n")
                        mdl.info("Selected function --> {}".format(function))
                        mdl.info("Directional relay --> {} ".format(direction))
                        mdl.info("Pick Up current set to --> {} [A]".format(I_Pick_Up))
                        mdl.info("Time multiple setting (TMS) set to --> {}".format(TMS))
                        mdl.info("Time dial setting (DT) set to --> {}".format(DT))
                        mdl.info("Primary CT set to --> {}".format(CTp))
                        mdl.info("Relay Time step (Ts) set to --> {}".format(Ts_relay))
                    ENDCODE
                }

                preview {
                    widget = button
                    type = string
                    default_value = "Preview OC Function"
                    group = "O/C Group"
                    no_evaluate

                    CODE button_clicked
                        graphic(container_handle,"Grafic")
                    ENDCODE
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE define_icon
                    image('p145.jpg')
                ENDCODE

                CODE init
                    from handlers.look_up_table import preview_lut
                    import matplotlib.pyplot as plt
                    
                    def dinamic(item_handle,prop,new_value):
                        if prop == "Dinamic":
                            I_Pick_Up = mdl.prop(item_handle, "I_Pick_Up")
                            TMS = mdl.prop(item_handle, "TMS")
                            DT = mdl.prop(item_handle, "DT")
                            Ts_relay = mdl.prop(item_handle, "Ts_relay")
                            fun_selected = mdl.prop(item_handle, "fun_selected")
                            
                            if new_value == "IEC Standard Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,0)
                                
                            elif new_value == "IEC Very Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,1)
                                
                            elif new_value == "IEC Extremely Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,2)
                                
                            elif new_value == "UK Long Time Inverse":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,3)
                                
                            elif new_value == "UK Rectifier":
                                mdl.enable_property(TMS)
                                mdl.show_property(TMS)
                                mdl.hide_property(DT)
                                mdl.disable_property(DT)
                                mdl.set_property_value(fun_selected,4)
                                
                            elif new_value == "IEEE Moderately Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,5)
                                
                            elif new_value == "IEEE Very Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,6)
                                
                            elif new_value == "IEEE Extremely Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,7)
                                
                            elif new_value == "US Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,8)
                                
                            elif new_value == "US Short Time Inverse":
                                mdl.enable_property(DT)
                                mdl.show_property(DT)
                                mdl.hide_property(TMS)
                                mdl.disable_property(TMS)
                                mdl.set_property_value(fun_selected,9)
                        
                    
                    
                    
                    def values(fun_selected):
                        if fun_selected == 0:
                            B = 0.14; A = 0.02; L = 0
                        elif fun_selected == 1:
                            B = 13.5; A = 1; L = 0
                        elif fun_selected == 2:
                            B = 80; A = 2; L = 0
                        elif fun_selected == 3:
                            B = 120; A = 1; L = 0
                        elif fun_selected == 4:
                            B = 45900; A = 5.6; L = 0
                        elif fun_selected == 5:
                            B = 0.0515; A = 0.02; L = 0.114
                        elif fun_selected == 6:
                            B = 19.61; A = 2; L = 0.491
                        elif fun_selected == 7:
                            B = 28.2; A = 2; L = 0.1217
                        elif fun_selected == 8:
                            B = 5.95; A = 2; L = 0.18
                        elif fun_selected == 9:
                            B = 0.16758; A = 0.02; L = 0.11858
                        return A,B,L;
                    
                    def graphic(item_handle,prop):
                            fun_selected = mdl.get_property_value(mdl.prop(item_handle, "fun_selected"))
                            TMS = float(mdl.get_property_disp_value(mdl.prop(item_handle, "TMS")))
                            DT = float(mdl.get_property_disp_value(mdl.prop(item_handle, "DT")))
                            A,B,L = values(fun_selected)
                            
                            multiplier =1
                            if ( mdl.is_property_enabled(mdl.prop(item_handle, "TMS")) == True):
                                if TMS > 0:
                                    multiplier = TMS
                            elif (mdl.is_property_enabled(mdl.prop(item_handle, "DT")) == True):
                                if DT > 0:
                                    multiplier = DT
                            
                            x = [];y = []
                            y = np.linspace(1,3,num=1000)
                            for M in y:
                                fun = multiplier*((B/((M**A)-1))+L)
                                x.append(fun)
                                
                            plt.plot(x,y)
                            plt.title('Characteristic Inverse Function')
                            plt.xlabel('Time [s]')
                            plt.ylabel('Current I(RMS)/I(Pick-UP)')
                            plt.xlim(0, 500)
                            plt.ylim(1, 3)
                            plt.grid(color='k', linestyle='-', linewidth=0.5)
                            plt.show()
                ENDCODE
            }
        }
        [
            position = 8824, 7184
            size = 136, 112
        ]

        tag "Electric Tag19" {
            value = "gnd_2"
            scope = local
            kind = pe
        }
        [
            position = 9144, 7488
            rotation = left
            hide_name = True
            size = 60, 20
        ]

        tag "Electric Tag29" {
            value = "gnd_1"
            scope = local
            kind = pe
        }
        [
            position = 6976, 8520
            rotation = left
            hide_name = True
            scale = 1, -1
            size = 59, 20
        ]

        tag "Electric Tag30" {
            value = "gnd_1"
            scope = local
            kind = pe
        }
        [
            position = 9112, 7488
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag31" {
            value = "gnd_1"
            scope = local
            kind = pe
        }
        [
            position = 6272, 7176
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag32" {
            value = "gnd_1"
            scope = local
            kind = pe
        }
        [
            position = 6504, 6856
            rotation = right
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag33" {
            value = "gnd"
            scope = local
            kind = pe
        }
        [
            position = 7008, 8520
            rotation = left
            hide_name = True
            scale = 1, -1
            size = 59, 20
        ]

        tag "Electric Tag34" {
            value = "gnd"
            scope = local
            kind = pe
        }
        [
            position = 7776, 10280
            rotation = down
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag35" {
            value = "gnd"
            scope = local
            kind = pe
        }
        [
            position = 7672, 10608
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag44" {
            value = "gnd_1"
            scope = local
            kind = pe
        }
        [
            position = 5824, 7480
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag45" {
            value = "gnd_3"
            scope = local
            kind = pe
        }
        [
            position = 5792, 7480
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag46" {
            value = "gnd"
            scope = local
            kind = pe
        }
        [
            position = 10520, 9088
            rotation = down
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag47" {
            value = "gnd_2"
            scope = local
            kind = pe
        }
        [
            position = 10520, 9040
            rotation = down
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag52" {
            value = "gnd_3"
            scope = local
            kind = pe
        }
        [
            position = 6936, 10184
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag53" {
            value = "gnd"
            scope = local
            kind = pe
        }
        [
            position = 6968, 10184
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag66" {
            value = "gnd_2"
            scope = local
            kind = pe
        }
        [
            position = 9688, 7496
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag67" {
            value = "gnd_2"
            scope = local
            kind = pe
        }
        [
            position = 10528, 8008
            rotation = down
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag69" {
            value = "gnd"
            scope = local
            kind = pe
        }
        [
            position = 9224, 10208
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag72" {
            value = "gnd_1"
            scope = local
            kind = pe
        }
        [
            position = 6736, 8712
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag73" {
            value = "gnd_3"
            scope = local
            kind = pe
        }
        [
            position = 6688, 10192
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag74" {
            value = "gnd_3"
            scope = local
            kind = pe
        }
        [
            position = 5392, 8720
            rotation = down
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag75" {
            value = "gnd_1"
            scope = local
            kind = pe
        }
        [
            position = 7168, 7488
            rotation = left
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag76" {
            value = "gnd_2"
            scope = local
            kind = pe
        }
        [
            position = 10528, 8392
            rotation = down
            hide_name = True
            size = 59, 20
        ]

        tag "Electric Tag81" {
            value = "gnd_2"
            scope = local
            kind = pe
        }
        [
            position = 10512, 8232
            rotation = down
            hide_name = True
            size = 59, 20
        ]

        junction Junction67 pe
        [
            position = 6344, 7176
        ]

        junction Junction76 pe
        [
            position = 7552, 10568
        ]

        junction Junction111 pe
        [
            position = 7728, 10280
        ]

        junction Junction205 pe
        [
            position = 10512, 7480
        ]

        junction Junction206 pe
        [
            position = 10416, 7496
        ]

        junction Junction207 pe
        [
            position = 10320, 7512
        ]

        junction Junction213 pe
        [
            position = 10512, 9944
        ]

        junction Junction214 pe
        [
            position = 10416, 9960
        ]

        junction Junction215 pe
        [
            position = 10320, 9968
        ]

        junction Junction216 pe
        [
            position = 8136, 7400
        ]

        junction Junction217 pe
        [
            position = 8152, 7384
        ]

        junction Junction218 pe
        [
            position = 8168, 7368
        ]

        junction Junction221 pe
        [
            position = 5600, 10120
        ]

        junction Junction222 pe
        [
            position = 5584, 10088
        ]

        junction Junction223 pe
        [
            position = 5568, 10056
        ]

        comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 1</span></p></body></html> ENDCOMMENT 
        [
            position = 5208, 9896
            rotation = left
        ]

        comment Comment2 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 8</span></p></body></html> ENDCOMMENT 
        [
            position = 6088, 7360
        ]

        comment Comment3 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 13</span> </p></body></html> ENDCOMMENT 
        [
            position = 5440, 10064
        ]

        comment Comment4 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 6</span> </p></body></html> ENDCOMMENT 
        [
            position = 7208, 10064
        ]

        comment Comment5 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 7</span> </p></body></html> ENDCOMMENT 
        [
            position = 7488, 9848
        ]

        comment Comment7 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 2</span> </p></body></html> ENDCOMMENT 
        [
            position = 6704, 7360
        ]

        comment Comment8 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 9</span> </p></body></html> ENDCOMMENT 
        [
            position = 7856, 7360
        ]

        comment Comment9 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 3</span> </p></body></html> ENDCOMMENT 
        [
            position = 8760, 7072
        ]

        comment Comment10 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 10</span> </p></body></html> ENDCOMMENT 
        [
            position = 10064, 7360
        ]

        comment Comment11 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 4</span> </p></body></html> ENDCOMMENT 
        [
            position = 9960, 7712
            rotation = left
        ]

        comment Comment12 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 11</span> </p></body></html> ENDCOMMENT 
        [
            position = 9952, 9760
            rotation = left
        ]

        comment Comment13 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 5</span> </p></body></html> ENDCOMMENT 
        [
            position = 10088, 10064
        ]

        comment Comment14 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18pt; font-weight:696;">Relay - 12</span> </p></body></html> ENDCOMMENT 
        [
            position = 8168, 9768
        ]

        comment Comment15 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:22pt;">Universidad De Los Andes </span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:22pt;">Departamento de IngenierÃ­a ElÃ©ctrica y ElectrÃ³nica</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:22pt;">Autor: Felipe Antonio GÃ³mez Olaya</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:22pt;">Asesor : Paulo Manuel De Oliveira de JesÃºs</span></p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:22pt;">Coasesor: David Felipe Celeita  Rodriguez </span> </p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Editado por: Juan David HernÃ¡ndez </p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Directional Overcurrent Relays      </p></body></html> ENDCOMMENT 
        [
            position = 8504, 8512
        ]

        connect "Gen -2.c_node" L7.n_node as Connection640
        connect L8.n_node "Gen -2.b_node" as Connection643
        connect "Gen -2.a_node" L9.n_node as Connection644
        connect "Bus 1.A+" Tr1.sec_3 as Connection1203
        connect "Bus 1.B+" Tr1.sec_2 as Connection1204
        connect "Bus 1.C+" Tr1.sec_1 as Connection1205
        connect "Gen - 1.a_node" L6.p_node as Connection1839
        connect "Gen - 1.b_node" L5.p_node as Connection1840
        connect "Gen - 1.c_node" L4.p_node as Connection1841
        connect L4.n_node Tr1.prm_1 as Connection1842
        connect L5.n_node Tr1.prm_2 as Connection1843
        connect L6.n_node Tr1.prm_3 as Connection1844
        connect Tr1.n1 Junction67 as Connection2063
        [
            breakpoints = 6344, 7144
        ]
        connect Junction67 Tr1.n2 as Connection2064
        [
            breakpoints = 6344, 7176; 6344, 7176; 6344, 7176
        ]
        connect "Electric Tag31" Junction67 as Connection2065
        connect "Electric Tag32" "Gen - 1.n_node" as Connection2270
        connect "Gen -2.n_node" Junction76 as Connection2284
        connect Junction76 gnd5.node as Connection2285
        [
            breakpoints = 7552, 10560
        ]
        connect "Electric Tag35" Junction76 as Connection2286
        connect "Measurements Block - 12.A-" S12.a_in as Connection2322
        connect "Measurements Block - 12.B-" S12.b_in as Connection2323
        connect "Measurements Block - 12.C-" S12.c_in as Connection2324
        connect Tr2.prm_3 L7.p_node as Connection2411
        connect Tr2.prm_2 L8.p_node as Connection2412
        connect L9.p_node Tr2.prm_1 as Connection2413
        connect "Measurements Block - 12.B+" "Bus 5.B-" as Connection2443
        [
            breakpoints = 7944, 10088
        ]
        connect "Measurements Block - 12.C+" "Bus 5.C-" as Connection2444
        [
            breakpoints = 8016, 10184
        ]
        connect "Bus 5.A-" "Measurements Block - 12.A+" as Connection2442
        [
            breakpoints = 8016, 10056; 8016, 9992
        ]
        connect Tr2.sec_1 "Bus 5.A+" as Connection2509
        connect Tr2.sec_2 "Bus 5.B+" as Connection2510
        connect Tr2.sec_3 "Bus 5.C+" as Connection2511
        connect "Relay-12.Trip DOCR" S12.ctrl_in as Connection2533
        connect Relay-12.BM "Measurements Block - 12.BM" as Connection2534
        [
            breakpoints = 8120, 9904; 8120, 9904
        ]
        connect "Relay-4.Trip DOCR" S4.ctrl_in as Connection2542
        connect Tr2.n2 Junction111 as Connection2686
        [
            breakpoints = 7728, 10256; 7728, 10256
        ]
        connect Junction111 Tr2.n1 as Connection2687
        connect "Electric Tag34" Junction111 as Connection2688
        connect "Electric Tag33" "Couplin(4ph)-2.Port8" as Connection3622
        connect "Electric Tag29" "Couplin(4ph)-2.Port7" as Connection3623
        connect "Couplin(3ph)-1.Port5" "Bus 5.B--" as Connection3638
        connect "Couplin(3ph)-1.Port6" "Bus 5.C--" as Connection3639
        connect "Electric Tag53" "Couplin(3ph)-1.Port8" as Connection3640
        connect "Electric Tag52" "Couplin(3ph)-1.Port7" as Connection3641
        connect "Couplin(4ph)-3.Port5" "Bus 1.B--" as Connection3646
        connect "Couplin(4ph)-3.Port6" "Bus 1.C--" as Connection3647
        connect "Electric Tag44" "Couplin(4ph)-3.Port8" as Connection3654
        connect "Electric Tag45" "Couplin(4ph)-3.Port7" as Connection3655
        connect Line-2.b_out "Bus 3.B+" as Connection3664
        connect Line-2.a_out "Bus 3.A+" as Connection3665
        connect Line-2.c_out "Bus 3.C+" as Connection3666
        connect "Electric Tag66" Line-2.gnd as Connection3670
        connect "Electric Tag67" Line-3_section-1.gnd as Connection3698
        connect "Electric Tag69" Line-4.gnd as Connection3744
        connect Line-4.b_in S12.b_out as Connection3775
        connect Line-4.c_in S12.c_out as Connection3776
        connect Line-7.a_out "Couplin(4ph)-2.Port3" as Connection3786
        connect Line-7.b_out "Couplin(4ph)-2.Port2" as Connection3787
        connect Line-7.c_out "Couplin(4ph)-2.Port1" as Connection3788
        connect "Electric Tag72" Line-7.gnd as Connection3794
        connect Line-5.a_out "Couplin(3ph)-1.Port1" as Connection3796
        connect Line-5.b_out "Couplin(3ph)-1.Port2" as Connection3797
        connect Line-5.c_out "Couplin(3ph)-1.Port3" as Connection3798
        connect "Electric Tag73" Line-5.gnd as Connection3799
        connect Line-6.b_in "Bus 6.B-" as Connection3806
        connect Line-6.c_in "Bus 6.C-" as Connection3808
        connect Line-6.a_out "Couplin(4ph)-3.Port1" as Connection3809
        connect Line-6.b_out "Couplin(4ph)-3.Port2" as Connection3810
        connect Line-6.c_out "Couplin(4ph)-3.Port3" as Connection3811
        connect "Electric Tag74" Line-6.gnd as Connection3815
        connect "Electric Tag75" Line-1.gnd as Connection3819
        connect Line-1.b_in "Bus 1.B-" as Connection3821
        connect Line-1.c_in "Bus 1.C-" as Connection3837
        connect "Measurements Block - 4.A-" S4.a_in as Connection3848
        connect "Measurements Block - 4.B-" S4.b_in as Connection3849
        connect "Measurements Block - 4.C-" S4.c_in as Connection3850
        connect "Measurements Block - 4.BM" Relay-4.BM as Connection3854
        connect "Measurements Block - 4.C+" Junction205 as Connection3855
        connect Junction205 "Bus 3.C-" as Connection3856
        connect Load2.C Junction205 as Connection3857
        connect "Measurements Block - 4.B+" Junction206 as Connection3858
        connect Junction206 "Bus 3.B-" as Connection3859
        connect Load2.B Junction206 as Connection3860
        connect "Measurements Block - 4.A+" Junction207 as Connection3861
        connect Junction207 "Bus 3.A-" as Connection3862
        connect Load2.A Junction207 as Connection3863
        connect "Couplin(4ph)-2.Port5" "Bus 5.B---" as Connection3870
        connect "Couplin(4ph)-2.Port6" "Bus 5.C---" as Connection3871
        connect Line-4.c_out "Bus 4.C-" as Connection3876
        connect Line-4.b_out "Bus 4.B-" as Connection3877
        connect "Bus 1.B---" Line-7.b_in as Connection3888
        connect "Bus 1.C---" Line-7.a_in as Connection3889
        connect "Measurements Block - 11.C+" Junction213 as Connection3896
        connect Junction213 "Bus 4.C+" as Connection3897
        connect Load3.C Junction213 as Connection3898
        connect "Measurements Block - 11.B+" Junction214 as Connection3899
        connect Junction214 "Bus 4.B+" as Connection3900
        connect Load3.B Junction214 as Connection3901
        connect "Measurements Block - 11.A+" Junction215 as Connection3902
        connect Junction215 "Bus 4.A+" as Connection3903
        connect Load3.A Junction215 as Connection3904
        connect "Measurements Block - 11.A-" S11.a_in as Connection3905
        connect "Measurements Block - 11.B-" S11.b_in as Connection3906
        connect "Measurements Block - 11.C-" S11.c_in as Connection3907
        connect Relay-11.BM "Measurements Block - 11.BM" as Connection3908
        connect "Relay-11.Trip DOCR" S11.ctrl_in as Connection3909
        connect "Electric Tag76" Line-3_section-2.gnd as Connection3917
        connect Line-3_section-1.c_out S4.c_out as Connection3918
        connect S4.b_out Line-3_section-1.b_out as Connection3919
        connect Line-3_section-1.a_out S4.a_out as Connection3920
        connect Fault-1.Port4 Line-3_section-1.a_in as Connection3921
        connect Fault-1.Port9 Line-3_section-1.b_in as Connection3922
        connect Fault-1.Port11 Line-3_section-1.c_in as Connection3923
        [
            breakpoints = 10432, 8232; 10432, 8232
        ]
        connect Fault-1.Port1 Line-3_section-2.a_out as Connection3924
        connect Line-3_section-2.b_out Fault-1.Port8 as Connection3925
        connect Fault-1.Port10 Line-3_section-2.c_out as Connection3926
        connect "Measurements Block - 3.A-" S3.a_in as Connection3927
        connect "Measurements Block - 3.B-" S3.b_in as Connection3928
        connect "Measurements Block - 3.C-" S3.c_in as Connection3929
        connect "Relay-3.Trip DOCR" S3.ctrl_in as Connection3930
        connect Relay-3.BM "Measurements Block - 3.BM" as Connection3931
        [
            breakpoints = 8704, 7200; 8704, 7200
        ]
        connect "Bus 2.A-" "Measurements Block - 3.A+" as Connection3932
        connect "Bus 2.B-" "Measurements Block - 3.B+" as Connection3933
        connect "Bus 2.C-" "Measurements Block - 3.C+" as Connection3934
        connect "Electric Tag81" Fault-1.Port7 as Connection3962
        connect Line-1.c_out Junction216 as Connection3966
        connect Junction216 "Bus 2.C+" as Connection3967
        connect Load1.C Junction216 as Connection3968
        connect Line-1.b_out Junction217 as Connection3969
        connect Junction217 "Bus 2.B+" as Connection3970
        connect Load1.B Junction217 as Connection3971
        connect Line-1.a_out Junction218 as Connection3972
        connect Load1.A Junction218 as Connection3974
        connect Line-2.c_in "Couplin(4ph)-1.Port6" as Connection3978
        connect "Couplin(4ph)-1.Port3" S3.c_out as Connection3979
        connect Line-2.b_in "Couplin(4ph)-1.Port5" as Connection3980
        connect "Couplin(4ph)-1.Port2" S3.b_out as Connection3981
        connect Line-2.a_in "Couplin(4ph)-1.Port4" as Connection3982
        connect "Couplin(4ph)-1.Port1" S3.a_out as Connection3983
        connect "Electric Tag19" "Couplin(4ph)-1.Port8" as Connection3984
        connect "Electric Tag30" "Couplin(4ph)-1.Port7" as Connection3985
        connect "Electric Tag47" "Couplin(3ph)-2.Port8" as Connection4006
        connect "Electric Tag46" "Couplin(3ph)-2.Port7" as Connection4007
        connect Line-5.c_in Junction221 as Connection4026
        [
            breakpoints = 6544, 10120; 5600, 10120
        ]
        connect Junction221 "Bus 6.C+" as Connection4027
        connect Load4.C Junction221 as Connection4028
        connect Line-5.b_in Junction222 as Connection4029
        connect Junction222 "Bus 6.B+" as Connection4030
        connect Load4.B Junction222 as Connection4031
        connect "Bus 6.A+" Junction223 as Connection4033
        connect Load4.A Junction223 as Connection4035
        connect "Bus 4.A-" Line-4.a_out as Connection4039
        [
            breakpoints = 10280, 10072; 9976, 10072; 9976, 10072
        ]
        connect Line-4.a_in S12.a_out as Connection4040
        [
            breakpoints = 8384, 9992; 8384, 9992; 8376, 9992
        ]
        connect "Bus 5.A---" "Couplin(4ph)-2.Port4" as Connection4041
        [
            breakpoints = 7456, 9880
        ]
        connect "Couplin(3ph)-1.Port4" "Bus 5.A--" as Connection4042
        [
            breakpoints = 7176, 10072; 7176, 10072; 7416, 10072
        ]
        connect Junction223 Line-5.a_in as Connection4043
        [
            breakpoints = 5568, 10056; 6120, 10056; 6120, 10056; 6544, 10056
        ]
        connect "Bus 6.A-" Line-6.a_in as Connection4044
        [
            breakpoints = 5256, 10024; 5256, 9792; 5256, 9792
        ]
        connect Line-7.c_in "Bus 1.A---" as Connection4045
        [
            breakpoints = 6408, 7680
        ]
        connect "Bus 1.A-" Line-1.a_in as Connection4046
        [
            breakpoints = 6640, 7368; 6856, 7368; 6856, 7368
        ]
        connect "Bus 1.A--" "Couplin(4ph)-3.Port4" as Connection4047
        [
            breakpoints = 6368, 7368; 5960, 7368; 5960, 7368
        ]
        connect "Bus 2.A+" Junction218 as Connection4048
        [
            breakpoints = 8344, 7368; 8248, 7368; 8248, 7368
        ]
        connect Line-3_section-2.a_in "Couplin(3ph)-2.Port4" as Connection4049
        connect "Couplin(3ph)-2.Port5" Line-3_section-2.b_in as Connection4050
        connect Line-3_section-2.c_in "Couplin(3ph)-2.Port6" as Connection4051
        connect "Couplin(3ph)-2.Port1" S11.a_out as Connection4052
        connect "Couplin(3ph)-2.Port2" S11.b_out as Connection4053
        connect S11.c_out "Couplin(3ph)-2.Port3" as Connection4054
        [
            breakpoints = 10432, 9648; 10432, 9096
        ]
    }

    default {
        gen_bus_join {
            inputs = "2"
            execution_rate = "inherit"
        }

        gen_bus_split {
            outputs = "2"
            execution_rate = "inherit"
        }

        gen_c_function {
            input_terminals = "real in;"
            input_terminals_show_labels = "False;"
            input_terminals_feedthrough = "True;"
            input_terminals_dimensions = "inherit;"
            output_terminals = "real out;"
            output_terminals_show_labels = "False;"
            output_terminals_feedthrough = "True;"
            output_terminals_dimensions = "inherit;"
            output_fnc = ""
            update_fnc = ""
            init_fnc = ""
            global_variables = ""
            parameters = ""
            execution_rate = "inherit"
        }

        gen_comparator {
            execution_rate = "inherit"
        }

        gen_logic_op {
            operator = "AND"
            inputs = "2"
            execution_rate = "inherit"
        }

        gen_probe {
            addr = "0"
            override_signal_name = "False"
            signal_name = ""
            signal_type = "generic"
            streaming_en = "False"
            streaming_er_idx = "0"
            execution_rate = "inherit"
        }

        gen_product {
            signs = "2"
            execution_rate = "inherit"
        }

        msr_phase {
            period_timeout = "0.5"
            angle = "Degrees"
            lpf_checkbox = "True"
            f3db = "500.0"
            execution_rate = "inherit"
        }

        pas_capacitor {
            capacitance = "1e-6"
            initial_voltage = "0"
            pole_shift_ignore = "False"
            visible = "True"
        }

        pas_inductor {
            inductance = "1e-3"
            initial_current = "0.0"
            pole_shift_ignore = "False"
            visible = "True"
        }

        pas_resistor {
            resistance = "1"
            param_set = ""
        }

        src_constant {
            value = "1"
            signal_type = "real"
            execution_rate = "100e-6"
            _tunable = "False"
        }

        src_scada_input {
            addr = "0"
            format = "real"
            override_signal_name = "False"
            signal_name = ""
            signal_type = "real"
            min = "-1e6"
            max = "1e6"
            def_value = "0"
            unit = " "
            execution_rate = "100e-6"
        }

        src_sine {
            amplitude = "1"
            dc_offset = "0"
            frequency = "50"
            phase = "0"
            execution_rate = "100e-6"
            _tunable = "False"
        }

        sys_signal_switch {
            criterion = "ctrl >= threshold"
            threshold = "0"
            execution_rate = "inherit"
        }

        "core/Constant Impedance Load" {
            fn = "60"
            conn_type = "Y"
            enable_neutral = "False"
            set_balanced = "True"
            Vn_3ph = "480"
            Sn_3ph = "1.0e6"
            pf_mode_3ph = "Unit"
            pf_3ph = "0.9"
            VAn = "480/(3**0.5)"
            VAB = "480"
            SAn = "1.0e6/3"
            SAB = "1.0e6/3"
            pf_modeA = "Unit"
            pfA = "0.9"
            VBn = "480/(3**0.5)"
            VBC = "480"
            SBn = "1.0e6/3"
            SBC = "1.0e6/3"
            pf_modeB = "Unit"
            pfB = "0.9"
            VCn = "480/(3**0.5)"
            VCA = "480"
            SCn = "1.0e6/3"
            SCA = "1.0e6/3"
            pf_modeC = "Unit"
            pfC = "0.9"
        }

        "core/Current Measurement" {
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            sig_output_filt_and_full_bw = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }

        "core/Current RMS" {
            op_mode = "PLL based"
            frequency = "50"
            sig_output = "False"
            execution_rate = "inherit"
            feed_forward = "False"
            nd_msr_estimation = "false"
        }

        "core/Four Phase TLM Core Coupling" {
            type = "Inductive"
            capacitance = "1e-3"
            inductance = "1e-3"
            embedded_components = "False"
            ratio_type = "Automatic"
            ratio = "0.1"
            cpl_connection = "3 CPLs, Star Connection"
        }

        "core/Rate Transition" {
            init_value = "0.0"
            execution_rate = "100e-6"
        }

        "core/Three Phase TLM Core Coupling" {
            type = "Inductive"
            capacitance = "1e-3"
            inductance = "1e-3"
            embedded_components = "False"
            ratio_type = "Automatic"
            ratio = "0.1"
            cpl_connection = "3 CPLs, Star Connection"
        }

        "core/Three Phase Two Winding Transformer" {
            input = "SC and OC tests"
            Sn = "160000.0"
            f = "50.0"
            V1 = "10000.0"
            V2 = "400.0"
            usc1 = "4.0"
            Psc1 = "2350.0"
            R1 = "4.58984375"
            L1 = ".0370093710364"
            R2 = ".00734375"
            L2 = "5.92149936583e-05"
            r1 = ".00734375"
            l1 = ".0186029389059"
            r2 = ".00734375"
            l2 = ".0186029389059"
            core_model = "Linear"
            ioc1 = "0.7"
            Poc1 = "460.0"
            Rm = "217391.304348"
            Lm = "311.709196788"
            flux_vals_SI = "[1910.3, 2419.7]"
            current_vals_SI = "[0.66653, 277.72]"
            rm = "347.826086957"
            lm = "156.68213163"
            flux_vals_pu = "[1.2, 1.52]"
            current_vals_pu = "[0.0024, 1]"
            flux_vals_SCOC = "[1.2, 1.52]"
            current_vals_SCOC = "[0.0024, 1]"
            import_from_SI2SCOC = "Import from SI"
            import_from_pu2SCOC = "Import from PU"
            import_from_SCOC2SI = "Import from SC OC"
            import_from_pu2SI = "Import from PU"
            import_from_SCOC2pu = "Import from SC OC"
            import_from_SI2pu = "Import from SI"
            winding_1_connection = "Y"
            winding_2_connection = "Y"
            clock_number = "0"
            embedded_cpl = "None"
            coupling_type = "core"
            ratio_type = "Automatic"
            ratio = "0.1"
            Rshunt = "inf"
        }

        "core/Three Phase Voltage Source" {
            init_rms_value = "0.0"
            init_frequency = "50.0"
            init_phase = "0.0"
        }

        "core/Transmission Line" {
            model = "RL coupled"
            num_of_phases = "3"
            model_def = "Geometry"
            unit_sys = "imperial"
            Length_metric = "100.0"
            Length_miles = "62.1371"
            Frequency = "60.0"
            Earth_resistivity = "100"
            X_axis_1_metric = "-1.0668"
            Y_axis_1_metric = "8.5344"
            GMR_1_metric = "0.00743712"
            RD_1_metric = "0.009156192"
            Rs_1_metric = "0.19013958482462417"
            X_axis_1_imperial = "-3.5"
            Y_axis_1_imperial = "28.0"
            GMR_1_imperial = "0.0244"
            RD_1_imperial = "0.03004"
            Rs_1_imperial = "0.306"
            X_axis_2_metric = "-0.3048"
            Y_axis_2_metric = "8.5344"
            GMR_2_metric = "0.00743712"
            RD_2_metric = "0.009156192"
            Rs_2_metric = "0.19013958482462417"
            X_axis_2_imperial = "-1.0"
            Y_axis_2_imperial = "28.0"
            GMR_2_imperial = "0.0244"
            RD_2_imperial = "0.03004"
            Rs_2_imperial = "0.306"
            X_axis_3_metric = "1.0668"
            Y_axis_3_metric = "8.5344"
            GMR_3_metric = "0.00743712"
            RD_3_metric = "0.009156192"
            Rs_3_metric = "0.19013958482462417"
            X_axis_3_imperial = "3.5"
            Y_axis_3_imperial = "28.0"
            GMR_3_imperial = "0.0244"
            RD_3_imperial = "0.03004"
            Rs_3_imperial = "0.306"
            X_axis_4_metric = "0.1524"
            Y_axis_4_metric = "7.3152"
            GMR_4_metric = "0.00248"
            RD_4_metric = "0.00714"
            Rs_4_metric = "0.3678"
            X_axis_4_imperial = "0.5"
            Y_axis_4_imperial = "24.0"
            GMR_4_imperial = "0.00814"
            RD_4_imperial = "0.02345"
            Rs_4_imperial = "0.592"
            R_metric = "[[0.2481, 0.0579, 0.0579], [0.0579, 0.2481, 0.0579], [0.0579, 0.0579, 0.2481]]"
            R_imperial = "[[0.4, 0.093, 0.093], [0.093, 0.4, 0.093], [0.093, 0.093, 0.4]]"
            L_metric = "[[0.00233, 0.00140, 0.00140], [0.00140, 0.00233, 0.00140], [0.00140, 0.00140, 0.00233]]"
            L_imperial = "[[0.00374, 0.0022, 0.0022], [0.0022, 0.00374, 0.0022], [0.0022, 0.0022, 0.00374]]"
            C_metric = "[[8.546e-9, 0, 0], [0, 8.546e-9, 0], [0, 0, 8.546e-9]]"
            C_imperial = "[[1.471e-8, 0, 0], [0, 1.530e-8, 0], [0, 0, 1.375e-8]]"
            R_sequence_metric = "[[0.3864, 0, 0],[0, 0.01273, 0], [0, 0, 0.01273]]"
            L_sequence_metric = "[[4.1264e-3, 0, 0],[0, 0.9337e-3, 0], [0, 0, 0.9337e-3]]"
            C_sequence_metric = "[[7.751e-9, 0, 0],[0, 12.74e-9, 0], [0, 0, 12.74e-9]]"
            R_sequence_imperial = "[[0.6218, 0, 0],[0, 0.0204, 0], [0, 0, 0.0204]]"
            L_sequence_imperial = "[[0.00664, 0, 0],[0, 0.00150, 0], [0, 0, 0.00150]]"
            C_sequence_imperial = "[[1.247e-8, 0, 0],[0, 2.0503e-8, 0], [0, 0, 2.0503e-8]]"
            import_from_geometry = "Import from Geometry"
            import_from_RLC = "Import from RLC"
        }

        "core/Triple Pole Single Throw Contactor" {
            ctrl_src = "Digital input"
            Sa = "1"
            Sa_logic = "active high"
            enable_fb_out = "False"
            fb_out_type = "real"
            execution_rate = "inherit"
            initial_state = "off"
            on_delay = "0"
            off_delay = "0"
        }

        "core/Voltage Measurement" {
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            sig_output_filt_and_full_bw = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }
    }

    CODE model_init
        # Numpy module is imported as 'np'
        # Scipy module is imported as 'sp'
        # The Schematic API is imported as 'mdl'
        # To get the model file path, use 'mdl.get_model_file_path()'
        # To print information to the console, use info()
        
        Ts=1e-4;
        Ts_new=5e-4;
        # RT is used to ratio TML/Embendded if it is enabled
        #RT = 1e-3
        # C All TML Couplings have two set of capacitances, one per side
        # Please,no change this value for this system
        C = 2e-6
        
        
        # D values (Distance)
        D1 = 7
        D2 = 8
        D3 = 10
        D4 = 11
        D5 = 9
        D6 = 10
        D7 = 10
        
        # R values
        R1 = 0.057
        R1_seq = [[R1*3, 0, 0],[0, R1, 0], [0, 0, R1]]
        R2 = 0.05
        R2_seq = [[R2*3, 0, 0],[0, R2, 0], [0, 0, R2]]
        R3 = 0.05
        R3_seq = [[R3*3, 0, 0],[0, R3, 0], [0, 0, R3]]
        R4 = 0.045
        R4_seq = [[R4*3, 0, 0],[0, R4, 0], [0, 0, R4]]
        R5 = 0.044
        R5_seq = [[R5*3, 0, 0],[0, R5, 0], [0, 0, R5]]
        R6 = 0.04
        R6_seq = [[R6*3, 0, 0],[0, R6, 0], [0, 0, R6]]
        R7 = 0.05
        R7_seq = [[R7*3, 0, 0],[0, R7, 0], [0, 0, R7]]
        
        # L values
        
        L1 = 0.714/377
        L1_seq = [[L1*3, 0, 0],[0, L1, 0], [0, 0, L1]]
        L2 = 0.563/377
        L2_seq = [[L2*3, 0, 0],[0, L2, 0], [0, 0, L2]]
        L3 = 0.45/377
        L3_seq = [[L3*3, 0, 0],[0, L3, 0], [0, 0, L3]]
        L4 = 0.409/377
        L4_seq = [[L4*3, 0, 0],[0, L4, 0], [0, 0, L4]]
        L5 = 0.5/377
        L5_seq = [[L5*3, 0, 0],[0, L5, 0], [0, 0, L5]]
        L6 = 0.5/377
        L6_seq = [[L6*3, 0, 0],[0, L6, 0], [0, 0, L6]]
        L7 = 0.5/377
        L7_seq = [[L7*3, 0, 0],[0, L7, 0], [0, 0, L7]]
        
        
        C_seq = [[C/100, 0, 0],[0,C/100, 0], [0, 0, C/100]]
    ENDCODE
}
